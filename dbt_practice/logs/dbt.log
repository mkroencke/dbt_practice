2021-10-05 18:43:58.773761 (MainThread): Running with dbt=0.19.0
2021-10-05 18:43:58.909629 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 18:43:58.952147 (MainThread): Tracking: tracking
2021-10-05 18:43:58.954178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd436a6ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd41bffb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd41bfffd0>]}
2021-10-05 18:43:58.988866 (MainThread): Partial parsing not enabled
2021-10-05 18:43:58.992830 (MainThread): Parsing macros/adapters.sql
2021-10-05 18:43:59.019040 (MainThread): Parsing macros/catalog.sql
2021-10-05 18:43:59.022106 (MainThread): Parsing macros/relations.sql
2021-10-05 18:43:59.024084 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 18:43:59.027731 (MainThread): Parsing macros/core.sql
2021-10-05 18:43:59.032549 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 18:43:59.083587 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 18:43:59.086349 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 18:43:59.088590 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 18:43:59.100768 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 18:43:59.103977 (MainThread): Parsing macros/etc/query.sql
2021-10-05 18:43:59.105795 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 18:43:59.107330 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 18:43:59.118017 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 18:43:59.142356 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 18:43:59.144799 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 18:43:59.179143 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 18:43:59.203747 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 18:43:59.214204 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 18:43:59.218965 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 18:43:59.245177 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 18:43:59.251727 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 18:43:59.260377 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 18:43:59.271230 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 18:43:59.274365 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 18:43:59.276790 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 18:43:59.279743 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 18:43:59.296554 (MainThread): Partial parsing not enabled
2021-10-05 18:43:59.350233 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 18:43:59.525149 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 18:43:59.526970 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47cb3699-6d1b-4624-bead-14b895116569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd41ae3760>]}
2021-10-05 18:43:59.605618 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 18:43:59.607167 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-05 18:43:59.608297 (MainThread): 
2021-10-05 18:43:59.609019 (MainThread): Acquiring new postgres connection "master".
2021-10-05 18:43:59.612356 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 18:43:59.627233 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 18:43:59.627848 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 18:43:59.628357 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 18:43:59.633542 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 18:43:59.641461 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 18:43:59.644313 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 18:43:59.654230 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 18:43:59.654992 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 18:43:59.655678 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 18:43:59.660306 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:43:59.661260 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 18:43:59.661939 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 18:43:59.665647 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-05 18:43:59.675969 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 18:43:59.676772 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 18:43:59.684604 (MainThread): Using postgres connection "master".
2021-10-05 18:43:59.685374 (MainThread): On master: BEGIN
2021-10-05 18:43:59.686032 (MainThread): Opening a new connection, currently in state init
2021-10-05 18:43:59.690631 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:43:59.691280 (MainThread): Using postgres connection "master".
2021-10-05 18:43:59.691947 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 18:43:59.698192 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 18:43:59.699248 (MainThread): On master: ROLLBACK
2021-10-05 18:43:59.700597 (MainThread): Using postgres connection "master".
2021-10-05 18:43:59.701409 (MainThread): On master: BEGIN
2021-10-05 18:43:59.703048 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:43:59.703808 (MainThread): On master: COMMIT
2021-10-05 18:43:59.704294 (MainThread): Using postgres connection "master".
2021-10-05 18:43:59.704641 (MainThread): On master: COMMIT
2021-10-05 18:43:59.705494 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 18:43:59.705959 (MainThread): On master: Close
2021-10-05 18:43:59.706745 (MainThread): 18:43:59 | Concurrency: 2 threads (target='dev')
2021-10-05 18:43:59.707307 (MainThread): 18:43:59 | 
2021-10-05 18:43:59.720272 (Thread-1): Began running node model.my_new_project.task1
2021-10-05 18:43:59.722332 (Thread-1): 18:43:59 | 1 of 1 START view model public.task1................................. [RUN]
2021-10-05 18:43:59.723098 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 18:43:59.723529 (Thread-1): Compiling model.my_new_project.task1
2021-10-05 18:43:59.747725 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-05 18:43:59.789012 (Thread-1): finished collecting timing info
2021-10-05 18:43:59.821027 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:43:59.821589 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-05 18:43:59.822013 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 18:43:59.825805 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:43:59.829747 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:43:59.830268 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 18:43:59.831135 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:43:59.836867 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-05 18:43:59.866091 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:43:59.866571 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-05 18:43:59.867349 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:43:59.867986 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:43:59.868429 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */

  create view "dellstore"."public"."task1__dbt_tmp" as (
    SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM products
GROUP BY first_name;
  );

2021-10-05 18:43:59.869105 (Thread-1): Postgres error: syntax error at or near ";"
LINE 9: GROUP BY first_name;
                           ^

2021-10-05 18:43:59.869836 (Thread-1): On model.my_new_project.task1: ROLLBACK
2021-10-05 18:43:59.870565 (Thread-1): finished collecting timing info
2021-10-05 18:43:59.871286 (Thread-1): On model.my_new_project.task1: Close
2021-10-05 18:43:59.872068 (Thread-1): Database Error in model task1 (models/task1.sql)
  syntax error at or near ";"
  LINE 9: GROUP BY first_name;
                             ^
  compiled SQL at target/run/my_new_project/models/task1.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 9: GROUP BY first_name;
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task1 (models/task1.sql)
  syntax error at or near ";"
  LINE 9: GROUP BY first_name;
                             ^
  compiled SQL at target/run/my_new_project/models/task1.sql
2021-10-05 18:43:59.874396 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '47cb3699-6d1b-4624-bead-14b895116569', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd41129070>]}
2021-10-05 18:43:59.876250 (Thread-1): 18:43:59 | 1 of 1 ERROR creating view model public.task1........................ [ERROR in 0.15s]
2021-10-05 18:43:59.876782 (Thread-1): Finished running node model.my_new_project.task1
2021-10-05 18:43:59.879141 (MainThread): Acquiring new postgres connection "master".
2021-10-05 18:43:59.879582 (MainThread): Using postgres connection "master".
2021-10-05 18:43:59.879918 (MainThread): On master: BEGIN
2021-10-05 18:43:59.880198 (MainThread): Opening a new connection, currently in state closed
2021-10-05 18:43:59.888559 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 18:43:59.889358 (MainThread): On master: COMMIT
2021-10-05 18:43:59.889797 (MainThread): Using postgres connection "master".
2021-10-05 18:43:59.890491 (MainThread): On master: COMMIT
2021-10-05 18:43:59.891436 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 18:43:59.892014 (MainThread): On master: Close
2021-10-05 18:43:59.892735 (MainThread): 18:43:59 | 
2021-10-05 18:43:59.893391 (MainThread): 18:43:59 | Finished running 1 view model in 0.28s.
2021-10-05 18:43:59.894193 (MainThread): Connection 'master' was properly closed.
2021-10-05 18:43:59.895872 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-05 18:43:59.963620 (MainThread): 
2021-10-05 18:43:59.964077 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 18:43:59.964836 (MainThread): 
2021-10-05 18:43:59.967738 (MainThread): Database Error in model task1 (models/task1.sql)
2021-10-05 18:43:59.968502 (MainThread):   syntax error at or near ";"
2021-10-05 18:43:59.969504 (MainThread):   LINE 9: GROUP BY first_name;
2021-10-05 18:43:59.970282 (MainThread):                              ^
2021-10-05 18:43:59.971848 (MainThread):   compiled SQL at target/run/my_new_project/models/task1.sql
2021-10-05 18:43:59.972671 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 18:43:59.973708 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd419a9130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd419da880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd419dabe0>]}
2021-10-05 18:43:59.974799 (MainThread): Flushing usage events
2021-10-05 18:44:24.986845 (MainThread): Running with dbt=0.19.0
2021-10-05 18:44:25.108258 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 18:44:25.113484 (MainThread): Tracking: tracking
2021-10-05 18:44:25.115718 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6ea91a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc7053c370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6eaa31f0>]}
2021-10-05 18:44:25.158559 (MainThread): Partial parsing not enabled
2021-10-05 18:44:25.162717 (MainThread): Parsing macros/adapters.sql
2021-10-05 18:44:25.188757 (MainThread): Parsing macros/catalog.sql
2021-10-05 18:44:25.193333 (MainThread): Parsing macros/relations.sql
2021-10-05 18:44:25.195915 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 18:44:25.199406 (MainThread): Parsing macros/core.sql
2021-10-05 18:44:25.204854 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 18:44:25.261530 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 18:44:25.264520 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 18:44:25.268249 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 18:44:25.280151 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 18:44:25.282897 (MainThread): Parsing macros/etc/query.sql
2021-10-05 18:44:25.284592 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 18:44:25.286332 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 18:44:25.297317 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 18:44:25.321230 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 18:44:25.323755 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 18:44:25.356586 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 18:44:25.378676 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 18:44:25.386170 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 18:44:25.388631 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 18:44:25.404524 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 18:44:25.410581 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 18:44:25.417961 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 18:44:25.425928 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 18:44:25.428386 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 18:44:25.430829 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 18:44:25.433333 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 18:44:25.448489 (MainThread): Partial parsing not enabled
2021-10-05 18:44:25.501170 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.681938 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 18:44:25.683841 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6190b3d2-e8ff-4485-87c2-d9ae8beb2e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6e97eb80>]}
2021-10-05 18:44:25.733503 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 18:44:25.735206 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 0 sources, 0 exposures
2021-10-05 18:44:25.736693 (MainThread): 
2021-10-05 18:44:25.737690 (MainThread): Acquiring new postgres connection "master".
2021-10-05 18:44:25.740329 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 18:44:25.755676 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 18:44:25.756451 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 18:44:25.757044 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 18:44:25.761427 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 18:44:25.764351 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 18:44:25.767551 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 18:44:25.775493 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 18:44:25.776075 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 18:44:25.776543 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 18:44:25.780260 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:44:25.780883 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 18:44:25.781264 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 18:44:25.784638 (ThreadPoolExecutor-1_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-05 18:44:25.794026 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 18:44:25.794893 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 18:44:25.801566 (MainThread): Using postgres connection "master".
2021-10-05 18:44:25.802158 (MainThread): On master: BEGIN
2021-10-05 18:44:25.802671 (MainThread): Opening a new connection, currently in state init
2021-10-05 18:44:25.806560 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:44:25.807303 (MainThread): Using postgres connection "master".
2021-10-05 18:44:25.807841 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 18:44:25.814781 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 18:44:25.815746 (MainThread): On master: ROLLBACK
2021-10-05 18:44:25.816700 (MainThread): Using postgres connection "master".
2021-10-05 18:44:25.817254 (MainThread): On master: BEGIN
2021-10-05 18:44:25.818372 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:44:25.818901 (MainThread): On master: COMMIT
2021-10-05 18:44:25.819343 (MainThread): Using postgres connection "master".
2021-10-05 18:44:25.819866 (MainThread): On master: COMMIT
2021-10-05 18:44:25.820546 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 18:44:25.820973 (MainThread): On master: Close
2021-10-05 18:44:25.821629 (MainThread): 18:44:25 | Concurrency: 2 threads (target='dev')
2021-10-05 18:44:25.822200 (MainThread): 18:44:25 | 
2021-10-05 18:44:25.826438 (Thread-1): Began running node model.my_new_project.task1
2021-10-05 18:44:25.828254 (Thread-1): 18:44:25 | 1 of 1 START view model public.task1................................. [RUN]
2021-10-05 18:44:25.829176 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.829763 (Thread-1): Compiling model.my_new_project.task1
2021-10-05 18:44:25.851400 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-05 18:44:25.864631 (Thread-1): finished collecting timing info
2021-10-05 18:44:25.899180 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.899919 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-05 18:44:25.900556 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 18:44:25.904590 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:44:25.907700 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.908185 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 18:44:25.909015 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:44:25.915567 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-05 18:44:25.926846 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.927299 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-05 18:44:25.927971 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:44:25.928454 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.928866 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */

  create view "dellstore"."public"."task1__dbt_tmp" as (
    SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM products
GROUP BY first_name
  );

2021-10-05 18:44:25.932134 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 18:44:25.940362 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.940913 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1__dbt_tmp" rename to "task1"
2021-10-05 18:44:25.942025 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 18:44:25.949721 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 18:44:25.950321 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:25.950825 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 18:44:25.996611 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-10-05 18:44:26.001153 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:44:26.001850 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 18:44:26.002728 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:44:26.005791 (Thread-1): finished collecting timing info
2021-10-05 18:44:26.006480 (Thread-1): On model.my_new_project.task1: Close
2021-10-05 18:44:26.007575 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6190b3d2-e8ff-4485-87c2-d9ae8beb2e2b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6dfd5f40>]}
2021-10-05 18:44:26.009250 (Thread-1): 18:44:26 | 1 of 1 OK created view model public.task1............................ [CREATE VIEW in 0.18s]
2021-10-05 18:44:26.009903 (Thread-1): Finished running node model.my_new_project.task1
2021-10-05 18:44:26.013273 (MainThread): Acquiring new postgres connection "master".
2021-10-05 18:44:26.013929 (MainThread): Using postgres connection "master".
2021-10-05 18:44:26.014527 (MainThread): On master: BEGIN
2021-10-05 18:44:26.015051 (MainThread): Opening a new connection, currently in state closed
2021-10-05 18:44:26.019500 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:44:26.020119 (MainThread): On master: COMMIT
2021-10-05 18:44:26.020619 (MainThread): Using postgres connection "master".
2021-10-05 18:44:26.021120 (MainThread): On master: COMMIT
2021-10-05 18:44:26.021849 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 18:44:26.022381 (MainThread): On master: Close
2021-10-05 18:44:26.023307 (MainThread): 18:44:26 | 
2021-10-05 18:44:26.024000 (MainThread): 18:44:26 | Finished running 1 view model in 0.29s.
2021-10-05 18:44:26.024807 (MainThread): Connection 'master' was properly closed.
2021-10-05 18:44:26.025187 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-05 18:44:26.071633 (MainThread): 
2021-10-05 18:44:26.072378 (MainThread): Completed successfully
2021-10-05 18:44:26.072889 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 18:44:26.073554 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6e974310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6dfcf3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdc6dfcf490>]}
2021-10-05 18:44:26.074251 (MainThread): Flushing usage events
2021-10-05 18:57:15.739545 (MainThread): Running with dbt=0.19.0
2021-10-05 18:57:15.854342 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 18:57:15.859943 (MainThread): Tracking: tracking
2021-10-05 18:57:15.862048 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b62fafa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b99013a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b630b070>]}
2021-10-05 18:57:15.904426 (MainThread): Partial parsing not enabled
2021-10-05 18:57:15.908383 (MainThread): Parsing macros/adapters.sql
2021-10-05 18:57:15.933438 (MainThread): Parsing macros/catalog.sql
2021-10-05 18:57:15.936481 (MainThread): Parsing macros/relations.sql
2021-10-05 18:57:15.938449 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 18:57:15.941541 (MainThread): Parsing macros/core.sql
2021-10-05 18:57:15.947146 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 18:57:15.994197 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 18:57:15.996875 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 18:57:15.999060 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 18:57:16.009437 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 18:57:16.011614 (MainThread): Parsing macros/etc/query.sql
2021-10-05 18:57:16.013121 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 18:57:16.014521 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 18:57:16.024991 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 18:57:16.049025 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 18:57:16.051377 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 18:57:16.084803 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 18:57:16.106033 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 18:57:16.113806 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 18:57:16.116372 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 18:57:16.131803 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 18:57:16.137683 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 18:57:16.145078 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 18:57:16.154322 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 18:57:16.156811 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 18:57:16.159069 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 18:57:16.161646 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 18:57:16.177480 (MainThread): Partial parsing not enabled
2021-10-05 18:57:16.239313 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.452838 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 18:57:16.457355 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c48897e2-7b8c-49c4-8f01-26bb018c2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b624f910>]}
2021-10-05 18:57:16.507948 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 18:57:16.510145 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-05 18:57:16.511615 (MainThread): 
2021-10-05 18:57:16.512539 (MainThread): Acquiring new postgres connection "master".
2021-10-05 18:57:16.515178 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 18:57:16.529746 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 18:57:16.530366 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 18:57:16.530861 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 18:57:16.536260 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 18:57:16.539635 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 18:57:16.542491 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 18:57:16.550604 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 18:57:16.551248 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 18:57:16.551976 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 18:57:16.556938 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 18:57:16.557570 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 18:57:16.558244 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 18:57:16.560850 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 18:57:16.570901 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 18:57:16.572017 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 18:57:16.579095 (MainThread): Using postgres connection "master".
2021-10-05 18:57:16.579658 (MainThread): On master: BEGIN
2021-10-05 18:57:16.580077 (MainThread): Opening a new connection, currently in state init
2021-10-05 18:57:16.583822 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:57:16.584808 (MainThread): Using postgres connection "master".
2021-10-05 18:57:16.585613 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 18:57:16.592537 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 18:57:16.595889 (MainThread): On master: ROLLBACK
2021-10-05 18:57:16.596547 (MainThread): Using postgres connection "master".
2021-10-05 18:57:16.596984 (MainThread): On master: BEGIN
2021-10-05 18:57:16.597789 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:57:16.598272 (MainThread): On master: COMMIT
2021-10-05 18:57:16.598782 (MainThread): Using postgres connection "master".
2021-10-05 18:57:16.599296 (MainThread): On master: COMMIT
2021-10-05 18:57:16.600110 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 18:57:16.600530 (MainThread): On master: Close
2021-10-05 18:57:16.601391 (MainThread): 18:57:16 | Concurrency: 2 threads (target='dev')
2021-10-05 18:57:16.602102 (MainThread): 18:57:16 | 
2021-10-05 18:57:16.607383 (Thread-1): Began running node model.my_new_project.task1
2021-10-05 18:57:16.609620 (Thread-1): 18:57:16 | 1 of 1 START view model public.task1................................. [RUN]
2021-10-05 18:57:16.610665 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.611343 (Thread-1): Compiling model.my_new_project.task1
2021-10-05 18:57:16.635891 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-05 18:57:16.647931 (Thread-1): finished collecting timing info
2021-10-05 18:57:16.680491 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.681023 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-05 18:57:16.681453 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 18:57:16.685249 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:57:16.688427 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.688877 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 18:57:16.689543 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 18:57:16.695011 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-05 18:57:16.703918 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.704377 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-05 18:57:16.705054 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 18:57:16.705429 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.705832 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */

  create view "dellstore"."public"."task1__dbt_tmp" as (
    SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM "dellstore"."public"."products"
GROUP BY first_name
  );

2021-10-05 18:57:16.708315 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 18:57:16.719728 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.720247 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1" rename to "task1__dbt_backup"
2021-10-05 18:57:16.721229 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 18:57:16.724065 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.724562 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1__dbt_tmp" rename to "task1"
2021-10-05 18:57:16.725513 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 18:57:16.732977 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 18:57:16.733499 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.734005 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 18:57:16.786274 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-10-05 18:57:16.790291 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 18:57:16.790948 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 18:57:16.825567 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2021-10-05 18:57:16.828727 (Thread-1): finished collecting timing info
2021-10-05 18:57:16.829362 (Thread-1): On model.my_new_project.task1: Close
2021-10-05 18:57:16.830557 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c48897e2-7b8c-49c4-8f01-26bb018c2a95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b61330a0>]}
2021-10-05 18:57:16.832175 (Thread-1): 18:57:16 | 1 of 1 OK created view model public.task1............................ [CREATE VIEW in 0.22s]
2021-10-05 18:57:16.832881 (Thread-1): Finished running node model.my_new_project.task1
2021-10-05 18:57:16.835359 (MainThread): Acquiring new postgres connection "master".
2021-10-05 18:57:16.836003 (MainThread): Using postgres connection "master".
2021-10-05 18:57:16.836609 (MainThread): On master: BEGIN
2021-10-05 18:57:16.837089 (MainThread): Opening a new connection, currently in state closed
2021-10-05 18:57:16.842602 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 18:57:16.843277 (MainThread): On master: COMMIT
2021-10-05 18:57:16.844092 (MainThread): Using postgres connection "master".
2021-10-05 18:57:16.844906 (MainThread): On master: COMMIT
2021-10-05 18:57:16.846280 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 18:57:16.847025 (MainThread): On master: Close
2021-10-05 18:57:16.848126 (MainThread): 18:57:16 | 
2021-10-05 18:57:16.848715 (MainThread): 18:57:16 | Finished running 1 view model in 0.34s.
2021-10-05 18:57:16.849797 (MainThread): Connection 'master' was properly closed.
2021-10-05 18:57:16.850592 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-05 18:57:16.901241 (MainThread): 
2021-10-05 18:57:16.902166 (MainThread): Completed successfully
2021-10-05 18:57:16.902901 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 18:57:16.903874 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b6137ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b6099760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc7b61560d0>]}
2021-10-05 18:57:16.905532 (MainThread): Flushing usage events
2021-10-05 19:00:17.416327 (MainThread): Running with dbt=0.19.0
2021-10-05 19:00:17.537387 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 19:00:17.542674 (MainThread): Tracking: tracking
2021-10-05 19:00:17.544863 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab446fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaaea4e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab4570a0>]}
2021-10-05 19:00:17.586817 (MainThread): Partial parsing not enabled
2021-10-05 19:00:17.591541 (MainThread): Parsing macros/adapters.sql
2021-10-05 19:00:17.616330 (MainThread): Parsing macros/catalog.sql
2021-10-05 19:00:17.619965 (MainThread): Parsing macros/relations.sql
2021-10-05 19:00:17.622089 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 19:00:17.626134 (MainThread): Parsing macros/core.sql
2021-10-05 19:00:17.631286 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 19:00:17.680880 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 19:00:17.683500 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 19:00:17.686123 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 19:00:17.696229 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 19:00:17.698438 (MainThread): Parsing macros/etc/query.sql
2021-10-05 19:00:17.699941 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 19:00:17.701367 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 19:00:17.712269 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 19:00:17.735482 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 19:00:17.737766 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 19:00:17.771376 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 19:00:17.791997 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 19:00:17.799727 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 19:00:17.802186 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 19:00:17.817721 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 19:00:17.823577 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 19:00:17.830926 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 19:00:17.839224 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 19:00:17.841544 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 19:00:17.843583 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 19:00:17.846129 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 19:00:17.862424 (MainThread): Partial parsing not enabled
2021-10-05 19:00:17.911815 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.143179 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 19:00:18.146455 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e0e515f-b005-4033-b3ea-39fef78b1a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab331f40>]}
2021-10-05 19:00:18.194704 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 19:00:18.196618 (MainThread): Found 1 model, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-05 19:00:18.198253 (MainThread): 
2021-10-05 19:00:18.200113 (MainThread): Acquiring new postgres connection "master".
2021-10-05 19:00:18.203871 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 19:00:18.217778 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 19:00:18.218424 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 19:00:18.219048 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 19:00:18.224276 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 19:00:18.227129 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 19:00:18.229720 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 19:00:18.237650 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 19:00:18.238186 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 19:00:18.238642 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 19:00:18.242838 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 19:00:18.243583 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 19:00:18.244029 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 19:00:18.247675 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 19:00:18.258062 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 19:00:18.258773 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 19:00:18.265416 (MainThread): Using postgres connection "master".
2021-10-05 19:00:18.265899 (MainThread): On master: BEGIN
2021-10-05 19:00:18.266289 (MainThread): Opening a new connection, currently in state init
2021-10-05 19:00:18.270239 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 19:00:18.270839 (MainThread): Using postgres connection "master".
2021-10-05 19:00:18.271356 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 19:00:18.277125 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 19:00:18.279574 (MainThread): On master: ROLLBACK
2021-10-05 19:00:18.280303 (MainThread): Using postgres connection "master".
2021-10-05 19:00:18.280718 (MainThread): On master: BEGIN
2021-10-05 19:00:18.281553 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 19:00:18.282135 (MainThread): On master: COMMIT
2021-10-05 19:00:18.282550 (MainThread): Using postgres connection "master".
2021-10-05 19:00:18.282979 (MainThread): On master: COMMIT
2021-10-05 19:00:18.283897 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 19:00:18.284437 (MainThread): On master: Close
2021-10-05 19:00:18.285404 (MainThread): 19:00:18 | Concurrency: 2 threads (target='dev')
2021-10-05 19:00:18.286165 (MainThread): 19:00:18 | 
2021-10-05 19:00:18.290509 (Thread-1): Began running node model.my_new_project.task1
2021-10-05 19:00:18.292474 (Thread-1): 19:00:18 | 1 of 1 START table model public.task1................................ [RUN]
2021-10-05 19:00:18.293270 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.293951 (Thread-1): Compiling model.my_new_project.task1
2021-10-05 19:00:18.319089 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-05 19:00:18.329253 (Thread-1): finished collecting timing info
2021-10-05 19:00:18.359072 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.359695 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-05 19:00:18.360175 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 19:00:18.364226 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 19:00:18.367247 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.367749 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 19:00:18.368630 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 19:00:18.381117 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-05 19:00:18.390772 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.391213 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-05 19:00:18.392022 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 19:00:18.392752 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.393291 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */


  create  table "dellstore"."public"."task1__dbt_tmp"
  as (
    

SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM "dellstore"."public"."products"
GROUP BY first_name
  );
2021-10-05 19:00:18.484630 (Thread-1): SQL status: SELECT 200 in 0.09 seconds
2021-10-05 19:00:18.492785 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.493378 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1" rename to "task1__dbt_backup"
2021-10-05 19:00:18.494401 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 19:00:18.496987 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.497534 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1__dbt_tmp" rename to "task1"
2021-10-05 19:00:18.498461 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 19:00:18.505743 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 19:00:18.506400 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.506911 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 19:00:18.539979 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-10-05 19:00:18.543895 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 19:00:18.544401 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop view if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 19:00:18.579374 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2021-10-05 19:00:18.582509 (Thread-1): finished collecting timing info
2021-10-05 19:00:18.583196 (Thread-1): On model.my_new_project.task1: Close
2021-10-05 19:00:18.584410 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e0e515f-b005-4033-b3ea-39fef78b1a18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab297e20>]}
2021-10-05 19:00:18.585881 (Thread-1): 19:00:18 | 1 of 1 OK created table model public.task1........................... [SELECT 200 in 0.29s]
2021-10-05 19:00:18.586537 (Thread-1): Finished running node model.my_new_project.task1
2021-10-05 19:00:18.589330 (MainThread): Acquiring new postgres connection "master".
2021-10-05 19:00:18.589945 (MainThread): Using postgres connection "master".
2021-10-05 19:00:18.590545 (MainThread): On master: BEGIN
2021-10-05 19:00:18.591058 (MainThread): Opening a new connection, currently in state closed
2021-10-05 19:00:18.595389 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 19:00:18.596020 (MainThread): On master: COMMIT
2021-10-05 19:00:18.596548 (MainThread): Using postgres connection "master".
2021-10-05 19:00:18.597132 (MainThread): On master: COMMIT
2021-10-05 19:00:18.598102 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 19:00:18.598662 (MainThread): On master: Close
2021-10-05 19:00:18.599723 (MainThread): 19:00:18 | 
2021-10-05 19:00:18.600648 (MainThread): 19:00:18 | Finished running 1 table model in 0.40s.
2021-10-05 19:00:18.601416 (MainThread): Connection 'master' was properly closed.
2021-10-05 19:00:18.602058 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-05 19:00:18.653156 (MainThread): 
2021-10-05 19:00:18.653697 (MainThread): Completed successfully
2021-10-05 19:00:18.654793 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 19:00:18.655894 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab30ccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab3986d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faaab30e8e0>]}
2021-10-05 19:00:18.657053 (MainThread): Flushing usage events
2021-10-05 20:27:19.556271 (MainThread): Running with dbt=0.19.0
2021-10-05 20:27:19.678480 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:27:19.683591 (MainThread): Tracking: tracking
2021-10-05 20:27:19.685752 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d38f910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1050996430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d3a0100>]}
2021-10-05 20:27:19.730354 (MainThread): Partial parsing not enabled
2021-10-05 20:27:19.736076 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:27:19.762013 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:27:19.765464 (MainThread): Parsing macros/relations.sql
2021-10-05 20:27:19.767924 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:27:19.771520 (MainThread): Parsing macros/core.sql
2021-10-05 20:27:19.776897 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:27:19.824682 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:27:19.827540 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:27:19.829960 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:27:19.840455 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:27:19.842816 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:27:19.844504 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:27:19.846080 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:27:19.856483 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:27:19.880422 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:27:19.882948 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:27:19.915989 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:27:19.937107 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:27:19.944834 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:27:19.947420 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:27:19.963253 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:27:19.969417 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:27:19.977025 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:27:19.985155 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:27:19.987619 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:27:19.989888 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:27:19.992527 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:27:20.010526 (MainThread): Partial parsing not enabled
2021-10-05 20:27:20.062184 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:27:20.093908 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:27:20.307792 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:27:20.311920 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a52d8ee-3740-48c7-a99a-f01465dcc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d197f40>]}
2021-10-05 20:27:20.364646 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:27:20.366704 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-05 20:27:20.368693 (MainThread): 
2021-10-05 20:27:20.369998 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:27:20.374705 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:27:20.392634 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:27:20.393223 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:27:20.393708 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:27:20.398507 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 20:27:20.402434 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:27:20.407356 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:27:20.414309 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:27:20.414985 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:27:20.415515 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:27:20.420989 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 20:27:20.421840 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:27:20.422755 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:27:20.425876 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 20:27:20.437588 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:27:20.438430 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:27:20.447110 (MainThread): Using postgres connection "master".
2021-10-05 20:27:20.447693 (MainThread): On master: BEGIN
2021-10-05 20:27:20.448204 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:27:20.452286 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:27:20.452998 (MainThread): Using postgres connection "master".
2021-10-05 20:27:20.453602 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:27:20.459683 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 20:27:20.460485 (MainThread): On master: ROLLBACK
2021-10-05 20:27:20.461292 (MainThread): Using postgres connection "master".
2021-10-05 20:27:20.461801 (MainThread): On master: BEGIN
2021-10-05 20:27:20.462778 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:27:20.463482 (MainThread): On master: COMMIT
2021-10-05 20:27:20.464116 (MainThread): Using postgres connection "master".
2021-10-05 20:27:20.464725 (MainThread): On master: COMMIT
2021-10-05 20:27:20.465465 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:27:20.465959 (MainThread): On master: Close
2021-10-05 20:27:20.466743 (MainThread): 20:27:20 | Concurrency: 2 threads (target='dev')
2021-10-05 20:27:20.467283 (MainThread): 20:27:20 | 
2021-10-05 20:27:20.471483 (Thread-1): Began running node model.my_new_project.task1
2021-10-05 20:27:20.471866 (Thread-2): Began running node model.my_new_project.task2
2021-10-05 20:27:20.473706 (Thread-1): 20:27:20 | 1 of 2 START table model public.task1................................ [RUN]
2021-10-05 20:27:20.475717 (Thread-2): 20:27:20 | 2 of 2 START view model public.task2................................. [RUN]
2021-10-05 20:27:20.476882 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:27:20.477848 (Thread-2): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:27:20.478633 (Thread-1): Compiling model.my_new_project.task1
2021-10-05 20:27:20.479311 (Thread-2): Compiling model.my_new_project.task2
2021-10-05 20:27:20.514011 (Thread-2): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:27:20.516736 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-05 20:27:20.524795 (Thread-2): finished collecting timing info
2021-10-05 20:27:20.543561 (Thread-1): finished collecting timing info
2021-10-05 20:27:20.575638 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:27:20.581389 (Thread-2): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:27:20.583165 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:20.583430 (Thread-2): Opening a new connection, currently in state init
2021-10-05 20:27:20.583986 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-05 20:27:20.585119 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:27:20.588204 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:27:20.591123 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:27:20.591357 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-05 20:27:20.591615 (Thread-2): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:27:20.594420 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:20.595496 (Thread-2): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:27:20.595726 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 20:27:20.600870 (Thread-2): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:27:20.602061 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 20:27:20.609760 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-05 20:27:20.616390 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:27:20.617001 (Thread-2): On model.my_new_project.task2: BEGIN
2021-10-05 20:27:20.617700 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:27:20.618550 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:27:20.619177 (Thread-2): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits $$ LANGUAGE SQL;

SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM customers;
  );

2021-10-05 20:27:20.619577 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:20.620186 (Thread-2): Postgres error: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^

2021-10-05 20:27:20.620842 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-05 20:27:20.621329 (Thread-2): On model.my_new_project.task2: ROLLBACK
2021-10-05 20:27:20.622164 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:27:20.623092 (Thread-2): finished collecting timing info
2021-10-05 20:27:20.623610 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:20.624184 (Thread-2): On model.my_new_project.task2: Close
2021-10-05 20:27:20.624717 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */


  create  table "dellstore"."public"."task1__dbt_tmp"
  as (
    

SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM "dellstore"."public"."products"
GROUP BY first_name
  );
2021-10-05 20:27:20.625511 (Thread-2): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:27:20.628250 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a52d8ee-3740-48c7-a99a-f01465dcc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d286220>]}
2021-10-05 20:27:20.630574 (Thread-2): 20:27:20 | 2 of 2 ERROR creating view model public.task2........................ [ERROR in 0.15s]
2021-10-05 20:27:20.631505 (Thread-2): Finished running node model.my_new_project.task2
2021-10-05 20:27:21.384495 (Thread-1): SQL status: SELECT 200 in 0.76 seconds
2021-10-05 20:27:21.393734 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:21.394269 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1" rename to "task1__dbt_backup"
2021-10-05 20:27:21.395074 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:27:21.404754 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:21.405149 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1__dbt_tmp" rename to "task1"
2021-10-05 20:27:21.405844 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:27:21.415496 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 20:27:21.415914 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:21.416211 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-05 20:27:21.476987 (Thread-1): SQL status: COMMIT in 0.06 seconds
2021-10-05 20:27:21.481598 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-05 20:27:21.482052 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-05 20:27:21.557808 (Thread-1): SQL status: DROP TABLE in 0.08 seconds
2021-10-05 20:27:21.560974 (Thread-1): finished collecting timing info
2021-10-05 20:27:21.561474 (Thread-1): On model.my_new_project.task1: Close
2021-10-05 20:27:21.562338 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a52d8ee-3740-48c7-a99a-f01465dcc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d27da00>]}
2021-10-05 20:27:21.563877 (Thread-1): 20:27:21 | 1 of 2 OK created table model public.task1........................... [SELECT 200 in 1.09s]
2021-10-05 20:27:21.564223 (Thread-1): Finished running node model.my_new_project.task1
2021-10-05 20:27:21.566221 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:27:21.566852 (MainThread): Using postgres connection "master".
2021-10-05 20:27:21.567237 (MainThread): On master: BEGIN
2021-10-05 20:27:21.567551 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:27:21.571418 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:27:21.572400 (MainThread): On master: COMMIT
2021-10-05 20:27:21.573073 (MainThread): Using postgres connection "master".
2021-10-05 20:27:21.573415 (MainThread): On master: COMMIT
2021-10-05 20:27:21.574014 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:27:21.574338 (MainThread): On master: Close
2021-10-05 20:27:21.574958 (MainThread): 20:27:21 | 
2021-10-05 20:27:21.575391 (MainThread): 20:27:21 | Finished running 1 view model, 1 table model in 1.21s.
2021-10-05 20:27:21.576020 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:27:21.576543 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-05 20:27:21.576886 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:27:21.622695 (MainThread): 
2021-10-05 20:27:21.623179 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 20:27:21.623861 (MainThread): 
2021-10-05 20:27:21.626675 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-05 20:27:21.627443 (MainThread):   syntax error at or near "CREATE"
2021-10-05 20:27:21.628999 (MainThread):   LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
2021-10-05 20:27:21.631328 (MainThread):               ^
2021-10-05 20:27:21.634776 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:27:21.637054 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-05 20:27:21.642345 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d365310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d233820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f104d2da580>]}
2021-10-05 20:27:21.643460 (MainThread): Flushing usage events
2021-10-05 20:33:00.354716 (MainThread): Running with dbt=0.19.0
2021-10-05 20:33:00.468174 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2.sql'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:33:00.472445 (MainThread): Tracking: tracking
2021-10-05 20:33:00.474521 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a46f7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2c50fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2c60130>]}
2021-10-05 20:33:00.514007 (MainThread): Partial parsing not enabled
2021-10-05 20:33:00.517064 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:33:00.543539 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:33:00.546906 (MainThread): Parsing macros/relations.sql
2021-10-05 20:33:00.549014 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:33:00.552788 (MainThread): Parsing macros/core.sql
2021-10-05 20:33:00.558214 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:33:00.608568 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:33:00.611445 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:33:00.613875 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:33:00.625464 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:33:00.627904 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:33:00.629634 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:33:00.631154 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:33:00.642407 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:33:00.667474 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:33:00.670090 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:33:00.705596 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:33:00.727685 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:33:00.735951 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:33:00.739014 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:33:00.755711 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:33:00.762208 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:33:00.770139 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:33:00.778583 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:33:00.781106 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:33:00.783429 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:33:00.786204 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:33:00.804049 (MainThread): Partial parsing not enabled
2021-10-05 20:33:00.857140 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:33:00.895763 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:33:01.095273 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:33:01.098827 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a35cd0ea-7b57-4395-bddc-2167ea6c6c05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2acd910>]}
2021-10-05 20:33:01.151971 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:33:01.153734 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-05 20:33:01.154505 (MainThread): The selector 'task2.sql' does not match any nodes and will be ignored
2021-10-05 20:33:01.155454 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-05 20:33:01.156194 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a29ecb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2a966a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f83a2a96730>]}
2021-10-05 20:33:01.156818 (MainThread): Flushing usage events
2021-10-05 20:33:01.751283 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:33:09.407454 (MainThread): Running with dbt=0.19.0
2021-10-05 20:33:09.519553 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:33:09.525424 (MainThread): Tracking: tracking
2021-10-05 20:33:09.527546 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa612548910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa615b4f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa612559100>]}
2021-10-05 20:33:09.567700 (MainThread): Partial parsing not enabled
2021-10-05 20:33:09.571406 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:33:09.598057 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:33:09.601405 (MainThread): Parsing macros/relations.sql
2021-10-05 20:33:09.603524 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:33:09.607150 (MainThread): Parsing macros/core.sql
2021-10-05 20:33:09.612507 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:33:09.663716 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:33:09.666754 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:33:09.669182 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:33:09.680320 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:33:09.682493 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:33:09.684105 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:33:09.685580 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:33:09.696326 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:33:09.721191 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:33:09.723597 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:33:09.758990 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:33:09.780866 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:33:09.789190 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:33:09.791998 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:33:09.809612 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:33:09.816164 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:33:09.824019 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:33:09.832412 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:33:09.834893 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:33:09.836981 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:33:09.839532 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:33:09.855557 (MainThread): Partial parsing not enabled
2021-10-05 20:33:09.905719 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:33:09.936474 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:33:10.131730 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:33:10.137066 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '23d75c74-0c2e-4d13-a11f-efb6d13a30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa612348e80>]}
2021-10-05 20:33:10.188789 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:33:10.190540 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 2 sources, 0 exposures
2021-10-05 20:33:10.192344 (MainThread): 
2021-10-05 20:33:10.193321 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:33:10.196009 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:33:10.210509 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:33:10.211006 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:33:10.211395 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:33:10.216578 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 20:33:10.219843 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:33:10.225336 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:33:10.232817 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:33:10.233375 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:33:10.233854 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:33:10.240135 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-05 20:33:10.240940 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:33:10.241582 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:33:10.244567 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 20:33:10.257395 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:33:10.258196 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:33:10.266975 (MainThread): Using postgres connection "master".
2021-10-05 20:33:10.267515 (MainThread): On master: BEGIN
2021-10-05 20:33:10.268058 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:33:10.273067 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:33:10.273906 (MainThread): Using postgres connection "master".
2021-10-05 20:33:10.274355 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:33:10.279545 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-05 20:33:10.280200 (MainThread): On master: ROLLBACK
2021-10-05 20:33:10.280874 (MainThread): Using postgres connection "master".
2021-10-05 20:33:10.281237 (MainThread): On master: BEGIN
2021-10-05 20:33:10.282258 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:33:10.282788 (MainThread): On master: COMMIT
2021-10-05 20:33:10.283348 (MainThread): Using postgres connection "master".
2021-10-05 20:33:10.283808 (MainThread): On master: COMMIT
2021-10-05 20:33:10.284899 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:33:10.285650 (MainThread): On master: Close
2021-10-05 20:33:10.286608 (MainThread): 20:33:10 | Concurrency: 2 threads (target='dev')
2021-10-05 20:33:10.287261 (MainThread): 20:33:10 | 
2021-10-05 20:33:10.292030 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:33:10.293886 (Thread-1): 20:33:10 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:33:10.294683 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:33:10.295330 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:33:10.317070 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:33:10.328180 (Thread-1): finished collecting timing info
2021-10-05 20:33:10.361834 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:33:10.362369 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:33:10.362867 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:33:10.366648 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:33:10.370163 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:33:10.370725 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:33:10.371553 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:33:10.377358 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:33:10.387059 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:33:10.387550 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:33:10.388292 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:33:10.388823 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:33:10.389163 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits $$ LANGUAGE SQL;

SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM customers;
  );

2021-10-05 20:33:10.389804 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^

2021-10-05 20:33:10.390334 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-05 20:33:10.390979 (Thread-1): finished collecting timing info
2021-10-05 20:33:10.391584 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:33:10.392331 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:33:10.394890 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '23d75c74-0c2e-4d13-a11f-efb6d13a30cb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61238e640>]}
2021-10-05 20:33:10.397190 (Thread-1): 20:33:10 | 1 of 1 ERROR creating view model public.task2........................ [ERROR in 0.10s]
2021-10-05 20:33:10.397705 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:33:10.400573 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:33:10.401116 (MainThread): Using postgres connection "master".
2021-10-05 20:33:10.401509 (MainThread): On master: BEGIN
2021-10-05 20:33:10.401887 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:33:10.406166 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:33:10.407116 (MainThread): On master: COMMIT
2021-10-05 20:33:10.407676 (MainThread): Using postgres connection "master".
2021-10-05 20:33:10.408225 (MainThread): On master: COMMIT
2021-10-05 20:33:10.409067 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:33:10.409671 (MainThread): On master: Close
2021-10-05 20:33:10.410600 (MainThread): 20:33:10 | 
2021-10-05 20:33:10.411187 (MainThread): 20:33:10 | Finished running 1 view model in 0.22s.
2021-10-05 20:33:10.411875 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:33:10.412352 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:33:10.462787 (MainThread): 
2021-10-05 20:33:10.463468 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 20:33:10.463951 (MainThread): 
2021-10-05 20:33:10.464450 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-05 20:33:10.465354 (MainThread):   syntax error at or near "CREATE"
2021-10-05 20:33:10.465989 (MainThread):   LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
2021-10-05 20:33:10.467029 (MainThread):               ^
2021-10-05 20:33:10.468110 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:33:10.469529 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 20:33:10.470615 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa61251fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6124898e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6124170d0>]}
2021-10-05 20:33:10.472110 (MainThread): Flushing usage events
2021-10-05 20:39:50.678988 (MainThread): Running with dbt=0.19.0
2021-10-05 20:39:50.800463 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:39:50.805789 (MainThread): Tracking: tracking
2021-10-05 20:39:50.807985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55ba69be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55f070400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55ba7a0d0>]}
2021-10-05 20:39:50.849819 (MainThread): Partial parsing not enabled
2021-10-05 20:39:50.856754 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 20:39:50.857687 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:39:50.883874 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:39:50.887291 (MainThread): Parsing macros/relations.sql
2021-10-05 20:39:50.889482 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:39:50.892854 (MainThread): Parsing macros/core.sql
2021-10-05 20:39:50.898250 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:39:50.948001 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:39:50.950715 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:39:50.953087 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:39:50.964783 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:39:50.967101 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:39:50.968660 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:39:50.970071 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:39:50.981169 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:39:51.006690 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:39:51.009242 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:39:51.044298 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:39:51.065908 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:39:51.074090 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:39:51.076676 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:39:51.093446 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:39:51.099803 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:39:51.107805 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:39:51.115939 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:39:51.118366 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:39:51.120543 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:39:51.123252 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:39:51.139340 (MainThread): Partial parsing not enabled
2021-10-05 20:39:51.191166 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:39:51.227961 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:39:51.429098 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:39:51.433208 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b04a7c4c-5ac9-40c3-b8d4-148e62e87ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55b89bd30>]}
2021-10-05 20:39:51.482569 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:39:51.484313 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 20:39:51.490533 (MainThread): 
2021-10-05 20:39:51.491288 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:39:51.493983 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:39:51.510254 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:39:51.510824 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:39:51.511308 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:39:51.515964 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 20:39:51.519089 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:39:51.524439 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:39:51.532278 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:39:51.532812 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:39:51.533231 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:39:51.537749 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:39:51.538405 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:39:51.538953 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:39:51.542659 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 20:39:51.553347 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:39:51.554410 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:39:51.563947 (MainThread): Using postgres connection "master".
2021-10-05 20:39:51.564454 (MainThread): On master: BEGIN
2021-10-05 20:39:51.564869 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:39:51.569304 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:39:51.571519 (MainThread): Using postgres connection "master".
2021-10-05 20:39:51.572086 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:39:51.578213 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 20:39:51.578925 (MainThread): On master: ROLLBACK
2021-10-05 20:39:51.579574 (MainThread): Using postgres connection "master".
2021-10-05 20:39:51.580017 (MainThread): On master: BEGIN
2021-10-05 20:39:51.581002 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:39:51.581427 (MainThread): On master: COMMIT
2021-10-05 20:39:51.581960 (MainThread): Using postgres connection "master".
2021-10-05 20:39:51.582408 (MainThread): On master: COMMIT
2021-10-05 20:39:51.583226 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:39:51.583758 (MainThread): On master: Close
2021-10-05 20:39:51.584598 (MainThread): 20:39:51 | Concurrency: 2 threads (target='dev')
2021-10-05 20:39:51.585108 (MainThread): 20:39:51 | 
2021-10-05 20:39:51.589113 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:39:51.591202 (Thread-1): 20:39:51 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:39:51.592220 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:39:51.592850 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:39:51.617295 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:39:51.629445 (Thread-1): finished collecting timing info
2021-10-05 20:39:51.664034 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:39:51.664635 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:39:51.665271 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:39:51.669250 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:39:51.672420 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:39:51.672988 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:39:51.673812 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:39:51.679327 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:39:51.688197 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:39:51.688611 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:39:51.689305 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:39:51.689724 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:39:51.690100 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM "dellstore"."public"."customers";
  );

2021-10-05 20:39:51.691097 (Thread-1): Postgres error: syntax error at or near ";"
LINE 12: FROM "dellstore"."public"."customers";
                                              ^

2021-10-05 20:39:51.691646 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-05 20:39:51.692507 (Thread-1): finished collecting timing info
2021-10-05 20:39:51.693165 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:39:51.693941 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 12: FROM "dellstore"."public"."customers";
                                                ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 12: FROM "dellstore"."public"."customers";
                                              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 12: FROM "dellstore"."public"."customers";
                                                ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:39:51.696438 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b04a7c4c-5ac9-40c3-b8d4-148e62e87ddf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55b943760>]}
2021-10-05 20:39:51.698160 (Thread-1): 20:39:51 | 1 of 1 ERROR creating view model public.task2........................ [ERROR in 0.10s]
2021-10-05 20:39:51.698684 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:39:51.701180 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:39:51.701746 (MainThread): Using postgres connection "master".
2021-10-05 20:39:51.702245 (MainThread): On master: BEGIN
2021-10-05 20:39:51.702770 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:39:51.707248 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:39:51.708036 (MainThread): On master: COMMIT
2021-10-05 20:39:51.708594 (MainThread): Using postgres connection "master".
2021-10-05 20:39:51.709302 (MainThread): On master: COMMIT
2021-10-05 20:39:51.710301 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:39:51.710994 (MainThread): On master: Close
2021-10-05 20:39:51.712314 (MainThread): 20:39:51 | 
2021-10-05 20:39:51.713143 (MainThread): 20:39:51 | Finished running 1 view model in 0.22s.
2021-10-05 20:39:51.713682 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:39:51.714146 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:39:51.763854 (MainThread): 
2021-10-05 20:39:51.764379 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 20:39:51.764926 (MainThread): 
2021-10-05 20:39:51.765537 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-05 20:39:51.766885 (MainThread):   syntax error at or near ";"
2021-10-05 20:39:51.767533 (MainThread):   LINE 12: FROM "dellstore"."public"."customers";
2021-10-05 20:39:51.768808 (MainThread):                                                 ^
2021-10-05 20:39:51.769887 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:39:51.770725 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 20:39:51.771396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55b893b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55b893cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa55b91bc10>]}
2021-10-05 20:39:51.771913 (MainThread): Flushing usage events
2021-10-05 20:40:34.043538 (MainThread): Running with dbt=0.19.0
2021-10-05 20:40:34.146444 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:40:34.150839 (MainThread): Tracking: tracking
2021-10-05 20:40:34.152841 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573eb0a9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57405b52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573eb1c190>]}
2021-10-05 20:40:34.189619 (MainThread): Partial parsing not enabled
2021-10-05 20:40:34.200514 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 20:40:34.201381 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:40:34.227224 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:40:34.230571 (MainThread): Parsing macros/relations.sql
2021-10-05 20:40:34.232642 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:40:34.236037 (MainThread): Parsing macros/core.sql
2021-10-05 20:40:34.241941 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:40:34.293788 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:40:34.296544 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:40:34.298744 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:40:34.309594 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:40:34.311777 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:40:34.313283 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:40:34.314623 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:40:34.325576 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:40:34.350373 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:40:34.352706 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:40:34.388739 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:40:34.410227 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:40:34.417977 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:40:34.420413 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:40:34.436686 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:40:34.443058 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:40:34.450691 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:40:34.458738 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:40:34.461289 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:40:34.463403 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:40:34.465930 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:40:34.481074 (MainThread): Partial parsing not enabled
2021-10-05 20:40:34.529744 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:40:34.563056 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:40:34.749921 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:40:34.756803 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d189a26-048f-427a-8665-dcc2ffda4316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e97f3d0>]}
2021-10-05 20:40:34.804247 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:40:34.805885 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 20:40:34.807348 (MainThread): 
2021-10-05 20:40:34.808136 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:40:34.810885 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:40:34.827343 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:40:34.827964 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:40:34.828425 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:40:34.833052 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 20:40:34.836470 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:40:34.842120 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:40:34.850453 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:40:34.851043 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:40:34.851510 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:40:34.855995 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:40:34.856612 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:40:34.857852 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:40:34.860779 (ThreadPoolExecutor-1_0): SQL status: SELECT 9 in 0.00 seconds
2021-10-05 20:40:34.873722 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:40:34.874572 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:40:34.883113 (MainThread): Using postgres connection "master".
2021-10-05 20:40:34.883636 (MainThread): On master: BEGIN
2021-10-05 20:40:34.884068 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:40:34.888118 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:40:34.888776 (MainThread): Using postgres connection "master".
2021-10-05 20:40:34.889200 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:40:34.895742 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-05 20:40:34.896783 (MainThread): On master: ROLLBACK
2021-10-05 20:40:34.897541 (MainThread): Using postgres connection "master".
2021-10-05 20:40:34.898031 (MainThread): On master: BEGIN
2021-10-05 20:40:34.898980 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:40:34.899612 (MainThread): On master: COMMIT
2021-10-05 20:40:34.900114 (MainThread): Using postgres connection "master".
2021-10-05 20:40:34.900638 (MainThread): On master: COMMIT
2021-10-05 20:40:34.901300 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:40:34.901758 (MainThread): On master: Close
2021-10-05 20:40:34.902638 (MainThread): 20:40:34 | Concurrency: 2 threads (target='dev')
2021-10-05 20:40:34.903418 (MainThread): 20:40:34 | 
2021-10-05 20:40:34.907135 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:40:34.908981 (Thread-1): 20:40:34 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:40:34.909788 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:40:34.910305 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:40:34.932872 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:40:34.945645 (Thread-1): finished collecting timing info
2021-10-05 20:40:34.979675 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:34.980304 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:40:34.980861 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:40:34.984635 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:40:34.988430 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:34.988973 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:40:34.989778 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:40:34.995320 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:40:35.006613 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:35.007172 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:40:35.007959 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:40:35.008410 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:35.008816 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM "dellstore"."public"."customers"
  );

2021-10-05 20:40:35.011379 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 20:40:35.019531 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:35.020036 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-05 20:40:35.021033 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:40:35.028938 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 20:40:35.029485 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:35.029924 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 20:40:35.084127 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-10-05 20:40:35.088246 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:40:35.088773 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:40:35.089629 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:40:35.092617 (Thread-1): finished collecting timing info
2021-10-05 20:40:35.093392 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:40:35.094510 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4d189a26-048f-427a-8665-dcc2ffda4316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e9dbb80>]}
2021-10-05 20:40:35.096024 (Thread-1): 20:40:35 | 1 of 1 OK created view model public.task2............................ [CREATE VIEW in 0.18s]
2021-10-05 20:40:35.096664 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:40:35.099260 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:40:35.099927 (MainThread): Using postgres connection "master".
2021-10-05 20:40:35.100526 (MainThread): On master: BEGIN
2021-10-05 20:40:35.101008 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:40:35.105413 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:40:35.106282 (MainThread): On master: COMMIT
2021-10-05 20:40:35.106875 (MainThread): Using postgres connection "master".
2021-10-05 20:40:35.107428 (MainThread): On master: COMMIT
2021-10-05 20:40:35.108369 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:40:35.109109 (MainThread): On master: Close
2021-10-05 20:40:35.110506 (MainThread): 20:40:35 | 
2021-10-05 20:40:35.111141 (MainThread): 20:40:35 | Finished running 1 view model in 0.30s.
2021-10-05 20:40:35.111775 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:40:35.112150 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:40:35.164081 (MainThread): 
2021-10-05 20:40:35.164549 (MainThread): Completed successfully
2021-10-05 20:40:35.165144 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 20:40:35.165753 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e99af70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e940760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573e9d9820>]}
2021-10-05 20:40:35.166694 (MainThread): Flushing usage events
2021-10-05 20:41:25.053599 (MainThread): Running with dbt=0.19.0
2021-10-05 20:41:25.162350 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:41:25.797583 (MainThread): Tracking: tracking
2021-10-05 20:41:25.800871 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23acb79970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ae5a5280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23acb8a160>]}
2021-10-05 20:41:25.841363 (MainThread): Partial parsing not enabled
2021-10-05 20:41:25.848040 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 20:41:25.848818 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:41:25.873495 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:41:25.877157 (MainThread): Parsing macros/relations.sql
2021-10-05 20:41:25.879579 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:41:25.883927 (MainThread): Parsing macros/core.sql
2021-10-05 20:41:25.889541 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:41:25.941934 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:41:25.945232 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:41:25.947640 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:41:25.958371 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:41:25.960782 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:41:25.962436 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:41:25.963968 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:41:25.974799 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:41:26.001017 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:41:26.003926 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:41:26.039548 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:41:26.061732 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:41:26.070342 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:41:26.072941 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:41:26.089362 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:41:26.095636 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:41:26.103712 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:41:26.111989 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:41:26.114477 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:41:26.116615 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:41:26.119197 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:41:26.134807 (MainThread): Partial parsing not enabled
2021-10-05 20:41:26.184938 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:41:26.218374 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:41:26.423408 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:41:26.427947 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63214f22-b347-4d5c-910b-68b7d8f927c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aca070a0>]}
2021-10-05 20:41:26.481812 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:41:26.483724 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 20:41:26.485165 (MainThread): 
2021-10-05 20:41:26.486144 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:41:26.489411 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:41:26.502696 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:41:26.503258 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:41:26.503840 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:41:26.510018 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 20:41:26.513315 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:41:26.517563 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:41:26.526098 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:41:26.526788 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:41:26.527413 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:41:26.531391 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:26.532224 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:41:26.532710 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:41:26.536047 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 20:41:26.547371 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:41:26.548170 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:41:26.557600 (MainThread): Using postgres connection "master".
2021-10-05 20:41:26.558313 (MainThread): On master: BEGIN
2021-10-05 20:41:26.558853 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:41:26.562618 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:26.563451 (MainThread): Using postgres connection "master".
2021-10-05 20:41:26.563895 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:41:26.570360 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 20:41:26.573030 (MainThread): On master: ROLLBACK
2021-10-05 20:41:26.573628 (MainThread): Using postgres connection "master".
2021-10-05 20:41:26.573982 (MainThread): On master: BEGIN
2021-10-05 20:41:26.574730 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:26.575174 (MainThread): On master: COMMIT
2021-10-05 20:41:26.575620 (MainThread): Using postgres connection "master".
2021-10-05 20:41:26.576073 (MainThread): On master: COMMIT
2021-10-05 20:41:26.576632 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:41:26.577019 (MainThread): On master: Close
2021-10-05 20:41:26.577638 (MainThread): 20:41:26 | Concurrency: 2 threads (target='dev')
2021-10-05 20:41:26.578121 (MainThread): 20:41:26 | 
2021-10-05 20:41:26.582730 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:41:26.584641 (Thread-1): 20:41:26 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:41:26.585659 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:41:26.586239 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:41:26.611396 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:41:26.625082 (Thread-1): finished collecting timing info
2021-10-05 20:41:26.659886 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:26.660622 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:41:26.661136 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:41:26.665042 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:41:26.668129 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:26.668619 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:41:26.669503 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:41:26.675579 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:41:26.686688 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:26.687141 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:41:26.687922 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:26.688555 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:26.688963 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits $$ LANGUAGE SQL

SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM "dellstore"."public"."customers"
  );

2021-10-05 20:41:26.689894 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^

2021-10-05 20:41:26.690431 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-05 20:41:26.691328 (Thread-1): finished collecting timing info
2021-10-05 20:41:26.692038 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:41:26.692972 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CREATE"
  LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:41:26.696036 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63214f22-b347-4d5c-910b-68b7d8f927c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aca84730>]}
2021-10-05 20:41:26.698387 (Thread-1): 20:41:26 | 1 of 1 ERROR creating view model public.task2........................ [ERROR in 0.11s]
2021-10-05 20:41:26.698839 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:41:26.701196 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:41:26.701674 (MainThread): Using postgres connection "master".
2021-10-05 20:41:26.702073 (MainThread): On master: BEGIN
2021-10-05 20:41:26.702500 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:41:26.706421 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:26.707119 (MainThread): On master: COMMIT
2021-10-05 20:41:26.707578 (MainThread): Using postgres connection "master".
2021-10-05 20:41:26.707957 (MainThread): On master: COMMIT
2021-10-05 20:41:26.708732 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:41:26.709425 (MainThread): On master: Close
2021-10-05 20:41:26.710351 (MainThread): 20:41:26 | 
2021-10-05 20:41:26.710966 (MainThread): 20:41:26 | Finished running 1 view model in 0.22s.
2021-10-05 20:41:26.711572 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:41:26.712467 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:41:26.762295 (MainThread): 
2021-10-05 20:41:26.762894 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 20:41:26.763538 (MainThread): 
2021-10-05 20:41:26.764268 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-05 20:41:26.765110 (MainThread):   syntax error at or near "CREATE"
2021-10-05 20:41:26.765926 (MainThread):   LINE 4:     CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boo...
2021-10-05 20:41:26.766589 (MainThread):               ^
2021-10-05 20:41:26.767361 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:41:26.767962 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 20:41:26.768991 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23acab6f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23ac9acd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23aca8e310>]}
2021-10-05 20:41:26.770409 (MainThread): Flushing usage events
2021-10-05 20:41:43.297990 (MainThread): Running with dbt=0.19.0
2021-10-05 20:41:43.406437 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:41:43.411732 (MainThread): Tracking: tracking
2021-10-05 20:41:43.414051 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01039cb9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01054772b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01039dd190>]}
2021-10-05 20:41:43.456393 (MainThread): Partial parsing not enabled
2021-10-05 20:41:43.464353 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 20:41:43.465389 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:41:43.490271 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:41:43.493565 (MainThread): Parsing macros/relations.sql
2021-10-05 20:41:43.495834 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:41:43.499058 (MainThread): Parsing macros/core.sql
2021-10-05 20:41:43.504240 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:41:43.552511 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:41:43.555310 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:41:43.557615 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:41:43.568090 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:41:43.570260 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:41:43.571798 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:41:43.573197 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:41:43.583664 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:41:43.607803 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:41:43.610190 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:41:43.643847 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:41:43.667158 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:41:43.675133 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:41:43.677674 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:41:43.693919 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:41:43.700186 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:41:43.707963 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:41:43.716059 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:41:43.718378 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:41:43.720533 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:41:43.723107 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:41:43.739195 (MainThread): Partial parsing not enabled
2021-10-05 20:41:43.786448 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:41:43.815640 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.012253 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:41:44.016492 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a10e8929-f155-4736-93c9-2a47f46b34d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0103841340>]}
2021-10-05 20:41:44.066119 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:41:44.067773 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 20:41:44.069254 (MainThread): 
2021-10-05 20:41:44.070011 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:41:44.072877 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:41:44.087567 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:41:44.088172 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:41:44.088674 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:41:44.094256 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 20:41:44.097451 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:41:44.101572 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:41:44.110037 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:41:44.110643 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:41:44.111115 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:41:44.114538 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:44.115203 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:41:44.115632 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:41:44.118599 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 20:41:44.129905 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:41:44.130674 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:41:44.139556 (MainThread): Using postgres connection "master".
2021-10-05 20:41:44.140190 (MainThread): On master: BEGIN
2021-10-05 20:41:44.140699 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:41:44.144333 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:44.144813 (MainThread): Using postgres connection "master".
2021-10-05 20:41:44.145352 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:41:44.151071 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 20:41:44.153679 (MainThread): On master: ROLLBACK
2021-10-05 20:41:44.154367 (MainThread): Using postgres connection "master".
2021-10-05 20:41:44.154847 (MainThread): On master: BEGIN
2021-10-05 20:41:44.155634 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:44.156184 (MainThread): On master: COMMIT
2021-10-05 20:41:44.156599 (MainThread): Using postgres connection "master".
2021-10-05 20:41:44.157216 (MainThread): On master: COMMIT
2021-10-05 20:41:44.157986 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:41:44.158388 (MainThread): On master: Close
2021-10-05 20:41:44.159073 (MainThread): 20:41:44 | Concurrency: 2 threads (target='dev')
2021-10-05 20:41:44.159652 (MainThread): 20:41:44 | 
2021-10-05 20:41:44.165090 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:41:44.167141 (Thread-1): 20:41:44 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:41:44.168032 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.168669 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:41:44.195616 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:41:44.204025 (Thread-1): finished collecting timing info
2021-10-05 20:41:44.242449 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.242998 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:41:44.243449 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:41:44.247540 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:41:44.250549 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.250943 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:41:44.251650 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:41:44.257614 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:41:44.265686 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.266049 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:41:44.266690 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:44.267007 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.267446 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM "dellstore"."public"."customers"
  );

2021-10-05 20:41:44.269782 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 20:41:44.280157 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.280635 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-05 20:41:44.281518 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:41:44.284467 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.284939 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-05 20:41:44.285824 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:41:44.293303 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 20:41:44.293772 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.294255 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 20:41:44.319560 (Thread-1): SQL status: COMMIT in 0.02 seconds
2021-10-05 20:41:44.323877 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:41:44.324429 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:41:44.358129 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2021-10-05 20:41:44.361364 (Thread-1): finished collecting timing info
2021-10-05 20:41:44.362077 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:41:44.363164 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a10e8929-f155-4736-93c9-2a47f46b34d2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010384bd90>]}
2021-10-05 20:41:44.364974 (Thread-1): 20:41:44 | 1 of 1 OK created view model public.task2............................ [CREATE VIEW in 0.20s]
2021-10-05 20:41:44.365675 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:41:44.368528 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:41:44.369241 (MainThread): Using postgres connection "master".
2021-10-05 20:41:44.369672 (MainThread): On master: BEGIN
2021-10-05 20:41:44.370165 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:41:44.374111 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:41:44.374700 (MainThread): On master: COMMIT
2021-10-05 20:41:44.375207 (MainThread): Using postgres connection "master".
2021-10-05 20:41:44.375653 (MainThread): On master: COMMIT
2021-10-05 20:41:44.376687 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:41:44.377298 (MainThread): On master: Close
2021-10-05 20:41:44.378339 (MainThread): 20:41:44 | 
2021-10-05 20:41:44.379037 (MainThread): 20:41:44 | Finished running 1 view model in 0.31s.
2021-10-05 20:41:44.380194 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:41:44.380992 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:41:44.430580 (MainThread): 
2021-10-05 20:41:44.431087 (MainThread): Completed successfully
2021-10-05 20:41:44.431812 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 20:41:44.432434 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01038a7ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f010389a0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f01039083a0>]}
2021-10-05 20:41:44.433397 (MainThread): Flushing usage events
2021-10-05 20:54:06.302448 (MainThread): Running with dbt=0.19.0
2021-10-05 20:54:06.419251 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:54:06.424633 (MainThread): Tracking: tracking
2021-10-05 20:54:06.426865 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc38c9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fde362b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc39d190>]}
2021-10-05 20:54:06.467018 (MainThread): Partial parsing not enabled
2021-10-05 20:54:06.473406 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 20:54:06.474361 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:54:06.500116 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:54:06.503295 (MainThread): Parsing macros/relations.sql
2021-10-05 20:54:06.505583 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:54:06.508940 (MainThread): Parsing macros/core.sql
2021-10-05 20:54:06.514378 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:54:06.562686 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:54:06.565709 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:54:06.568126 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:54:06.579060 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:54:06.581433 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:54:06.583153 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:54:06.584738 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:54:06.595844 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:54:06.620787 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:54:06.623338 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:54:06.658736 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:54:06.681022 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:54:06.689059 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:54:06.691700 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:54:06.708700 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:54:06.715052 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:54:06.723381 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:54:06.731810 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:54:06.734369 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:54:06.736605 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:54:06.739371 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:54:06.755606 (MainThread): Partial parsing not enabled
2021-10-05 20:54:06.810955 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:54:06.842440 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:54:07.051457 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:54:07.057588 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cfaba7eb-0bf0-4ef7-aabc-dfe1c2ddfa2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc266a90>]}
2021-10-05 20:54:07.113844 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:54:07.115781 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 20:54:07.117241 (MainThread): 
2021-10-05 20:54:07.118569 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:54:07.121117 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:54:07.135363 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:54:07.136009 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:54:07.136589 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:54:07.143630 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 20:54:07.146850 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:54:07.151032 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:54:07.159709 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:54:07.160282 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:54:07.160755 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:54:07.164570 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:07.165221 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:54:07.165764 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:54:07.168903 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 20:54:07.182127 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:54:07.183007 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:54:07.193476 (MainThread): Using postgres connection "master".
2021-10-05 20:54:07.194167 (MainThread): On master: BEGIN
2021-10-05 20:54:07.194676 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:54:07.198682 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:07.199302 (MainThread): Using postgres connection "master".
2021-10-05 20:54:07.199917 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:54:07.207271 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 20:54:07.209929 (MainThread): On master: ROLLBACK
2021-10-05 20:54:07.210836 (MainThread): Using postgres connection "master".
2021-10-05 20:54:07.211278 (MainThread): On master: BEGIN
2021-10-05 20:54:07.212213 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:07.212805 (MainThread): On master: COMMIT
2021-10-05 20:54:07.213437 (MainThread): Using postgres connection "master".
2021-10-05 20:54:07.214085 (MainThread): On master: COMMIT
2021-10-05 20:54:07.214921 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:54:07.215379 (MainThread): On master: Close
2021-10-05 20:54:07.216165 (MainThread): 20:54:07 | Concurrency: 2 threads (target='dev')
2021-10-05 20:54:07.216695 (MainThread): 20:54:07 | 
2021-10-05 20:54:07.220370 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:54:07.222537 (Thread-1): 20:54:07 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:54:07.223533 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:54:07.223985 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:54:07.259870 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:54:07.269937 (Thread-1): finished collecting timing info
2021-10-05 20:54:07.305973 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:07.306569 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:54:07.307107 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:54:07.310993 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:54:07.314239 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:07.314771 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:54:07.316655 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:54:07.322545 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:54:07.332671 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:07.333023 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:54:07.333637 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:07.334041 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:07.334492 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    /*SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM "dellstore"."public"."customers"*/

SELECT
	orderdate AS OrderDate,
	SUM(netamount) AS Amount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as full_data 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate;
  );

2021-10-05 20:54:07.335351 (Thread-1): Postgres error: syntax error at or near ";"
LINE 26: GROUP BY orderdate;
                           ^

2021-10-05 20:54:07.335823 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-05 20:54:07.336471 (Thread-1): finished collecting timing info
2021-10-05 20:54:07.337116 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:54:07.338031 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 26: GROUP BY orderdate;
                             ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 26: GROUP BY orderdate;
                           ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 26: GROUP BY orderdate;
                             ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:54:07.340839 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cfaba7eb-0bf0-4ef7-aabc-dfe1c2ddfa2d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc1e83d0>]}
2021-10-05 20:54:07.343290 (Thread-1): 20:54:07 | 1 of 1 ERROR creating view model public.task2........................ [ERROR in 0.12s]
2021-10-05 20:54:07.345182 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:54:07.349134 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:54:07.349712 (MainThread): Using postgres connection "master".
2021-10-05 20:54:07.350200 (MainThread): On master: BEGIN
2021-10-05 20:54:07.350680 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:54:07.356615 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 20:54:07.357272 (MainThread): On master: COMMIT
2021-10-05 20:54:07.357683 (MainThread): Using postgres connection "master".
2021-10-05 20:54:07.358102 (MainThread): On master: COMMIT
2021-10-05 20:54:07.359125 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:54:07.359811 (MainThread): On master: Close
2021-10-05 20:54:07.360598 (MainThread): 20:54:07 | 
2021-10-05 20:54:07.361177 (MainThread): 20:54:07 | Finished running 1 view model in 0.24s.
2021-10-05 20:54:07.361853 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:54:07.362877 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:54:07.411870 (MainThread): 
2021-10-05 20:54:07.412486 (MainThread): Completed with 1 error and 0 warnings:
2021-10-05 20:54:07.413077 (MainThread): 
2021-10-05 20:54:07.413664 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-05 20:54:07.414261 (MainThread):   syntax error at or near ";"
2021-10-05 20:54:07.415518 (MainThread):   LINE 26: GROUP BY orderdate;
2021-10-05 20:54:07.416267 (MainThread):                              ^
2021-10-05 20:54:07.417325 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-05 20:54:07.418138 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-05 20:54:07.419025 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc172fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc1d8f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa1fc1f26a0>]}
2021-10-05 20:54:07.419927 (MainThread): Flushing usage events
2021-10-05 20:54:23.281685 (MainThread): Running with dbt=0.19.0
2021-10-05 20:54:23.398285 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 20:54:23.402690 (MainThread): Tracking: tracking
2021-10-05 20:54:23.404792 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae329970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1afdd4280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae33a160>]}
2021-10-05 20:54:23.442833 (MainThread): Partial parsing not enabled
2021-10-05 20:54:23.448582 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 20:54:23.449552 (MainThread): Parsing macros/adapters.sql
2021-10-05 20:54:23.475971 (MainThread): Parsing macros/catalog.sql
2021-10-05 20:54:23.479274 (MainThread): Parsing macros/relations.sql
2021-10-05 20:54:23.481814 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 20:54:23.485399 (MainThread): Parsing macros/core.sql
2021-10-05 20:54:23.490852 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 20:54:23.542866 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 20:54:23.545910 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 20:54:23.548255 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 20:54:23.558970 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 20:54:23.561223 (MainThread): Parsing macros/etc/query.sql
2021-10-05 20:54:23.562839 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 20:54:23.564372 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 20:54:23.575294 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 20:54:23.600010 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 20:54:23.602574 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 20:54:23.637011 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 20:54:23.658749 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 20:54:23.666519 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 20:54:23.669269 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 20:54:23.685758 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 20:54:23.691991 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 20:54:23.699963 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 20:54:23.708273 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 20:54:23.710686 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 20:54:23.712875 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 20:54:23.715464 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 20:54:23.730889 (MainThread): Partial parsing not enabled
2021-10-05 20:54:23.779654 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 20:54:23.816333 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.022481 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 20:54:24.027936 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48d21f2e-04b2-4845-aa3d-f1064112eea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae192040>]}
2021-10-05 20:54:24.079094 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 20:54:24.081244 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 20:54:24.082742 (MainThread): 
2021-10-05 20:54:24.083547 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:54:24.086989 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 20:54:24.100662 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 20:54:24.101219 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 20:54:24.101702 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 20:54:24.107438 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.01 seconds
2021-10-05 20:54:24.110938 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 20:54:24.116022 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 20:54:24.124843 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:54:24.125585 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 20:54:24.126189 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 20:54:24.129994 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:24.130554 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 20:54:24.131152 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 20:54:24.134190 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 20:54:24.146212 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 20:54:24.146913 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 20:54:24.155204 (MainThread): Using postgres connection "master".
2021-10-05 20:54:24.155896 (MainThread): On master: BEGIN
2021-10-05 20:54:24.156702 (MainThread): Opening a new connection, currently in state init
2021-10-05 20:54:24.160663 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:24.161200 (MainThread): Using postgres connection "master".
2021-10-05 20:54:24.161621 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 20:54:24.167163 (MainThread): SQL status: SELECT 1 in 0.01 seconds
2021-10-05 20:54:24.169570 (MainThread): On master: ROLLBACK
2021-10-05 20:54:24.170320 (MainThread): Using postgres connection "master".
2021-10-05 20:54:24.170829 (MainThread): On master: BEGIN
2021-10-05 20:54:24.171713 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:24.172415 (MainThread): On master: COMMIT
2021-10-05 20:54:24.173126 (MainThread): Using postgres connection "master".
2021-10-05 20:54:24.173597 (MainThread): On master: COMMIT
2021-10-05 20:54:24.174215 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:54:24.174537 (MainThread): On master: Close
2021-10-05 20:54:24.175131 (MainThread): 20:54:24 | Concurrency: 2 threads (target='dev')
2021-10-05 20:54:24.175595 (MainThread): 20:54:24 | 
2021-10-05 20:54:24.179657 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 20:54:24.181652 (Thread-1): 20:54:24 | 1 of 1 START view model public.task2................................. [RUN]
2021-10-05 20:54:24.182600 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.183099 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 20:54:24.212296 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 20:54:24.221756 (Thread-1): finished collecting timing info
2021-10-05 20:54:24.258305 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.258815 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 20:54:24.259175 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 20:54:24.262988 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:54:24.266099 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.266485 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:54:24.267117 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 20:54:24.273266 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 20:54:24.280307 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.280706 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 20:54:24.281686 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:24.282114 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.282580 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

  create view "dellstore"."public"."task2__dbt_tmp" as (
    /*SELECT 
COUNT(*) AS all_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = FALSE)) as invalid_numbers,
COUNT(*) FILTER 
	(WHERE 
		(SELECT luhn_verify(creditcard::int8) = TRUE)) as valid_numbers
FROM "dellstore"."public"."customers"*/

SELECT
	orderdate AS OrderDate,
	SUM(netamount) AS Amount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as full_data 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );

2021-10-05 20:54:24.286308 (Thread-1): SQL status: CREATE VIEW in 0.00 seconds
2021-10-05 20:54:24.296217 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.296641 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-05 20:54:24.297441 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:54:24.300309 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.300670 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-05 20:54:24.301474 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 20:54:24.308919 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 20:54:24.309326 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.309654 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 20:54:24.339315 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-10-05 20:54:24.343824 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 20:54:24.344399 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 20:54:24.378841 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2021-10-05 20:54:24.382011 (Thread-1): finished collecting timing info
2021-10-05 20:54:24.382629 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 20:54:24.383733 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '48d21f2e-04b2-4845-aa3d-f1064112eea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae2ef5e0>]}
2021-10-05 20:54:24.385470 (Thread-1): 20:54:24 | 1 of 1 OK created view model public.task2............................ [CREATE VIEW in 0.20s]
2021-10-05 20:54:24.386103 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 20:54:24.388455 (MainThread): Acquiring new postgres connection "master".
2021-10-05 20:54:24.389231 (MainThread): Using postgres connection "master".
2021-10-05 20:54:24.389767 (MainThread): On master: BEGIN
2021-10-05 20:54:24.390255 (MainThread): Opening a new connection, currently in state closed
2021-10-05 20:54:24.394577 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 20:54:24.395230 (MainThread): On master: COMMIT
2021-10-05 20:54:24.395914 (MainThread): Using postgres connection "master".
2021-10-05 20:54:24.396521 (MainThread): On master: COMMIT
2021-10-05 20:54:24.397215 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 20:54:24.397725 (MainThread): On master: Close
2021-10-05 20:54:24.398628 (MainThread): 20:54:24 | 
2021-10-05 20:54:24.399374 (MainThread): 20:54:24 | Finished running 1 view model in 0.32s.
2021-10-05 20:54:24.399897 (MainThread): Connection 'master' was properly closed.
2021-10-05 20:54:24.400419 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 20:54:24.451541 (MainThread): 
2021-10-05 20:54:24.452170 (MainThread): Completed successfully
2021-10-05 20:54:24.452800 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 20:54:24.453475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae1e0fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae1e2ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb1ae219550>]}
2021-10-05 20:54:24.454647 (MainThread): Flushing usage events
2021-10-05 21:28:28.368529 (MainThread): Running with dbt=0.19.0
2021-10-05 21:28:28.481883 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task1_snapshot.sql'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 21:28:28.486422 (MainThread): Tracking: tracking
2021-10-05 21:28:28.488520 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c3f0bbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c2465f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c2465fd0>]}
2021-10-05 21:28:28.529366 (MainThread): Partial parsing not enabled
2021-10-05 21:28:28.536757 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 21:28:28.537686 (MainThread): Parsing macros/adapters.sql
2021-10-05 21:28:28.563860 (MainThread): Parsing macros/catalog.sql
2021-10-05 21:28:28.567460 (MainThread): Parsing macros/relations.sql
2021-10-05 21:28:28.569574 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 21:28:28.573074 (MainThread): Parsing macros/core.sql
2021-10-05 21:28:28.578609 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 21:28:28.631332 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 21:28:28.634334 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 21:28:28.636819 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 21:28:28.649213 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 21:28:28.651698 (MainThread): Parsing macros/etc/query.sql
2021-10-05 21:28:28.653428 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 21:28:28.655171 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 21:28:28.666730 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 21:28:28.692876 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 21:28:28.695554 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 21:28:28.731280 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 21:28:28.753591 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 21:28:28.762064 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 21:28:28.764676 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 21:28:28.782549 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 21:28:28.789094 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 21:28:28.797156 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 21:28:28.806637 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 21:28:28.809211 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 21:28:28.811426 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 21:28:28.814121 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 21:28:28.830334 (MainThread): Partial parsing not enabled
2021-10-05 21:28:28.882217 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 21:28:28.915188 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:28:28.940261 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c24295b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c228dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f64c2294160>]}
2021-10-05 21:28:28.940794 (MainThread): Flushing usage events
2021-10-05 21:28:30.212985 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 21:28:30.214067 (MainThread): Encountered an error:
2021-10-05 21:28:30.214763 (MainThread): Compilation Error in snapshots/task1_snapshot.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)
2021-10-05 21:28:30.216943 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 81, in parse_file
    for block in blocks:
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 124, in __iter__
    for block in self.extract_blocks(entry):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 107, in extract_blocks
    blocks = extract_toplevel_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 603, in extract_toplevel_blocks
    return BlockIterator(data).lex_for_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 392, in lex_for_blocks
    return list(self.find_blocks(allowed_blocks=allowed_blocks,
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 381, in find_blocks
    dbt.exceptions.raise_compiler_error((
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshots/task1_snapshot.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)

2021-10-05 21:28:33.621076 (MainThread): Running with dbt=0.19.0
2021-10-05 21:28:33.728265 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task1_snapshot'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 21:28:33.732171 (MainThread): Tracking: tracking
2021-10-05 21:28:33.734359 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c27b769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c29621310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c27b881c0>]}
2021-10-05 21:28:33.774730 (MainThread): Partial parsing not enabled
2021-10-05 21:28:33.783178 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 21:28:33.784183 (MainThread): Parsing macros/adapters.sql
2021-10-05 21:28:33.810571 (MainThread): Parsing macros/catalog.sql
2021-10-05 21:28:33.813799 (MainThread): Parsing macros/relations.sql
2021-10-05 21:28:33.816051 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 21:28:33.819643 (MainThread): Parsing macros/core.sql
2021-10-05 21:28:33.825016 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 21:28:33.878946 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 21:28:33.881760 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 21:28:33.884071 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 21:28:33.894930 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 21:28:33.897177 (MainThread): Parsing macros/etc/query.sql
2021-10-05 21:28:33.898922 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 21:28:33.900382 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 21:28:33.912235 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 21:28:33.937900 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 21:28:33.940743 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 21:28:33.976463 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 21:28:34.000082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 21:28:34.008020 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 21:28:34.010565 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 21:28:34.026974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 21:28:34.034152 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 21:28:34.042027 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 21:28:34.050324 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 21:28:34.052840 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 21:28:34.054998 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 21:28:34.057697 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 21:28:34.074698 (MainThread): Partial parsing not enabled
2021-10-05 21:28:34.123773 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 21:28:34.154980 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:28:34.174864 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c27ad6100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c279a31f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c279a3340>]}
2021-10-05 21:28:34.175499 (MainThread): Flushing usage events
2021-10-05 21:28:34.857657 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 21:28:34.859171 (MainThread): Encountered an error:
2021-10-05 21:28:34.859945 (MainThread): Compilation Error in snapshots/task1_snapshot.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)
2021-10-05 21:28:34.862352 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/snapshots.py", line 81, in parse_file
    for block in blocks:
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 124, in __iter__
    for block in self.extract_blocks(entry):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/search.py", line 107, in extract_blocks
    blocks = extract_toplevel_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 603, in extract_toplevel_blocks
    return BlockIterator(data).lex_for_blocks(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 392, in lex_for_blocks
    return list(self.find_blocks(allowed_blocks=allowed_blocks,
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/_jinja_blocks.py", line 381, in find_blocks
    dbt.exceptions.raise_compiler_error((
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in snapshots/task1_snapshot.sql
  Reached EOF without finding a close tag for snapshot (searched from line 1)

2021-10-05 21:29:25.824229 (MainThread): Running with dbt=0.19.0
2021-10-05 21:29:25.947408 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task1_snapshot'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 21:29:25.953167 (MainThread): Tracking: tracking
2021-10-05 21:29:25.955396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626487aa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6266324310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626488a280>]}
2021-10-05 21:29:25.998785 (MainThread): Partial parsing not enabled
2021-10-05 21:29:26.005764 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 21:29:26.006716 (MainThread): Parsing macros/adapters.sql
2021-10-05 21:29:26.032971 (MainThread): Parsing macros/catalog.sql
2021-10-05 21:29:26.036921 (MainThread): Parsing macros/relations.sql
2021-10-05 21:29:26.039271 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 21:29:26.042989 (MainThread): Parsing macros/core.sql
2021-10-05 21:29:26.048653 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 21:29:26.101640 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 21:29:26.104495 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 21:29:26.106887 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 21:29:26.118456 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 21:29:26.120882 (MainThread): Parsing macros/etc/query.sql
2021-10-05 21:29:26.122565 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 21:29:26.124050 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 21:29:26.135758 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 21:29:26.163824 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 21:29:26.166466 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 21:29:26.203606 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 21:29:26.228860 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 21:29:26.237657 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 21:29:26.240789 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 21:29:26.257810 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 21:29:26.264282 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 21:29:26.272871 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 21:29:26.281480 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 21:29:26.283907 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 21:29:26.286220 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 21:29:26.289069 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 21:29:26.304915 (MainThread): Partial parsing not enabled
2021-10-05 21:29:26.355182 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 21:29:26.388707 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:29:26.428765 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:29:26.658944 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 21:29:26.665110 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '47e94c1f-517c-4c95-a6c5-e7a29e543e21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6264756d90>]}
2021-10-05 21:29:26.722593 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 21:29:26.724488 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 21:29:26.725897 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-05 21:29:26.726497 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626461c430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626461c400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f626461c700>]}
2021-10-05 21:29:26.727261 (MainThread): Flushing usage events
2021-10-05 21:29:27.313767 (MainThread): Connection 'snapshot.my_new_project.task1_snapshot' was properly closed.
2021-10-05 21:33:47.608702 (MainThread): Running with dbt=0.19.0
2021-10-05 21:33:47.727300 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 21:33:47.730720 (MainThread): Tracking: tracking
2021-10-05 21:33:47.732647 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb78a8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cd1b62b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb79b2e0>]}
2021-10-05 21:33:47.776049 (MainThread): Partial parsing not enabled
2021-10-05 21:33:47.782435 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 21:33:47.783259 (MainThread): Parsing macros/adapters.sql
2021-10-05 21:33:47.816359 (MainThread): Parsing macros/catalog.sql
2021-10-05 21:33:47.820021 (MainThread): Parsing macros/relations.sql
2021-10-05 21:33:47.822321 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 21:33:47.826049 (MainThread): Parsing macros/core.sql
2021-10-05 21:33:47.832449 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 21:33:47.895342 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 21:33:47.898831 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 21:33:47.901308 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 21:33:47.913796 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 21:33:47.916318 (MainThread): Parsing macros/etc/query.sql
2021-10-05 21:33:47.918184 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 21:33:47.919881 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 21:33:47.932442 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 21:33:47.961693 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 21:33:47.965121 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 21:33:48.002698 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 21:33:48.025806 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 21:33:48.034354 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 21:33:48.036940 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 21:33:48.057255 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 21:33:48.064552 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 21:33:48.072771 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 21:33:48.081213 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 21:33:48.083691 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 21:33:48.085796 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 21:33:48.088395 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 21:33:48.103643 (MainThread): Partial parsing not enabled
2021-10-05 21:33:48.153686 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 21:33:48.185208 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:33:48.220780 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.452863 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 21:33:48.458131 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9dde15dc-211a-4687-adb4-992f3755cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb6a5130>]}
2021-10-05 21:33:48.513118 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 21:33:48.514689 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 21:33:48.516327 (MainThread): 
2021-10-05 21:33:48.517517 (MainThread): Acquiring new postgres connection "master".
2021-10-05 21:33:48.519988 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 21:33:48.536291 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 21:33:48.536799 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 21:33:48.537278 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 21:33:48.541734 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 21:33:48.545064 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 21:33:48.552267 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 21:33:48.560931 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 21:33:48.561533 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 21:33:48.561995 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 21:33:48.566533 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:33:48.567279 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 21:33:48.567835 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 21:33:48.570593 (ThreadPoolExecutor-1_0): SQL status: SELECT 10 in 0.00 seconds
2021-10-05 21:33:48.582387 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 21:33:48.583555 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 21:33:48.593190 (MainThread): Using postgres connection "master".
2021-10-05 21:33:48.593752 (MainThread): On master: BEGIN
2021-10-05 21:33:48.594240 (MainThread): Opening a new connection, currently in state init
2021-10-05 21:33:48.599241 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-05 21:33:48.599881 (MainThread): Using postgres connection "master".
2021-10-05 21:33:48.600371 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 21:33:48.605691 (MainThread): SQL status: SELECT 2 in 0.00 seconds
2021-10-05 21:33:48.609524 (MainThread): On master: ROLLBACK
2021-10-05 21:33:48.610278 (MainThread): Using postgres connection "master".
2021-10-05 21:33:48.610707 (MainThread): On master: BEGIN
2021-10-05 21:33:48.611643 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:33:48.612437 (MainThread): On master: COMMIT
2021-10-05 21:33:48.613046 (MainThread): Using postgres connection "master".
2021-10-05 21:33:48.613540 (MainThread): On master: COMMIT
2021-10-05 21:33:48.614242 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 21:33:48.614773 (MainThread): On master: Close
2021-10-05 21:33:48.615450 (MainThread): 21:33:48 | Concurrency: 2 threads (target='dev')
2021-10-05 21:33:48.616274 (MainThread): 21:33:48 | 
2021-10-05 21:33:48.619907 (Thread-1): Began running node snapshot.my_new_project.task1_snapshot
2021-10-05 21:33:48.621839 (Thread-1): 21:33:48 | 1 of 1 START snapshot public.task1_snapshot.......................... [RUN]
2021-10-05 21:33:48.622702 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.623259 (Thread-1): Compiling snapshot.my_new_project.task1_snapshot
2021-10-05 21:33:48.642856 (Thread-1): finished collecting timing info
2021-10-05 21:33:48.687076 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.687692 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-05 21:33:48.688266 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 21:33:48.692615 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 21:33:48.733581 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.734275 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-05 21:33:48.735373 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 21:33:48.756532 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.task1_snapshot"
2021-10-05 21:33:48.773889 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.774317 (Thread-1): On snapshot.my_new_project.task1_snapshot: BEGIN
2021-10-05 21:33:48.775017 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:33:48.775447 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.775875 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      

  create  table "dellstore"."public"."task1_snapshot"
  as (
    

    select *,
        md5(coalesce(cast(prod_id as varchar ), '')
         || '|' || coalesce(cast('2021-10-05 21:33:48.691706'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id,
        '2021-10-05 21:33:48.691706'::timestamp without time zone as dbt_updated_at,
        '2021-10-05 21:33:48.691706'::timestamp without time zone as dbt_valid_from,
        nullif('2021-10-05 21:33:48.691706'::timestamp without time zone, '2021-10-05 21:33:48.691706'::timestamp without time zone) as dbt_valid_to
    from (
        



SELECT * FROM "dellstore"."public"."products"

    ) sbq


  );
  
2021-10-05 21:33:48.957500 (Thread-1): SQL status: SELECT 10000 in 0.18 seconds
2021-10-05 21:33:48.965084 (Thread-1): On snapshot.my_new_project.task1_snapshot: COMMIT
2021-10-05 21:33:48.965747 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:33:48.966355 (Thread-1): On snapshot.my_new_project.task1_snapshot: COMMIT
2021-10-05 21:33:49.045795 (Thread-1): SQL status: COMMIT in 0.08 seconds
2021-10-05 21:33:49.048493 (Thread-1): finished collecting timing info
2021-10-05 21:33:49.049237 (Thread-1): On snapshot.my_new_project.task1_snapshot: Close
2021-10-05 21:33:49.050371 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9dde15dc-211a-4687-adb4-992f3755cb05', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cacd8e50>]}
2021-10-05 21:33:49.052771 (Thread-1): 21:33:49 | 1 of 1 OK snapshotted public.task1_snapshot.......................... [SELECT 10000 in 0.43s]
2021-10-05 21:33:49.053439 (Thread-1): Finished running node snapshot.my_new_project.task1_snapshot
2021-10-05 21:33:49.056498 (MainThread): Acquiring new postgres connection "master".
2021-10-05 21:33:49.058434 (MainThread): Using postgres connection "master".
2021-10-05 21:33:49.058991 (MainThread): On master: BEGIN
2021-10-05 21:33:49.059606 (MainThread): Opening a new connection, currently in state closed
2021-10-05 21:33:49.064424 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:33:49.065346 (MainThread): On master: COMMIT
2021-10-05 21:33:49.065907 (MainThread): Using postgres connection "master".
2021-10-05 21:33:49.066515 (MainThread): On master: COMMIT
2021-10-05 21:33:49.067402 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 21:33:49.068013 (MainThread): On master: Close
2021-10-05 21:33:49.068864 (MainThread): 21:33:49 | 
2021-10-05 21:33:49.069638 (MainThread): 21:33:49 | Finished running 1 snapshot in 0.55s.
2021-10-05 21:33:49.070504 (MainThread): Connection 'master' was properly closed.
2021-10-05 21:33:49.071395 (MainThread): Connection 'snapshot.my_new_project.task1_snapshot' was properly closed.
2021-10-05 21:33:49.124511 (MainThread): 
2021-10-05 21:33:49.125081 (MainThread): Completed successfully
2021-10-05 21:33:49.125788 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 21:33:49.126686 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cb566c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cacd0df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43cacc3d00>]}
2021-10-05 21:33:49.127271 (MainThread): Flushing usage events
2021-10-05 21:56:11.941065 (MainThread): Running with dbt=0.19.0
2021-10-05 21:56:12.047445 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.snapshot.SnapshotTask'>, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='snapshot', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='snapshot', write_json=True)
2021-10-05 21:56:12.053261 (MainThread): Tracking: tracking
2021-10-05 21:56:12.055366 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd9878e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cf432310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd998310>]}
2021-10-05 21:56:12.095544 (MainThread): Partial parsing not enabled
2021-10-05 21:56:12.102828 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 21:56:12.103793 (MainThread): Parsing macros/adapters.sql
2021-10-05 21:56:12.130161 (MainThread): Parsing macros/catalog.sql
2021-10-05 21:56:12.133353 (MainThread): Parsing macros/relations.sql
2021-10-05 21:56:12.135859 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 21:56:12.139206 (MainThread): Parsing macros/core.sql
2021-10-05 21:56:12.144567 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 21:56:12.197777 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 21:56:12.200691 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 21:56:12.203218 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 21:56:12.215533 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 21:56:12.218428 (MainThread): Parsing macros/etc/query.sql
2021-10-05 21:56:12.220195 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 21:56:12.221709 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 21:56:12.236652 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 21:56:12.264500 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 21:56:12.267365 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 21:56:12.304243 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 21:56:12.326998 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 21:56:12.335215 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 21:56:12.337839 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 21:56:12.357065 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 21:56:12.365652 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 21:56:12.374282 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 21:56:12.383374 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 21:56:12.385976 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 21:56:12.388256 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 21:56:12.390918 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 21:56:12.407678 (MainThread): Partial parsing not enabled
2021-10-05 21:56:12.459511 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 21:56:12.491061 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:56:12.522358 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:12.750003 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 21:56:12.757907 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '568f246d-f7c8-4178-a19d-feb197d270e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd87a6d0>]}
2021-10-05 21:56:12.814207 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 21:56:12.816042 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 21:56:12.817898 (MainThread): 
2021-10-05 21:56:12.818718 (MainThread): Acquiring new postgres connection "master".
2021-10-05 21:56:12.821430 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 21:56:12.837131 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 21:56:12.837825 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 21:56:12.838398 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 21:56:12.843206 (ThreadPoolExecutor-0_0): SQL status: SELECT 6 in 0.00 seconds
2021-10-05 21:56:12.846417 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 21:56:12.853085 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 21:56:12.861014 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 21:56:12.861540 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 21:56:12.861932 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 21:56:12.866351 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:56:12.867623 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 21:56:12.868234 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 21:56:12.872656 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-05 21:56:12.886095 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 21:56:12.887105 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 21:56:12.897104 (MainThread): Using postgres connection "master".
2021-10-05 21:56:12.897710 (MainThread): On master: BEGIN
2021-10-05 21:56:12.898209 (MainThread): Opening a new connection, currently in state init
2021-10-05 21:56:12.902881 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:56:12.903816 (MainThread): Using postgres connection "master".
2021-10-05 21:56:12.904405 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 21:56:12.910409 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-05 21:56:12.914927 (MainThread): On master: ROLLBACK
2021-10-05 21:56:12.916043 (MainThread): Using postgres connection "master".
2021-10-05 21:56:12.916572 (MainThread): On master: BEGIN
2021-10-05 21:56:12.917566 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:56:12.918186 (MainThread): On master: COMMIT
2021-10-05 21:56:12.918663 (MainThread): Using postgres connection "master".
2021-10-05 21:56:12.919294 (MainThread): On master: COMMIT
2021-10-05 21:56:12.920122 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 21:56:12.920621 (MainThread): On master: Close
2021-10-05 21:56:12.921528 (MainThread): 21:56:12 | Concurrency: 2 threads (target='dev')
2021-10-05 21:56:12.922081 (MainThread): 21:56:12 | 
2021-10-05 21:56:12.930693 (Thread-1): Began running node snapshot.my_new_project.task1_snapshot
2021-10-05 21:56:12.933414 (Thread-1): 21:56:12 | 1 of 1 START snapshot public.task1_snapshot.......................... [RUN]
2021-10-05 21:56:12.934241 (Thread-1): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:12.935830 (Thread-1): Compiling snapshot.my_new_project.task1_snapshot
2021-10-05 21:56:12.956277 (Thread-1): finished collecting timing info
2021-10-05 21:56:12.999070 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:12.999722 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

    select count(*) from pg_namespace where nspname = 'public'
  
2021-10-05 21:56:13.000207 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 21:56:13.004880 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 21:56:13.044181 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.044851 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

    select now()::timestamp without time zone as snapshot_start
  
2021-10-05 21:56:13.045802 (Thread-1): SQL status: SELECT 1 in 0.00 seconds
2021-10-05 21:56:13.061448 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.062108 (Thread-1): On snapshot.my_new_project.task1_snapshot: BEGIN
2021-10-05 21:56:13.062962 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:56:13.063406 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.063992 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'task1_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 21:56:13.075616 (Thread-1): SQL status: SELECT 11 in 0.01 seconds
2021-10-05 21:56:13.107605 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.108226 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

        

  create temporary table "task1_snapshot__dbt_tmp215613094552"
  as (
    with snapshot_query as (

        



SELECT * FROM "dellstore"."public"."products"


    ),

    snapshotted_data as (

        select *,
            prod_id as dbt_unique_key

        from "dellstore"."public"."task1_snapshot"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            prod_id as dbt_unique_key,
            '2021-10-05 21:56:13.003899'::timestamp without time zone as dbt_updated_at,
            '2021-10-05 21:56:13.003899'::timestamp without time zone as dbt_valid_from,
            nullif('2021-10-05 21:56:13.003899'::timestamp without time zone, '2021-10-05 21:56:13.003899'::timestamp without time zone) as dbt_valid_to,
            md5(coalesce(cast(prod_id as varchar ), '')
         || '|' || coalesce(cast('2021-10-05 21:56:13.003899'::timestamp without time zone as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            prod_id as dbt_unique_key,
            '2021-10-05 21:56:13.003899'::timestamp without time zone as dbt_updated_at,
            '2021-10-05 21:56:13.003899'::timestamp without time zone as dbt_valid_from,
            '2021-10-05 21:56:13.003899'::timestamp without time zone as dbt_valid_to

        from snapshot_query
    ),

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.price != source_data.price
        or
        (
            ((snapshotted_data.price is null) and not (source_data.price is null))
            or
            ((not snapshotted_data.price is null) and (source_data.price is null))
        ) or snapshotted_data.special != source_data.special
        or
        (
            ((snapshotted_data.special is null) and not (source_data.special is null))
            or
            ((not snapshotted_data.special is null) and (source_data.special is null))
        ))
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.price != source_data.price
        or
        (
            ((snapshotted_data.price is null) and not (source_data.price is null))
            or
            ((not snapshotted_data.price is null) and (source_data.price is null))
        ) or snapshotted_data.special != source_data.special
        or
        (
            ((snapshotted_data.special is null) and not (source_data.special is null))
            or
            ((not snapshotted_data.special is null) and (source_data.special is null))
        ))
        )
    )

    select * from insertions
    union all
    select * from updates
  );
    
2021-10-05 21:56:13.159799 (Thread-1): SQL status: SELECT 1 in 0.05 seconds
2021-10-05 21:56:13.164755 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.165437 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'task1_snapshot__dbt_tmp215613094552'
        
      order by ordinal_position

  
2021-10-05 21:56:13.168938 (Thread-1): SQL status: SELECT 13 in 0.00 seconds
2021-10-05 21:56:13.173446 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.174036 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'task1_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 21:56:13.177762 (Thread-1): SQL status: SELECT 11 in 0.00 seconds
2021-10-05 21:56:13.182592 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.183164 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'task1_snapshot__dbt_tmp215613094552'
        
      order by ordinal_position

  
2021-10-05 21:56:13.186739 (Thread-1): SQL status: SELECT 13 in 0.00 seconds
2021-10-05 21:56:13.191343 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.191872 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from "dellstore".INFORMATION_SCHEMA.columns
      where table_name = 'task1_snapshot'
        
        and table_schema = 'public'
        
      order by ordinal_position

  
2021-10-05 21:56:13.196210 (Thread-1): SQL status: SELECT 11 in 0.00 seconds
2021-10-05 21:56:13.205889 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.206599 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      select
          column_name,
          data_type,
          character_maximum_length,
          numeric_precision,
          numeric_scale

      from INFORMATION_SCHEMA.columns
      where table_name = 'task1_snapshot__dbt_tmp215613094552'
        
      order by ordinal_position

  
2021-10-05 21:56:13.210250 (Thread-1): SQL status: SELECT 13 in 0.00 seconds
2021-10-05 21:56:13.218222 (Thread-1): Writing runtime SQL for node "snapshot.my_new_project.task1_snapshot"
2021-10-05 21:56:13.229213 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.229628 (Thread-1): On snapshot.my_new_project.task1_snapshot: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "snapshot.my_new_project.task1_snapshot"} */

      update "dellstore"."public"."task1_snapshot"
    set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to
    from "task1_snapshot__dbt_tmp215613094552" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_scd_id::text = "dellstore"."public"."task1_snapshot".dbt_scd_id::text
      and DBT_INTERNAL_SOURCE.dbt_change_type::text in ('update'::text, 'delete'::text)
      and "dellstore"."public"."task1_snapshot".dbt_valid_to is null;

    insert into "dellstore"."public"."task1_snapshot" ("prod_id", "category", "title", "actor", "price", "special", "common_prod_id", "dbt_updated_at", "dbt_valid_from", "dbt_valid_to", "dbt_scd_id")
    select DBT_INTERNAL_SOURCE."prod_id",DBT_INTERNAL_SOURCE."category",DBT_INTERNAL_SOURCE."title",DBT_INTERNAL_SOURCE."actor",DBT_INTERNAL_SOURCE."price",DBT_INTERNAL_SOURCE."special",DBT_INTERNAL_SOURCE."common_prod_id",DBT_INTERNAL_SOURCE."dbt_updated_at",DBT_INTERNAL_SOURCE."dbt_valid_from",DBT_INTERNAL_SOURCE."dbt_valid_to",DBT_INTERNAL_SOURCE."dbt_scd_id"
    from "task1_snapshot__dbt_tmp215613094552" as DBT_INTERNAL_SOURCE
    where DBT_INTERNAL_SOURCE.dbt_change_type::text = 'insert'::text;

  
2021-10-05 21:56:13.231162 (Thread-1): SQL status: INSERT 0 1 in 0.00 seconds
2021-10-05 21:56:13.240440 (Thread-1): On snapshot.my_new_project.task1_snapshot: COMMIT
2021-10-05 21:56:13.241042 (Thread-1): Using postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:56:13.241561 (Thread-1): On snapshot.my_new_project.task1_snapshot: COMMIT
2021-10-05 21:56:13.755273 (Thread-1): SQL status: COMMIT in 0.51 seconds
2021-10-05 21:56:13.761702 (Thread-1): finished collecting timing info
2021-10-05 21:56:13.762478 (Thread-1): On snapshot.my_new_project.task1_snapshot: Close
2021-10-05 21:56:13.763542 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '568f246d-f7c8-4178-a19d-feb197d270e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd8c7df0>]}
2021-10-05 21:56:13.765736 (Thread-1): 21:56:13 | 1 of 1 OK snapshotted public.task1_snapshot.......................... [INSERT 0 1 in 0.83s]
2021-10-05 21:56:13.766456 (Thread-1): Finished running node snapshot.my_new_project.task1_snapshot
2021-10-05 21:56:13.768801 (MainThread): Acquiring new postgres connection "master".
2021-10-05 21:56:13.769477 (MainThread): Using postgres connection "master".
2021-10-05 21:56:13.769905 (MainThread): On master: BEGIN
2021-10-05 21:56:13.770300 (MainThread): Opening a new connection, currently in state closed
2021-10-05 21:56:13.774492 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:56:13.775274 (MainThread): On master: COMMIT
2021-10-05 21:56:13.775747 (MainThread): Using postgres connection "master".
2021-10-05 21:56:13.776142 (MainThread): On master: COMMIT
2021-10-05 21:56:13.776881 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 21:56:13.777741 (MainThread): On master: Close
2021-10-05 21:56:13.778874 (MainThread): 21:56:13 | 
2021-10-05 21:56:13.779714 (MainThread): 21:56:13 | Finished running 1 snapshot in 0.96s.
2021-10-05 21:56:13.780476 (MainThread): Connection 'master' was properly closed.
2021-10-05 21:56:13.780982 (MainThread): Connection 'snapshot.my_new_project.task1_snapshot' was properly closed.
2021-10-05 21:56:13.906805 (MainThread): 
2021-10-05 21:56:13.907558 (MainThread): Completed successfully
2021-10-05 21:56:13.908177 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 21:56:13.908949 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd7b92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd83c970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4cd83c6a0>]}
2021-10-05 21:56:13.910026 (MainThread): Flushing usage events
2021-10-05 21:58:35.645811 (MainThread): Running with dbt=0.19.0
2021-10-05 21:58:35.763416 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-05 21:58:35.769052 (MainThread): Tracking: tracking
2021-10-05 21:58:35.771160 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726858e9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f726a0392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72685a0190>]}
2021-10-05 21:58:35.813011 (MainThread): Partial parsing not enabled
2021-10-05 21:58:35.821153 (MainThread): Parsing macros/luhn_verify.sql
2021-10-05 21:58:35.822130 (MainThread): Parsing macros/adapters.sql
2021-10-05 21:58:35.848909 (MainThread): Parsing macros/catalog.sql
2021-10-05 21:58:35.852227 (MainThread): Parsing macros/relations.sql
2021-10-05 21:58:35.854326 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-05 21:58:35.857941 (MainThread): Parsing macros/core.sql
2021-10-05 21:58:35.863540 (MainThread): Parsing macros/adapters/common.sql
2021-10-05 21:58:35.915384 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-05 21:58:35.918141 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-05 21:58:35.920495 (MainThread): Parsing macros/etc/datetime.sql
2021-10-05 21:58:35.931918 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-05 21:58:35.934292 (MainThread): Parsing macros/etc/query.sql
2021-10-05 21:58:35.936016 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-05 21:58:35.937504 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-05 21:58:35.949543 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-05 21:58:35.976046 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-05 21:58:35.978563 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-05 21:58:36.014837 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-05 21:58:36.037235 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-05 21:58:36.045878 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-05 21:58:36.048816 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-05 21:58:36.065775 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-05 21:58:36.072157 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-05 21:58:36.080413 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-05 21:58:36.089011 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-05 21:58:36.091414 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-05 21:58:36.093689 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-05 21:58:36.096777 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-05 21:58:36.113475 (MainThread): Partial parsing not enabled
2021-10-05 21:58:36.164332 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-05 21:58:36.198567 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:58:36.239008 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-05 21:58:36.474051 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-05 21:58:36.482551 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '740deb13-e415-4da4-b9ad-e729f9d7f9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72684a7880>]}
2021-10-05 21:58:36.538507 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-05 21:58:36.540495 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-05 21:58:36.542722 (MainThread): 
2021-10-05 21:58:36.543674 (MainThread): Acquiring new postgres connection "master".
2021-10-05 21:58:36.546339 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-05 21:58:36.561785 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-05 21:58:36.562365 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-05 21:58:36.562841 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-05 21:58:36.568843 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-05 21:58:36.572280 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-05 21:58:36.578698 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-05 21:58:36.587497 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 21:58:36.588167 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-05 21:58:36.588750 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-05 21:58:36.592598 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:58:36.593371 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-05 21:58:36.593901 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-05 21:58:36.596578 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-05 21:58:36.608745 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-05 21:58:36.609498 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-05 21:58:36.621679 (MainThread): Using postgres connection "master".
2021-10-05 21:58:36.622303 (MainThread): On master: BEGIN
2021-10-05 21:58:36.622761 (MainThread): Opening a new connection, currently in state init
2021-10-05 21:58:36.626612 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:58:36.627228 (MainThread): Using postgres connection "master".
2021-10-05 21:58:36.627798 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-05 21:58:36.633924 (MainThread): SQL status: SELECT 2 in 0.01 seconds
2021-10-05 21:58:36.638203 (MainThread): On master: ROLLBACK
2021-10-05 21:58:36.638938 (MainThread): Using postgres connection "master".
2021-10-05 21:58:36.639386 (MainThread): On master: BEGIN
2021-10-05 21:58:36.640328 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:58:36.640814 (MainThread): On master: COMMIT
2021-10-05 21:58:36.641178 (MainThread): Using postgres connection "master".
2021-10-05 21:58:36.641631 (MainThread): On master: COMMIT
2021-10-05 21:58:36.642321 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 21:58:36.642779 (MainThread): On master: Close
2021-10-05 21:58:36.643876 (MainThread): 21:58:36 | Concurrency: 2 threads (target='dev')
2021-10-05 21:58:36.644443 (MainThread): 21:58:36 | 
2021-10-05 21:58:36.647845 (Thread-1): Began running node model.my_new_project.task2
2021-10-05 21:58:36.649798 (Thread-1): 21:58:36 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-05 21:58:36.650717 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-05 21:58:36.651224 (Thread-1): Compiling model.my_new_project.task2
2021-10-05 21:58:36.672474 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-05 21:58:36.686249 (Thread-1): finished collecting timing info
2021-10-05 21:58:36.715742 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:36.716594 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-05 21:58:36.717510 (Thread-1): Opening a new connection, currently in state closed
2021-10-05 21:58:36.722015 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-05 21:58:36.725243 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:36.725799 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 21:58:36.726577 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-05 21:58:36.739522 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-05 21:58:36.749889 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:36.750378 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-05 21:58:36.751353 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:58:36.751746 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:36.752203 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS OrderDate,
	SUM(netamount) AS Amount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as full_data 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-05 21:58:37.281204 (Thread-1): SQL status: SELECT 365 in 0.53 seconds
2021-10-05 21:58:37.291459 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:37.291975 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-05 21:58:37.293034 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 21:58:37.296590 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:37.297169 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-05 21:58:37.298030 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-05 21:58:37.307518 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 21:58:37.308166 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:37.308628 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-05 21:58:37.395416 (Thread-1): SQL status: COMMIT in 0.09 seconds
2021-10-05 21:58:37.400768 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-05 21:58:37.401441 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop view if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-05 21:58:37.432007 (Thread-1): SQL status: DROP VIEW in 0.03 seconds
2021-10-05 21:58:37.435637 (Thread-1): finished collecting timing info
2021-10-05 21:58:37.436326 (Thread-1): On model.my_new_project.task2: Close
2021-10-05 21:58:37.437426 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '740deb13-e415-4da4-b9ad-e729f9d7f9a1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7265a7f9a0>]}
2021-10-05 21:58:37.439544 (Thread-1): 21:58:37 | 1 of 1 OK created table model public.task2........................... [SELECT 365 in 0.79s]
2021-10-05 21:58:37.440499 (Thread-1): Finished running node model.my_new_project.task2
2021-10-05 21:58:37.442778 (MainThread): Acquiring new postgres connection "master".
2021-10-05 21:58:37.443473 (MainThread): Using postgres connection "master".
2021-10-05 21:58:37.443911 (MainThread): On master: BEGIN
2021-10-05 21:58:37.444265 (MainThread): Opening a new connection, currently in state closed
2021-10-05 21:58:37.448933 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-05 21:58:37.449586 (MainThread): On master: COMMIT
2021-10-05 21:58:37.449994 (MainThread): Using postgres connection "master".
2021-10-05 21:58:37.450302 (MainThread): On master: COMMIT
2021-10-05 21:58:37.450958 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-05 21:58:37.451536 (MainThread): On master: Close
2021-10-05 21:58:37.453255 (MainThread): 21:58:37 | 
2021-10-05 21:58:37.453888 (MainThread): 21:58:37 | Finished running 1 table model in 0.91s.
2021-10-05 21:58:37.454578 (MainThread): Connection 'master' was properly closed.
2021-10-05 21:58:37.458090 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-05 21:58:37.513406 (MainThread): 
2021-10-05 21:58:37.513879 (MainThread): Completed successfully
2021-10-05 21:58:37.514618 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-05 21:58:37.515739 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7268332dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f72683565e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7268356670>]}
2021-10-05 21:58:37.519067 (MainThread): Flushing usage events
2021-10-06 05:57:21.563872 (MainThread): Running with dbt=0.19.0
2021-10-06 05:57:21.710135 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 05:57:21.751066 (MainThread): Tracking: tracking
2021-10-06 05:57:21.753715 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69f679fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd6a2c7e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69f6890a0>]}
2021-10-06 05:57:21.789986 (MainThread): Partial parsing not enabled
2021-10-06 05:57:21.801811 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 05:57:21.803069 (MainThread): Parsing macros/adapters.sql
2021-10-06 05:57:21.829538 (MainThread): Parsing macros/catalog.sql
2021-10-06 05:57:21.832615 (MainThread): Parsing macros/relations.sql
2021-10-06 05:57:21.834784 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 05:57:21.840205 (MainThread): Parsing macros/core.sql
2021-10-06 05:57:21.845515 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 05:57:21.894594 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 05:57:21.897514 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 05:57:21.899835 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 05:57:21.910294 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 05:57:21.912566 (MainThread): Parsing macros/etc/query.sql
2021-10-06 05:57:21.914343 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 05:57:21.916089 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 05:57:21.926417 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 05:57:21.950616 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 05:57:21.953497 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 05:57:21.987244 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 05:57:22.008776 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 05:57:22.016550 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 05:57:22.019090 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 05:57:22.035036 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 05:57:22.041161 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 05:57:22.048708 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 05:57:22.057089 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 05:57:22.059654 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 05:57:22.061829 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 05:57:22.064443 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 05:57:22.079957 (MainThread): Partial parsing not enabled
2021-10-06 05:57:22.133563 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 05:57:22.164196 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:57:22.213712 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 05:57:22.466214 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 05:57:22.473639 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3f56b2c4-2656-4f9f-9c2b-69c84870c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69f593ca0>]}
2021-10-06 05:57:22.532862 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 05:57:22.535125 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 05:57:22.536740 (MainThread): 
2021-10-06 05:57:22.537520 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:57:22.540383 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 05:57:22.556499 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 05:57:22.557468 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 05:57:22.558140 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 05:57:22.570899 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 05:57:22.575308 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 05:57:22.581505 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 05:57:22.590600 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:57:22.591090 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 05:57:22.591475 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 05:57:22.595605 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:22.596109 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:57:22.596525 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 05:57:22.600002 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 05:57:22.613373 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 05:57:22.614200 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 05:57:22.624236 (MainThread): Using postgres connection "master".
2021-10-06 05:57:22.624782 (MainThread): On master: BEGIN
2021-10-06 05:57:22.625213 (MainThread): Opening a new connection, currently in state init
2021-10-06 05:57:22.629051 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:22.629562 (MainThread): Using postgres connection "master".
2021-10-06 05:57:22.630061 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 05:57:22.640256 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 05:57:22.641081 (MainThread): On master: ROLLBACK
2021-10-06 05:57:22.641799 (MainThread): Using postgres connection "master".
2021-10-06 05:57:22.642255 (MainThread): On master: BEGIN
2021-10-06 05:57:22.643238 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:22.643717 (MainThread): On master: COMMIT
2021-10-06 05:57:22.644133 (MainThread): Using postgres connection "master".
2021-10-06 05:57:22.644538 (MainThread): On master: COMMIT
2021-10-06 05:57:22.645278 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:57:22.645712 (MainThread): On master: Close
2021-10-06 05:57:22.646413 (MainThread): 05:57:22 | Concurrency: 2 threads (target='dev')
2021-10-06 05:57:22.646936 (MainThread): 05:57:22 | 
2021-10-06 05:57:22.651074 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 05:57:22.653099 (Thread-1): 05:57:22 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 05:57:22.654082 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:57:22.654595 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 05:57:22.676098 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 05:57:22.686219 (Thread-1): finished collecting timing info
2021-10-06 05:57:22.715295 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:22.715890 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 05:57:22.716361 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 05:57:22.722596 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-06 05:57:22.725675 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:22.726103 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 05:57:22.726842 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:57:22.739850 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 05:57:22.749859 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:22.751217 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 05:57:22.753058 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:22.753818 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:22.754223 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 05:57:22.755449 (Thread-1): Postgres error: syntax error at or near "("
LINE 10:  SUM(netamount) AS netamount
             ^

2021-10-06 05:57:22.756165 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 05:57:22.757116 (Thread-1): finished collecting timing info
2021-10-06 05:57:22.757801 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 05:57:22.758602 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM(netamount) AS netamount
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "("
LINE 10:  SUM(netamount) AS netamount
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM(netamount) AS netamount
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:57:22.763749 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3f56b2c4-2656-4f9f-9c2b-69c84870c307', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69f432370>]}
2021-10-06 05:57:22.765740 (Thread-1): 05:57:22 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-06 05:57:22.766441 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 05:57:22.768845 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:57:22.769465 (MainThread): Using postgres connection "master".
2021-10-06 05:57:22.769872 (MainThread): On master: BEGIN
2021-10-06 05:57:22.772345 (MainThread): Opening a new connection, currently in state closed
2021-10-06 05:57:22.777812 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 05:57:22.778524 (MainThread): On master: COMMIT
2021-10-06 05:57:22.779138 (MainThread): Using postgres connection "master".
2021-10-06 05:57:22.779853 (MainThread): On master: COMMIT
2021-10-06 05:57:22.780746 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:57:22.781314 (MainThread): On master: Close
2021-10-06 05:57:22.782193 (MainThread): 05:57:22 | 
2021-10-06 05:57:22.782833 (MainThread): 05:57:22 | Finished running 1 table model in 0.24s.
2021-10-06 05:57:22.783310 (MainThread): Connection 'master' was properly closed.
2021-10-06 05:57:22.784251 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 05:57:22.843540 (MainThread): 
2021-10-06 05:57:22.844191 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 05:57:22.845933 (MainThread): 
2021-10-06 05:57:22.847606 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 05:57:22.849240 (MainThread):   syntax error at or near "("
2021-10-06 05:57:22.850899 (MainThread):   LINE 10:  SUM(netamount) AS netamount
2021-10-06 05:57:22.852617 (MainThread):                ^
2021-10-06 05:57:22.855436 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:57:22.856493 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 05:57:22.857883 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69f41cdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69ebc3c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd69ebb8430>]}
2021-10-06 05:57:22.859097 (MainThread): Flushing usage events
2021-10-06 05:57:57.882648 (MainThread): Running with dbt=0.19.0
2021-10-06 05:57:57.986907 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 05:57:57.990987 (MainThread): Tracking: tracking
2021-10-06 05:57:57.992994 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330cce5910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33102ed430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330ccf7100>]}
2021-10-06 05:57:58.032720 (MainThread): Partial parsing not enabled
2021-10-06 05:57:58.039280 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 05:57:58.040234 (MainThread): Parsing macros/adapters.sql
2021-10-06 05:57:58.065042 (MainThread): Parsing macros/catalog.sql
2021-10-06 05:57:58.068033 (MainThread): Parsing macros/relations.sql
2021-10-06 05:57:58.069995 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 05:57:58.073137 (MainThread): Parsing macros/core.sql
2021-10-06 05:57:58.078401 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 05:57:58.126015 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 05:57:58.129108 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 05:57:58.131436 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 05:57:58.141918 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 05:57:58.144227 (MainThread): Parsing macros/etc/query.sql
2021-10-06 05:57:58.145901 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 05:57:58.147438 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 05:57:58.157669 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 05:57:58.181255 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 05:57:58.185943 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 05:57:58.223016 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 05:57:58.247110 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 05:57:58.259729 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 05:57:58.262608 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 05:57:58.282200 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 05:57:58.289649 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 05:57:58.297759 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 05:57:58.306078 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 05:57:58.308383 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 05:57:58.310398 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 05:57:58.312857 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 05:57:58.326535 (MainThread): Partial parsing not enabled
2021-10-06 05:57:58.373194 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 05:57:58.424622 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:57:58.454015 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 05:57:58.664822 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 05:57:58.671315 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '070e1faf-5d49-4cc9-8ec7-40c1e5cf001c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330cc023a0>]}
2021-10-06 05:57:58.729209 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 05:57:58.730782 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 05:57:58.732404 (MainThread): 
2021-10-06 05:57:58.733219 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:57:58.736124 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 05:57:58.749888 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 05:57:58.751073 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 05:57:58.751515 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 05:57:58.759847 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 05:57:58.762995 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 05:57:58.769619 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 05:57:58.778346 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:57:58.778945 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 05:57:58.779412 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 05:57:58.783794 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:58.784465 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:57:58.785093 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 05:57:58.788499 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 05:57:58.798967 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 05:57:58.799684 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 05:57:58.810798 (MainThread): Using postgres connection "master".
2021-10-06 05:57:58.811347 (MainThread): On master: BEGIN
2021-10-06 05:57:58.811774 (MainThread): Opening a new connection, currently in state init
2021-10-06 05:57:58.816107 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:58.816790 (MainThread): Using postgres connection "master".
2021-10-06 05:57:58.817231 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 05:57:58.822510 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 05:57:58.823275 (MainThread): On master: ROLLBACK
2021-10-06 05:57:58.823943 (MainThread): Using postgres connection "master".
2021-10-06 05:57:58.824343 (MainThread): On master: BEGIN
2021-10-06 05:57:58.825276 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:58.825739 (MainThread): On master: COMMIT
2021-10-06 05:57:58.826144 (MainThread): Using postgres connection "master".
2021-10-06 05:57:58.826563 (MainThread): On master: COMMIT
2021-10-06 05:57:58.827250 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:57:58.827658 (MainThread): On master: Close
2021-10-06 05:57:58.828366 (MainThread): 05:57:58 | Concurrency: 2 threads (target='dev')
2021-10-06 05:57:58.828990 (MainThread): 05:57:58 | 
2021-10-06 05:57:58.833937 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 05:57:58.835906 (Thread-1): 05:57:58 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 05:57:58.836837 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:57:58.837446 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 05:57:58.860497 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 05:57:58.871628 (Thread-1): finished collecting timing info
2021-10-06 05:57:58.900306 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:58.900993 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 05:57:58.902007 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 05:57:58.906414 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:57:58.909595 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:58.910103 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 05:57:58.910786 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:57:58.923449 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 05:57:58.934388 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:58.934806 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 05:57:58.935540 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:58.935944 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:57:58.936336 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate
	SUM (netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 05:57:58.937075 (Thread-1): Postgres error: syntax error at or near "("
LINE 10:  SUM (netamount) AS netamount
              ^

2021-10-06 05:57:58.937544 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 05:57:58.938206 (Thread-1): finished collecting timing info
2021-10-06 05:57:58.938834 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 05:57:58.939680 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM (netamount) AS netamount
                ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "("
LINE 10:  SUM (netamount) AS netamount
              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM (netamount) AS netamount
                ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:57:58.941951 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '070e1faf-5d49-4cc9-8ec7-40c1e5cf001c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330caaf190>]}
2021-10-06 05:57:58.943523 (Thread-1): 05:57:58 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-06 05:57:58.944059 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 05:57:58.947021 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:57:58.947620 (MainThread): Using postgres connection "master".
2021-10-06 05:57:58.948092 (MainThread): On master: BEGIN
2021-10-06 05:57:58.948586 (MainThread): Opening a new connection, currently in state closed
2021-10-06 05:57:58.953222 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:57:58.953859 (MainThread): On master: COMMIT
2021-10-06 05:57:58.954425 (MainThread): Using postgres connection "master".
2021-10-06 05:57:58.955007 (MainThread): On master: COMMIT
2021-10-06 05:57:58.955856 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:57:58.956642 (MainThread): On master: Close
2021-10-06 05:57:58.957561 (MainThread): 05:57:58 | 
2021-10-06 05:57:58.958338 (MainThread): 05:57:58 | Finished running 1 table model in 0.22s.
2021-10-06 05:57:58.959245 (MainThread): Connection 'master' was properly closed.
2021-10-06 05:57:58.959754 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 05:57:59.016283 (MainThread): 
2021-10-06 05:57:59.016889 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 05:57:59.018183 (MainThread): 
2021-10-06 05:57:59.019149 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 05:57:59.020391 (MainThread):   syntax error at or near "("
2021-10-06 05:57:59.021330 (MainThread):   LINE 10:  SUM (netamount) AS netamount
2021-10-06 05:57:59.022648 (MainThread):                 ^
2021-10-06 05:57:59.023414 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:57:59.024252 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 05:57:59.025302 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330c22ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330caa3c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f330c231880>]}
2021-10-06 05:57:59.026007 (MainThread): Flushing usage events
2021-10-06 05:58:13.127317 (MainThread): Running with dbt=0.19.0
2021-10-06 05:58:13.245899 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 05:58:13.249062 (MainThread): Tracking: tracking
2021-10-06 05:58:13.251112 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4363c0e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4367216460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4363c1f130>]}
2021-10-06 05:58:13.291586 (MainThread): Partial parsing not enabled
2021-10-06 05:58:13.296383 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 05:58:13.297256 (MainThread): Parsing macros/adapters.sql
2021-10-06 05:58:13.325790 (MainThread): Parsing macros/catalog.sql
2021-10-06 05:58:13.329018 (MainThread): Parsing macros/relations.sql
2021-10-06 05:58:13.330966 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 05:58:13.334349 (MainThread): Parsing macros/core.sql
2021-10-06 05:58:13.339553 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 05:58:13.391476 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 05:58:13.394228 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 05:58:13.396537 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 05:58:13.407580 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 05:58:13.409711 (MainThread): Parsing macros/etc/query.sql
2021-10-06 05:58:13.411152 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 05:58:13.412459 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 05:58:13.422483 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 05:58:13.450379 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 05:58:13.453247 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 05:58:13.496748 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 05:58:13.522063 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 05:58:13.531085 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 05:58:13.534570 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 05:58:13.553890 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 05:58:13.560653 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 05:58:13.569297 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 05:58:13.578660 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 05:58:13.581713 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 05:58:13.583937 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 05:58:13.586634 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 05:58:13.600349 (MainThread): Partial parsing not enabled
2021-10-06 05:58:13.649712 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 05:58:13.681793 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:58:13.711889 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 05:58:13.946630 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 05:58:13.951696 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d167f6b-64b8-4d78-a73f-3158cc4b06c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4363b2bdf0>]}
2021-10-06 05:58:14.013787 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 05:58:14.015177 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 05:58:14.016444 (MainThread): 
2021-10-06 05:58:14.017165 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:58:14.019953 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 05:58:14.035577 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 05:58:14.036051 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 05:58:14.036383 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 05:58:14.042229 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 05:58:14.045301 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 05:58:14.051405 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 05:58:14.059833 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:58:14.060257 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 05:58:14.060509 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 05:58:14.064151 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:14.064559 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:58:14.064907 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 05:58:14.067572 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 05:58:14.079293 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 05:58:14.079945 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 05:58:14.090716 (MainThread): Using postgres connection "master".
2021-10-06 05:58:14.091114 (MainThread): On master: BEGIN
2021-10-06 05:58:14.091356 (MainThread): Opening a new connection, currently in state init
2021-10-06 05:58:14.094980 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:14.095486 (MainThread): Using postgres connection "master".
2021-10-06 05:58:14.095779 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 05:58:14.101243 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 05:58:14.102008 (MainThread): On master: ROLLBACK
2021-10-06 05:58:14.102547 (MainThread): Using postgres connection "master".
2021-10-06 05:58:14.102805 (MainThread): On master: BEGIN
2021-10-06 05:58:14.103581 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:14.103929 (MainThread): On master: COMMIT
2021-10-06 05:58:14.104229 (MainThread): Using postgres connection "master".
2021-10-06 05:58:14.104525 (MainThread): On master: COMMIT
2021-10-06 05:58:14.105129 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:58:14.105470 (MainThread): On master: Close
2021-10-06 05:58:14.106047 (MainThread): 05:58:14 | Concurrency: 2 threads (target='dev')
2021-10-06 05:58:14.106476 (MainThread): 05:58:14 | 
2021-10-06 05:58:14.110330 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 05:58:14.112186 (Thread-1): 05:58:14 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 05:58:14.112926 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:58:14.113488 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 05:58:14.136844 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 05:58:14.144431 (Thread-1): finished collecting timing info
2021-10-06 05:58:14.175038 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:14.175570 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 05:58:14.175928 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 05:58:14.179619 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:58:14.182954 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:14.183385 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 05:58:14.184587 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:58:14.199542 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 05:58:14.208063 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:14.208461 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 05:58:14.209089 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:14.209482 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:14.209778 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 05:58:14.210467 (Thread-1): Postgres error: syntax error at or near "("
LINE 10:  SUM(netamount) AS netamount
             ^

2021-10-06 05:58:14.210819 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 05:58:14.211470 (Thread-1): finished collecting timing info
2021-10-06 05:58:14.212045 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 05:58:14.212714 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM(netamount) AS netamount
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "("
LINE 10:  SUM(netamount) AS netamount
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM(netamount) AS netamount
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:58:14.214863 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d167f6b-64b8-4d78-a73f-3158cc4b06c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43639d5040>]}
2021-10-06 05:58:14.216490 (Thread-1): 05:58:14 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.10s]
2021-10-06 05:58:14.216961 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 05:58:14.219591 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:58:14.220179 (MainThread): Using postgres connection "master".
2021-10-06 05:58:14.220558 (MainThread): On master: BEGIN
2021-10-06 05:58:14.221033 (MainThread): Opening a new connection, currently in state closed
2021-10-06 05:58:14.225378 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:14.225977 (MainThread): On master: COMMIT
2021-10-06 05:58:14.226392 (MainThread): Using postgres connection "master".
2021-10-06 05:58:14.226770 (MainThread): On master: COMMIT
2021-10-06 05:58:14.227395 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:58:14.227812 (MainThread): On master: Close
2021-10-06 05:58:14.228549 (MainThread): 05:58:14 | 
2021-10-06 05:58:14.229091 (MainThread): 05:58:14 | Finished running 1 table model in 0.21s.
2021-10-06 05:58:14.229721 (MainThread): Connection 'master' was properly closed.
2021-10-06 05:58:14.230676 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 05:58:14.294388 (MainThread): 
2021-10-06 05:58:14.295468 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 05:58:14.296912 (MainThread): 
2021-10-06 05:58:14.299073 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 05:58:14.299628 (MainThread):   syntax error at or near "("
2021-10-06 05:58:14.301605 (MainThread):   LINE 10:  SUM(netamount) AS netamount
2021-10-06 05:58:14.302438 (MainThread):                ^
2021-10-06 05:58:14.303774 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:58:14.306521 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 05:58:14.308136 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f436316fcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4363b4e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4363158a30>]}
2021-10-06 05:58:14.308878 (MainThread): Flushing usage events
2021-10-06 05:58:30.659529 (MainThread): Running with dbt=0.19.0
2021-10-06 05:58:30.777778 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 05:58:30.783388 (MainThread): Tracking: tracking
2021-10-06 05:58:30.785581 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf70ad7910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf740de430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf70ae9100>]}
2021-10-06 05:58:30.827159 (MainThread): Partial parsing not enabled
2021-10-06 05:58:30.835414 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 05:58:30.836380 (MainThread): Parsing macros/adapters.sql
2021-10-06 05:58:30.862049 (MainThread): Parsing macros/catalog.sql
2021-10-06 05:58:30.865733 (MainThread): Parsing macros/relations.sql
2021-10-06 05:58:30.867786 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 05:58:30.871362 (MainThread): Parsing macros/core.sql
2021-10-06 05:58:30.876701 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 05:58:30.927740 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 05:58:30.930503 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 05:58:30.932796 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 05:58:30.943816 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 05:58:30.946069 (MainThread): Parsing macros/etc/query.sql
2021-10-06 05:58:30.947784 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 05:58:30.949550 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 05:58:30.960324 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 05:58:30.986475 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 05:58:30.988962 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 05:58:31.023725 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 05:58:31.045376 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 05:58:31.053492 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 05:58:31.056385 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 05:58:31.072415 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 05:58:31.079449 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 05:58:31.087805 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 05:58:31.096528 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 05:58:31.098993 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 05:58:31.101093 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 05:58:31.103826 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 05:58:31.120397 (MainThread): Partial parsing not enabled
2021-10-06 05:58:31.171665 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 05:58:31.209339 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:58:31.244879 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 05:58:31.489684 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 05:58:31.496595 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954f4fdc-4a72-44aa-97b7-e752df54f244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf709f1880>]}
2021-10-06 05:58:31.553307 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 05:58:31.555033 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 05:58:31.556747 (MainThread): 
2021-10-06 05:58:31.557704 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:58:31.560183 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 05:58:31.575769 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 05:58:31.576438 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 05:58:31.576996 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 05:58:31.582044 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 05:58:31.586185 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 05:58:31.592804 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 05:58:31.600832 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:58:31.601695 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 05:58:31.602351 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 05:58:31.607341 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:31.607982 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:58:31.608387 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 05:58:31.610763 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 05:58:31.624028 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 05:58:31.624992 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 05:58:31.635354 (MainThread): Using postgres connection "master".
2021-10-06 05:58:31.636029 (MainThread): On master: BEGIN
2021-10-06 05:58:31.636548 (MainThread): Opening a new connection, currently in state init
2021-10-06 05:58:31.640837 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:31.641435 (MainThread): Using postgres connection "master".
2021-10-06 05:58:31.641902 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 05:58:31.647589 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 05:58:31.648392 (MainThread): On master: ROLLBACK
2021-10-06 05:58:31.649093 (MainThread): Using postgres connection "master".
2021-10-06 05:58:31.649547 (MainThread): On master: BEGIN
2021-10-06 05:58:31.650615 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:31.651162 (MainThread): On master: COMMIT
2021-10-06 05:58:31.651631 (MainThread): Using postgres connection "master".
2021-10-06 05:58:31.652113 (MainThread): On master: COMMIT
2021-10-06 05:58:31.652835 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:58:31.653377 (MainThread): On master: Close
2021-10-06 05:58:31.654186 (MainThread): 05:58:31 | Concurrency: 2 threads (target='dev')
2021-10-06 05:58:31.654890 (MainThread): 05:58:31 | 
2021-10-06 05:58:31.659171 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 05:58:31.661383 (Thread-1): 05:58:31 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 05:58:31.662297 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:58:31.662914 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 05:58:31.684568 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 05:58:31.696647 (Thread-1): finished collecting timing info
2021-10-06 05:58:31.727729 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:31.728324 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 05:58:31.728738 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 05:58:31.732600 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:58:31.736188 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:31.736765 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 05:58:31.737781 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:58:31.749984 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 05:58:31.760688 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:31.761184 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 05:58:31.761935 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:31.762442 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:58:31.762887 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate
	SUM(netamount)
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 05:58:31.763736 (Thread-1): Postgres error: syntax error at or near "("
LINE 10:  SUM(netamount)
             ^

2021-10-06 05:58:31.764340 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 05:58:31.765212 (Thread-1): finished collecting timing info
2021-10-06 05:58:31.765930 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 05:58:31.766759 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM(netamount)
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "("
LINE 10:  SUM(netamount)
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "("
  LINE 10:  SUM(netamount)
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:58:31.769120 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '954f4fdc-4a72-44aa-97b7-e752df54f244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf708943d0>]}
2021-10-06 05:58:31.770731 (Thread-1): 05:58:31 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-06 05:58:31.771313 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 05:58:31.774828 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:58:31.775451 (MainThread): Using postgres connection "master".
2021-10-06 05:58:31.775963 (MainThread): On master: BEGIN
2021-10-06 05:58:31.776403 (MainThread): Opening a new connection, currently in state closed
2021-10-06 05:58:31.780989 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:58:31.781506 (MainThread): On master: COMMIT
2021-10-06 05:58:31.781903 (MainThread): Using postgres connection "master".
2021-10-06 05:58:31.782282 (MainThread): On master: COMMIT
2021-10-06 05:58:31.782874 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:58:31.783276 (MainThread): On master: Close
2021-10-06 05:58:31.784092 (MainThread): 05:58:31 | 
2021-10-06 05:58:31.784819 (MainThread): 05:58:31 | Finished running 1 table model in 0.23s.
2021-10-06 05:58:31.785573 (MainThread): Connection 'master' was properly closed.
2021-10-06 05:58:31.786287 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 05:58:31.841204 (MainThread): 
2021-10-06 05:58:31.842421 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 05:58:31.843561 (MainThread): 
2021-10-06 05:58:31.844341 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 05:58:31.845295 (MainThread):   syntax error at or near "("
2021-10-06 05:58:31.846485 (MainThread):   LINE 10:  SUM(netamount)
2021-10-06 05:58:31.848479 (MainThread):                ^
2021-10-06 05:58:31.849213 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:58:31.849968 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 05:58:31.851449 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf70978340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf708b22b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6bfe3fd0>]}
2021-10-06 05:58:31.852662 (MainThread): Flushing usage events
2021-10-06 05:59:26.179014 (MainThread): Running with dbt=0.19.0
2021-10-06 05:59:26.309586 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 05:59:26.315008 (MainThread): Tracking: tracking
2021-10-06 05:59:26.317368 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667e7b79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6680262310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667e7c81c0>]}
2021-10-06 05:59:26.357821 (MainThread): Partial parsing not enabled
2021-10-06 05:59:26.364061 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 05:59:26.364966 (MainThread): Parsing macros/adapters.sql
2021-10-06 05:59:26.391483 (MainThread): Parsing macros/catalog.sql
2021-10-06 05:59:26.394822 (MainThread): Parsing macros/relations.sql
2021-10-06 05:59:26.396950 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 05:59:26.400389 (MainThread): Parsing macros/core.sql
2021-10-06 05:59:26.405660 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 05:59:26.454251 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 05:59:26.457030 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 05:59:26.459250 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 05:59:26.469815 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 05:59:26.471996 (MainThread): Parsing macros/etc/query.sql
2021-10-06 05:59:26.473583 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 05:59:26.475087 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 05:59:26.485222 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 05:59:26.508750 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 05:59:26.511144 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 05:59:26.545320 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 05:59:26.566017 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 05:59:26.573320 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 05:59:26.575860 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 05:59:26.592864 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 05:59:26.598921 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 05:59:26.606560 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 05:59:26.614229 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 05:59:26.616596 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 05:59:26.618684 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 05:59:26.621329 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 05:59:26.636418 (MainThread): Partial parsing not enabled
2021-10-06 05:59:26.685912 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 05:59:26.719458 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:59:26.749146 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 05:59:26.967198 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 05:59:26.973412 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '660572ad-65a8-4381-8315-191909ae1f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667e6a4c40>]}
2021-10-06 05:59:27.035872 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 05:59:27.037686 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 05:59:27.040392 (MainThread): 
2021-10-06 05:59:27.041413 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:59:27.044100 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 05:59:27.060663 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 05:59:27.061279 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 05:59:27.061806 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 05:59:27.066709 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-06 05:59:27.070305 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 05:59:27.077542 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 05:59:27.085795 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:59:27.086715 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 05:59:27.087578 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 05:59:27.092333 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:27.092967 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:59:27.093428 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 05:59:27.096026 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 05:59:27.108871 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 05:59:27.109795 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 05:59:27.119657 (MainThread): Using postgres connection "master".
2021-10-06 05:59:27.120259 (MainThread): On master: BEGIN
2021-10-06 05:59:27.120774 (MainThread): Opening a new connection, currently in state init
2021-10-06 05:59:27.125059 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:27.125670 (MainThread): Using postgres connection "master".
2021-10-06 05:59:27.126172 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 05:59:27.131188 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 05:59:27.131955 (MainThread): On master: ROLLBACK
2021-10-06 05:59:27.132779 (MainThread): Using postgres connection "master".
2021-10-06 05:59:27.133249 (MainThread): On master: BEGIN
2021-10-06 05:59:27.134438 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:27.134894 (MainThread): On master: COMMIT
2021-10-06 05:59:27.135389 (MainThread): Using postgres connection "master".
2021-10-06 05:59:27.135852 (MainThread): On master: COMMIT
2021-10-06 05:59:27.136614 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:59:27.137065 (MainThread): On master: Close
2021-10-06 05:59:27.137835 (MainThread): 05:59:27 | Concurrency: 2 threads (target='dev')
2021-10-06 05:59:27.138457 (MainThread): 05:59:27 | 
2021-10-06 05:59:27.143670 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 05:59:27.145600 (Thread-1): 05:59:27 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 05:59:27.146554 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:59:27.147086 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 05:59:27.166621 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 05:59:27.178123 (Thread-1): finished collecting timing info
2021-10-06 05:59:27.209304 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:27.209998 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 05:59:27.210512 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 05:59:27.215127 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:59:27.218717 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:27.219252 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 05:59:27.220141 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:59:27.234303 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 05:59:27.245480 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:27.245880 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 05:59:27.246976 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:27.247564 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:27.248103 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	ord.orderdate AS orderdate
	SUM(ord.netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 05:59:27.248933 (Thread-1): Postgres error: syntax error at or near "SUM"
LINE 10:  SUM(ord.netamount) AS netamount
          ^

2021-10-06 05:59:27.249445 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 05:59:27.250482 (Thread-1): finished collecting timing info
2021-10-06 05:59:27.251360 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 05:59:27.252431 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SUM"
  LINE 10:  SUM(ord.netamount) AS netamount
            ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SUM"
LINE 10:  SUM(ord.netamount) AS netamount
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SUM"
  LINE 10:  SUM(ord.netamount) AS netamount
            ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:59:27.254647 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '660572ad-65a8-4381-8315-191909ae1f5e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667e5e18e0>]}
2021-10-06 05:59:27.256679 (Thread-1): 05:59:27 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-06 05:59:27.257450 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 05:59:27.259872 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:59:27.260550 (MainThread): Using postgres connection "master".
2021-10-06 05:59:27.260921 (MainThread): On master: BEGIN
2021-10-06 05:59:27.261340 (MainThread): Opening a new connection, currently in state closed
2021-10-06 05:59:27.265690 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:27.266217 (MainThread): On master: COMMIT
2021-10-06 05:59:27.266660 (MainThread): Using postgres connection "master".
2021-10-06 05:59:27.267224 (MainThread): On master: COMMIT
2021-10-06 05:59:27.268035 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:59:27.268832 (MainThread): On master: Close
2021-10-06 05:59:27.270068 (MainThread): 05:59:27 | 
2021-10-06 05:59:27.270772 (MainThread): 05:59:27 | Finished running 1 table model in 0.23s.
2021-10-06 05:59:27.271549 (MainThread): Connection 'master' was properly closed.
2021-10-06 05:59:27.272191 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 05:59:27.326434 (MainThread): 
2021-10-06 05:59:27.326930 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 05:59:27.327926 (MainThread): 
2021-10-06 05:59:27.328701 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 05:59:27.330057 (MainThread):   syntax error at or near "SUM"
2021-10-06 05:59:27.331201 (MainThread):   LINE 10:  SUM(ord.netamount) AS netamount
2021-10-06 05:59:27.332239 (MainThread):             ^
2021-10-06 05:59:27.334951 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:59:27.336187 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 05:59:27.337932 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667e6599d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667e655a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f667dcfcc40>]}
2021-10-06 05:59:27.339399 (MainThread): Flushing usage events
2021-10-06 05:59:43.447621 (MainThread): Running with dbt=0.19.0
2021-10-06 05:59:43.563884 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 05:59:43.567815 (MainThread): Tracking: tracking
2021-10-06 05:59:43.569928 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54aaccd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd549024fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd549035130>]}
2021-10-06 05:59:43.609610 (MainThread): Partial parsing not enabled
2021-10-06 05:59:43.616176 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 05:59:43.617153 (MainThread): Parsing macros/adapters.sql
2021-10-06 05:59:43.642328 (MainThread): Parsing macros/catalog.sql
2021-10-06 05:59:43.645580 (MainThread): Parsing macros/relations.sql
2021-10-06 05:59:43.647562 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 05:59:43.650743 (MainThread): Parsing macros/core.sql
2021-10-06 05:59:43.655687 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 05:59:43.705938 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 05:59:43.708864 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 05:59:43.711289 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 05:59:43.721769 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 05:59:43.724141 (MainThread): Parsing macros/etc/query.sql
2021-10-06 05:59:43.725767 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 05:59:43.727384 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 05:59:43.737820 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 05:59:43.761548 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 05:59:43.764052 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 05:59:43.798049 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 05:59:43.818786 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 05:59:43.826244 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 05:59:43.828734 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 05:59:43.844528 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 05:59:43.850658 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 05:59:43.858764 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 05:59:43.866630 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 05:59:43.869009 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 05:59:43.871617 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 05:59:43.874264 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 05:59:43.890249 (MainThread): Partial parsing not enabled
2021-10-06 05:59:43.938993 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 05:59:43.974174 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:59:44.004991 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 05:59:44.223899 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 05:59:44.231090 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '126f5285-1c60-4801-81ad-64b09155f6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd548f3fe20>]}
2021-10-06 05:59:44.305416 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 05:59:44.307327 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 05:59:44.308850 (MainThread): 
2021-10-06 05:59:44.309780 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:59:44.312546 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 05:59:44.327984 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 05:59:44.328548 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 05:59:44.328969 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 05:59:44.333483 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-06 05:59:44.337223 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 05:59:44.343931 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 05:59:44.352141 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:59:44.352774 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 05:59:44.353279 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 05:59:44.357529 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:44.358071 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 05:59:44.358509 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 05:59:44.360840 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 05:59:44.372761 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 05:59:44.373561 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 05:59:44.383041 (MainThread): Using postgres connection "master".
2021-10-06 05:59:44.383595 (MainThread): On master: BEGIN
2021-10-06 05:59:44.384240 (MainThread): Opening a new connection, currently in state init
2021-10-06 05:59:44.388048 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:44.388629 (MainThread): Using postgres connection "master".
2021-10-06 05:59:44.389053 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 05:59:44.394071 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 05:59:44.394844 (MainThread): On master: ROLLBACK
2021-10-06 05:59:44.395454 (MainThread): Using postgres connection "master".
2021-10-06 05:59:44.395845 (MainThread): On master: BEGIN
2021-10-06 05:59:44.396674 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:44.397090 (MainThread): On master: COMMIT
2021-10-06 05:59:44.397512 (MainThread): Using postgres connection "master".
2021-10-06 05:59:44.397902 (MainThread): On master: COMMIT
2021-10-06 05:59:44.398505 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:59:44.398866 (MainThread): On master: Close
2021-10-06 05:59:44.399487 (MainThread): 05:59:44 | Concurrency: 2 threads (target='dev')
2021-10-06 05:59:44.399933 (MainThread): 05:59:44 | 
2021-10-06 05:59:44.404068 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 05:59:44.405965 (Thread-1): 05:59:44 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 05:59:44.406778 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 05:59:44.407281 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 05:59:44.427122 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 05:59:44.439220 (Thread-1): finished collecting timing info
2021-10-06 05:59:44.469445 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:44.470533 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 05:59:44.471370 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 05:59:44.475719 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:59:44.478794 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:44.479304 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 05:59:44.480109 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 05:59:44.492755 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 05:59:44.503904 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:44.504431 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 05:59:44.505238 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:44.505805 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 05:59:44.506324 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	ord.orderdate AS orderdate,
	SUM(ord.netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 05:59:44.509413 (Thread-1): Postgres error: missing FROM-clause entry for table "ord"
LINE 9:  ord.orderdate AS orderdate,
         ^

2021-10-06 05:59:44.509997 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 05:59:44.510753 (Thread-1): finished collecting timing info
2021-10-06 05:59:44.511356 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 05:59:44.512118 (Thread-1): Database Error in model task2 (models/task2.sql)
  missing FROM-clause entry for table "ord"
  LINE 9:  ord.orderdate AS orderdate,
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: missing FROM-clause entry for table "ord"
LINE 9:  ord.orderdate AS orderdate,
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  missing FROM-clause entry for table "ord"
  LINE 9:  ord.orderdate AS orderdate,
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:59:44.514284 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '126f5285-1c60-4801-81ad-64b09155f6a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd548ded190>]}
2021-10-06 05:59:44.516007 (Thread-1): 05:59:44 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-06 05:59:44.516644 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 05:59:44.519314 (MainThread): Acquiring new postgres connection "master".
2021-10-06 05:59:44.519798 (MainThread): Using postgres connection "master".
2021-10-06 05:59:44.520182 (MainThread): On master: BEGIN
2021-10-06 05:59:44.520511 (MainThread): Opening a new connection, currently in state closed
2021-10-06 05:59:44.524451 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 05:59:44.524973 (MainThread): On master: COMMIT
2021-10-06 05:59:44.525437 (MainThread): Using postgres connection "master".
2021-10-06 05:59:44.525936 (MainThread): On master: COMMIT
2021-10-06 05:59:44.526598 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 05:59:44.527200 (MainThread): On master: Close
2021-10-06 05:59:44.528217 (MainThread): 05:59:44 | 
2021-10-06 05:59:44.529031 (MainThread): 05:59:44 | Finished running 1 table model in 0.22s.
2021-10-06 05:59:44.529712 (MainThread): Connection 'master' was properly closed.
2021-10-06 05:59:44.530238 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 05:59:44.590472 (MainThread): 
2021-10-06 05:59:44.590935 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 05:59:44.591446 (MainThread): 
2021-10-06 05:59:44.592371 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 05:59:44.592924 (MainThread):   missing FROM-clause entry for table "ord"
2021-10-06 05:59:44.593883 (MainThread):   LINE 9:  ord.orderdate AS orderdate,
2021-10-06 05:59:44.594651 (MainThread):            ^
2021-10-06 05:59:44.596310 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 05:59:44.597501 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 05:59:44.598474 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd54856ff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd548ec4ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5485561c0>]}
2021-10-06 05:59:44.599322 (MainThread): Flushing usage events
2021-10-06 06:00:03.882420 (MainThread): Running with dbt=0.19.0
2021-10-06 06:00:03.993695 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 06:00:03.999410 (MainThread): Tracking: tracking
2021-10-06 06:00:04.001591 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b619a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50d0c41c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b62a220>]}
2021-10-06 06:00:04.042007 (MainThread): Partial parsing not enabled
2021-10-06 06:00:04.048460 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 06:00:04.049322 (MainThread): Parsing macros/adapters.sql
2021-10-06 06:00:04.073756 (MainThread): Parsing macros/catalog.sql
2021-10-06 06:00:04.076950 (MainThread): Parsing macros/relations.sql
2021-10-06 06:00:04.078985 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 06:00:04.082401 (MainThread): Parsing macros/core.sql
2021-10-06 06:00:04.087327 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 06:00:04.137410 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 06:00:04.140131 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 06:00:04.142343 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 06:00:04.152558 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 06:00:04.154686 (MainThread): Parsing macros/etc/query.sql
2021-10-06 06:00:04.156491 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 06:00:04.157984 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 06:00:04.168130 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 06:00:04.193722 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 06:00:04.200664 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 06:00:04.238141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 06:00:04.262036 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 06:00:04.271735 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 06:00:04.274418 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 06:00:04.290052 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 06:00:04.296074 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 06:00:04.303517 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 06:00:04.311703 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 06:00:04.314053 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 06:00:04.316151 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 06:00:04.318628 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 06:00:04.334571 (MainThread): Partial parsing not enabled
2021-10-06 06:00:04.385059 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 06:00:04.419359 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:00:04.448740 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 06:00:04.674389 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 06:00:04.680702 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '10826604-0ff0-49d1-86cd-162ee2035326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b5057f0>]}
2021-10-06 06:00:04.741855 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 06:00:04.743794 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 06:00:04.745360 (MainThread): 
2021-10-06 06:00:04.746291 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:00:04.749176 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 06:00:04.765082 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 06:00:04.765566 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 06:00:04.765989 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 06:00:04.770965 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-06 06:00:04.775149 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 06:00:04.781405 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 06:00:04.789769 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:00:04.790257 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 06:00:04.790582 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 06:00:04.794645 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:04.795250 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:00:04.795681 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 06:00:04.798008 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 06:00:04.810957 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 06:00:04.811872 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 06:00:04.821497 (MainThread): Using postgres connection "master".
2021-10-06 06:00:04.822063 (MainThread): On master: BEGIN
2021-10-06 06:00:04.822500 (MainThread): Opening a new connection, currently in state init
2021-10-06 06:00:04.826487 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:04.827002 (MainThread): Using postgres connection "master".
2021-10-06 06:00:04.827351 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 06:00:04.832102 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 06:00:04.832794 (MainThread): On master: ROLLBACK
2021-10-06 06:00:04.833313 (MainThread): Using postgres connection "master".
2021-10-06 06:00:04.833605 (MainThread): On master: BEGIN
2021-10-06 06:00:04.834623 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:04.835082 (MainThread): On master: COMMIT
2021-10-06 06:00:04.835440 (MainThread): Using postgres connection "master".
2021-10-06 06:00:04.835733 (MainThread): On master: COMMIT
2021-10-06 06:00:04.836274 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:00:04.836590 (MainThread): On master: Close
2021-10-06 06:00:04.837181 (MainThread): 06:00:04 | Concurrency: 2 threads (target='dev')
2021-10-06 06:00:04.837908 (MainThread): 06:00:04 | 
2021-10-06 06:00:04.842059 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 06:00:04.843797 (Thread-1): 06:00:04 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 06:00:04.844607 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:00:04.845195 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 06:00:04.865518 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 06:00:04.877197 (Thread-1): finished collecting timing info
2021-10-06 06:00:04.907525 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:04.908118 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 06:00:04.908581 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 06:00:04.912761 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:00:04.916153 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:04.916651 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 06:00:04.917669 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:00:04.930424 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 06:00:04.942581 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:04.943016 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 06:00:04.943778 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:04.944341 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:04.944848 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	ord.orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 06:00:04.946004 (Thread-1): Postgres error: missing FROM-clause entry for table "ord"
LINE 9:  ord.orderdate AS orderdate,
         ^

2021-10-06 06:00:04.946419 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-06 06:00:04.947103 (Thread-1): finished collecting timing info
2021-10-06 06:00:04.947744 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 06:00:04.948455 (Thread-1): Database Error in model task2 (models/task2.sql)
  missing FROM-clause entry for table "ord"
  LINE 9:  ord.orderdate AS orderdate,
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedTable: missing FROM-clause entry for table "ord"
LINE 9:  ord.orderdate AS orderdate,
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  missing FROM-clause entry for table "ord"
  LINE 9:  ord.orderdate AS orderdate,
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 06:00:04.950670 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '10826604-0ff0-49d1-86cd-162ee2035326', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b4b6cd0>]}
2021-10-06 06:00:04.952235 (Thread-1): 06:00:04 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-06 06:00:04.952709 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 06:00:04.955371 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:00:04.955860 (MainThread): Using postgres connection "master".
2021-10-06 06:00:04.956243 (MainThread): On master: BEGIN
2021-10-06 06:00:04.956591 (MainThread): Opening a new connection, currently in state closed
2021-10-06 06:00:04.960724 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:04.961385 (MainThread): On master: COMMIT
2021-10-06 06:00:04.962000 (MainThread): Using postgres connection "master".
2021-10-06 06:00:04.962531 (MainThread): On master: COMMIT
2021-10-06 06:00:04.963231 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:00:04.963674 (MainThread): On master: Close
2021-10-06 06:00:04.964635 (MainThread): 06:00:04 | 
2021-10-06 06:00:04.965565 (MainThread): 06:00:04 | Finished running 1 table model in 0.22s.
2021-10-06 06:00:04.966106 (MainThread): Connection 'master' was properly closed.
2021-10-06 06:00:04.966514 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 06:00:05.022669 (MainThread): 
2021-10-06 06:00:05.023280 (MainThread): Completed with 1 error and 0 warnings:
2021-10-06 06:00:05.023840 (MainThread): 
2021-10-06 06:00:05.024259 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-06 06:00:05.024929 (MainThread):   missing FROM-clause entry for table "ord"
2021-10-06 06:00:05.025826 (MainThread):   LINE 9:  ord.orderdate AS orderdate,
2021-10-06 06:00:05.026796 (MainThread):            ^
2021-10-06 06:00:05.027348 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-06 06:00:05.028308 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-06 06:00:05.029242 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b45fdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b4906d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd50b4cb430>]}
2021-10-06 06:00:05.030087 (MainThread): Flushing usage events
2021-10-06 06:00:15.537697 (MainThread): Running with dbt=0.19.0
2021-10-06 06:00:15.641331 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 06:00:15.645689 (MainThread): Tracking: tracking
2021-10-06 06:00:15.647892 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff87ab9970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff89563280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff87ac9160>]}
2021-10-06 06:00:15.687519 (MainThread): Partial parsing not enabled
2021-10-06 06:00:15.692969 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 06:00:15.693922 (MainThread): Parsing macros/adapters.sql
2021-10-06 06:00:15.720178 (MainThread): Parsing macros/catalog.sql
2021-10-06 06:00:15.723484 (MainThread): Parsing macros/relations.sql
2021-10-06 06:00:15.725562 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 06:00:15.728805 (MainThread): Parsing macros/core.sql
2021-10-06 06:00:15.733683 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 06:00:15.780969 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 06:00:15.783706 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 06:00:15.786195 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 06:00:15.796529 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 06:00:15.798739 (MainThread): Parsing macros/etc/query.sql
2021-10-06 06:00:15.800330 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 06:00:15.801822 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 06:00:15.812299 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 06:00:15.835723 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 06:00:15.838126 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 06:00:15.871490 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 06:00:15.892025 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 06:00:15.899366 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 06:00:15.901808 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 06:00:15.917661 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 06:00:15.924009 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 06:00:15.931439 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 06:00:15.939183 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 06:00:15.941540 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 06:00:15.943625 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 06:00:15.946206 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 06:00:15.961525 (MainThread): Partial parsing not enabled
2021-10-06 06:00:16.009937 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 06:00:16.040415 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:00:16.071521 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 06:00:16.292734 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 06:00:16.298654 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '409a3cfd-283a-4f0d-8d8f-38b856c7d742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff879d3100>]}
2021-10-06 06:00:16.353576 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 06:00:16.355533 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 06:00:16.356912 (MainThread): 
2021-10-06 06:00:16.358235 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:00:16.360703 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 06:00:16.376245 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 06:00:16.376785 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 06:00:16.377309 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 06:00:16.382598 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 06:00:16.386700 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 06:00:16.393756 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 06:00:16.401710 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:00:16.402869 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 06:00:16.403640 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 06:00:16.408131 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:16.408799 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:00:16.409258 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 06:00:16.411711 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 06:00:16.424369 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 06:00:16.425266 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 06:00:16.435867 (MainThread): Using postgres connection "master".
2021-10-06 06:00:16.436477 (MainThread): On master: BEGIN
2021-10-06 06:00:16.436886 (MainThread): Opening a new connection, currently in state init
2021-10-06 06:00:16.440739 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:16.441347 (MainThread): Using postgres connection "master".
2021-10-06 06:00:16.441817 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 06:00:16.446995 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 06:00:16.447746 (MainThread): On master: ROLLBACK
2021-10-06 06:00:16.448432 (MainThread): Using postgres connection "master".
2021-10-06 06:00:16.448872 (MainThread): On master: BEGIN
2021-10-06 06:00:16.449851 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:16.450331 (MainThread): On master: COMMIT
2021-10-06 06:00:16.450831 (MainThread): Using postgres connection "master".
2021-10-06 06:00:16.451400 (MainThread): On master: COMMIT
2021-10-06 06:00:16.452341 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:00:16.452865 (MainThread): On master: Close
2021-10-06 06:00:16.453629 (MainThread): 06:00:16 | Concurrency: 2 threads (target='dev')
2021-10-06 06:00:16.454266 (MainThread): 06:00:16 | 
2021-10-06 06:00:16.458764 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 06:00:16.460974 (Thread-1): 06:00:16 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 06:00:16.462047 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:00:16.462688 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 06:00:16.483216 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 06:00:16.496073 (Thread-1): finished collecting timing info
2021-10-06 06:00:16.525391 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:16.525976 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 06:00:16.526450 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 06:00:16.530628 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:00:16.533659 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:16.534410 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 06:00:16.535302 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:00:16.547916 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 06:00:16.561272 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:16.561870 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 06:00:16.562782 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:16.563357 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:16.563906 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 06:00:17.082416 (Thread-1): SQL status: SELECT 365 in 0.52 seconds
2021-10-06 06:00:17.090679 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:17.091287 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-06 06:00:17.092536 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 06:00:17.095275 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:17.095824 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-06 06:00:17.096717 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 06:00:17.104597 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-06 06:00:17.105297 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:17.105866 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-06 06:00:17.142086 (Thread-1): SQL status: COMMIT in 0.04 seconds
2021-10-06 06:00:17.146140 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:17.146770 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 06:00:17.181341 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-06 06:00:17.185278 (Thread-1): finished collecting timing info
2021-10-06 06:00:17.186033 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 06:00:17.187211 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '409a3cfd-283a-4f0d-8d8f-38b856c7d742', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff87874f10>]}
2021-10-06 06:00:17.189010 (Thread-1): 06:00:17 | 1 of 1 OK created table model public.task2........................... [SELECT 365 in 0.73s]
2021-10-06 06:00:17.189703 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 06:00:17.192022 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:00:17.192675 (MainThread): Using postgres connection "master".
2021-10-06 06:00:17.193271 (MainThread): On master: BEGIN
2021-10-06 06:00:17.194156 (MainThread): Opening a new connection, currently in state closed
2021-10-06 06:00:17.199159 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-06 06:00:17.199950 (MainThread): On master: COMMIT
2021-10-06 06:00:17.200578 (MainThread): Using postgres connection "master".
2021-10-06 06:00:17.201165 (MainThread): On master: COMMIT
2021-10-06 06:00:17.202318 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:00:17.203117 (MainThread): On master: Close
2021-10-06 06:00:17.204096 (MainThread): 06:00:17 | 
2021-10-06 06:00:17.204720 (MainThread): 06:00:17 | Finished running 1 table model in 0.85s.
2021-10-06 06:00:17.205667 (MainThread): Connection 'master' was properly closed.
2021-10-06 06:00:17.206604 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 06:00:17.303622 (MainThread): 
2021-10-06 06:00:17.304111 (MainThread): Completed successfully
2021-10-06 06:00:17.304810 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 06:00:17.305591 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff8785ceb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff86ffd4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7eff86ffdc10>]}
2021-10-06 06:00:17.307086 (MainThread): Flushing usage events
2021-10-06 06:00:57.183754 (MainThread): Running with dbt=0.19.0
2021-10-06 06:00:57.300775 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 06:00:57.398076 (MainThread): Tracking: tracking
2021-10-06 06:00:57.401127 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb67b0be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb9db7400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb67c20d0>]}
2021-10-06 06:00:57.444840 (MainThread): Partial parsing not enabled
2021-10-06 06:00:57.454187 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 06:00:57.455263 (MainThread): Parsing macros/adapters.sql
2021-10-06 06:00:57.482272 (MainThread): Parsing macros/catalog.sql
2021-10-06 06:00:57.485569 (MainThread): Parsing macros/relations.sql
2021-10-06 06:00:57.487604 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 06:00:57.490769 (MainThread): Parsing macros/core.sql
2021-10-06 06:00:57.495663 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 06:00:57.543347 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 06:00:57.546156 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 06:00:57.548517 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 06:00:57.558908 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 06:00:57.561174 (MainThread): Parsing macros/etc/query.sql
2021-10-06 06:00:57.562834 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 06:00:57.564380 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 06:00:57.574723 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 06:00:57.598094 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 06:00:57.600560 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 06:00:57.636020 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 06:00:57.657164 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 06:00:57.664500 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 06:00:57.666972 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 06:00:57.682440 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 06:00:57.688427 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 06:00:57.696963 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 06:00:57.706072 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 06:00:57.708658 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 06:00:57.710888 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 06:00:57.713534 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 06:00:57.729948 (MainThread): Partial parsing not enabled
2021-10-06 06:00:57.779461 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 06:00:57.809056 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:00:57.841586 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 06:00:58.059473 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 06:00:58.065863 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '796c04d5-60f7-4d16-9e1d-6280086d413a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb6698df0>]}
2021-10-06 06:00:58.122424 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 06:00:58.124436 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 06:00:58.126304 (MainThread): 
2021-10-06 06:00:58.127841 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:00:58.130870 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 06:00:58.147084 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 06:00:58.147650 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 06:00:58.148158 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 06:00:58.153891 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 06:00:58.157991 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 06:00:58.163826 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 06:00:58.172777 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:00:58.173357 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 06:00:58.173821 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 06:00:58.177834 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:58.178447 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:00:58.178925 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 06:00:58.181320 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 06:00:58.193997 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 06:00:58.195021 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 06:00:58.206463 (MainThread): Using postgres connection "master".
2021-10-06 06:00:58.207138 (MainThread): On master: BEGIN
2021-10-06 06:00:58.207675 (MainThread): Opening a new connection, currently in state init
2021-10-06 06:00:58.212062 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:58.212671 (MainThread): Using postgres connection "master".
2021-10-06 06:00:58.213298 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 06:00:58.220175 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-06 06:00:58.221036 (MainThread): On master: ROLLBACK
2021-10-06 06:00:58.221892 (MainThread): Using postgres connection "master".
2021-10-06 06:00:58.222493 (MainThread): On master: BEGIN
2021-10-06 06:00:58.223557 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:58.224104 (MainThread): On master: COMMIT
2021-10-06 06:00:58.224689 (MainThread): Using postgres connection "master".
2021-10-06 06:00:58.225254 (MainThread): On master: COMMIT
2021-10-06 06:00:58.226071 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:00:58.226716 (MainThread): On master: Close
2021-10-06 06:00:58.227580 (MainThread): 06:00:58 | Concurrency: 2 threads (target='dev')
2021-10-06 06:00:58.228153 (MainThread): 06:00:58 | 
2021-10-06 06:00:58.232969 (Thread-1): Began running node model.my_new_project.task2
2021-10-06 06:00:58.234974 (Thread-1): 06:00:58 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-06 06:00:58.235924 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.236550 (Thread-1): Compiling model.my_new_project.task2
2021-10-06 06:00:58.259688 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-06 06:00:58.271897 (Thread-1): finished collecting timing info
2021-10-06 06:00:58.303995 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.304592 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-06 06:00:58.305077 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 06:00:58.308848 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:00:58.311986 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.312464 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 06:00:58.313172 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:00:58.326245 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-06 06:00:58.335786 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.336176 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-06 06:00:58.336804 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:58.337205 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.337530 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData 
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-06 06:00:58.820032 (Thread-1): SQL status: SELECT 365 in 0.48 seconds
2021-10-06 06:00:58.828492 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.829163 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-06 06:00:58.830215 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 06:00:58.833094 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.833711 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-06 06:00:58.834720 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 06:00:58.842199 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-06 06:00:58.842860 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.843459 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-06 06:00:58.875630 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-10-06 06:00:58.879707 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-06 06:00:58.880331 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-06 06:00:58.915034 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-06 06:00:58.918402 (Thread-1): finished collecting timing info
2021-10-06 06:00:58.919165 (Thread-1): On model.my_new_project.task2: Close
2021-10-06 06:00:58.920334 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '796c04d5-60f7-4d16-9e1d-6280086d413a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb656deb0>]}
2021-10-06 06:00:58.921936 (Thread-1): 06:00:58 | 1 of 1 OK created table model public.task2........................... [SELECT 365 in 0.68s]
2021-10-06 06:00:58.922688 (Thread-1): Finished running node model.my_new_project.task2
2021-10-06 06:00:58.925502 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:00:58.926264 (MainThread): Using postgres connection "master".
2021-10-06 06:00:58.926853 (MainThread): On master: BEGIN
2021-10-06 06:00:58.927395 (MainThread): Opening a new connection, currently in state closed
2021-10-06 06:00:58.932370 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:00:58.933019 (MainThread): On master: COMMIT
2021-10-06 06:00:58.933804 (MainThread): Using postgres connection "master".
2021-10-06 06:00:58.934748 (MainThread): On master: COMMIT
2021-10-06 06:00:58.935808 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:00:58.936513 (MainThread): On master: Close
2021-10-06 06:00:58.938060 (MainThread): 06:00:58 | 
2021-10-06 06:00:58.938975 (MainThread): 06:00:58 | Finished running 1 table model in 0.81s.
2021-10-06 06:00:58.939840 (MainThread): Connection 'master' was properly closed.
2021-10-06 06:00:58.940350 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-06 06:00:58.993189 (MainThread): 
2021-10-06 06:00:58.993744 (MainThread): Completed successfully
2021-10-06 06:00:58.994260 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 06:00:58.994929 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb6555e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb5cf0b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0cb5cf01c0>]}
2021-10-06 06:00:58.996095 (MainThread): Flushing usage events
2021-10-06 06:01:03.646861 (MainThread): Running with dbt=0.19.0
2021-10-06 06:01:03.765579 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task!'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 06:01:03.771059 (MainThread): Tracking: tracking
2021-10-06 06:01:03.773137 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72813fca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72b746400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7281500d0>]}
2021-10-06 06:01:03.813739 (MainThread): Partial parsing not enabled
2021-10-06 06:01:03.819886 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 06:01:03.820807 (MainThread): Parsing macros/adapters.sql
2021-10-06 06:01:03.845267 (MainThread): Parsing macros/catalog.sql
2021-10-06 06:01:03.848620 (MainThread): Parsing macros/relations.sql
2021-10-06 06:01:03.850648 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 06:01:03.853879 (MainThread): Parsing macros/core.sql
2021-10-06 06:01:03.859121 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 06:01:03.906538 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 06:01:03.909254 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 06:01:03.911558 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 06:01:03.922141 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 06:01:03.924390 (MainThread): Parsing macros/etc/query.sql
2021-10-06 06:01:03.926038 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 06:01:03.927524 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 06:01:03.938033 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 06:01:03.961730 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 06:01:03.964277 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 06:01:03.997141 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 06:01:04.018206 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 06:01:04.025669 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 06:01:04.028288 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 06:01:04.043818 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 06:01:04.049909 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 06:01:04.057481 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 06:01:04.066451 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 06:01:04.069476 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 06:01:04.071858 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 06:01:04.074573 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 06:01:04.092379 (MainThread): Partial parsing not enabled
2021-10-06 06:01:04.141437 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 06:01:04.172180 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:01:04.203836 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 06:01:04.435438 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 06:01:04.442652 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c428fd06-8f9c-446d-a375-a3729882447d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa72805bf40>]}
2021-10-06 06:01:04.501925 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 06:01:04.504060 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 06:01:04.505220 (MainThread): The selector 'task!' does not match any nodes and will be ignored
2021-10-06 06:01:04.506423 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-06 06:01:04.507335 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa727efb280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa727efb250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa727efb550>]}
2021-10-06 06:01:04.508239 (MainThread): Flushing usage events
2021-10-06 06:01:05.162593 (MainThread): Connection 'snapshot.my_new_project.task1_snapshot' was properly closed.
2021-10-06 06:01:13.496439 (MainThread): Running with dbt=0.19.0
2021-10-06 06:01:13.616096 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task1'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-06 06:01:13.621607 (MainThread): Tracking: tracking
2021-10-06 06:01:13.623655 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6213182940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6216789460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6213194130>]}
2021-10-06 06:01:13.664224 (MainThread): Partial parsing not enabled
2021-10-06 06:01:13.671852 (MainThread): Parsing macros/luhn_verify.sql
2021-10-06 06:01:13.672825 (MainThread): Parsing macros/adapters.sql
2021-10-06 06:01:13.697487 (MainThread): Parsing macros/catalog.sql
2021-10-06 06:01:13.700820 (MainThread): Parsing macros/relations.sql
2021-10-06 06:01:13.702987 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-06 06:01:13.706478 (MainThread): Parsing macros/core.sql
2021-10-06 06:01:13.711361 (MainThread): Parsing macros/adapters/common.sql
2021-10-06 06:01:13.758790 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-06 06:01:13.761554 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-06 06:01:13.763881 (MainThread): Parsing macros/etc/datetime.sql
2021-10-06 06:01:13.774206 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-06 06:01:13.776658 (MainThread): Parsing macros/etc/query.sql
2021-10-06 06:01:13.778339 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-06 06:01:13.779829 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-06 06:01:13.790359 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-06 06:01:13.813789 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-06 06:01:13.816380 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-06 06:01:13.849281 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-06 06:01:13.869921 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-06 06:01:13.877344 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-06 06:01:13.879743 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-06 06:01:13.895392 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-06 06:01:13.901397 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-06 06:01:13.908816 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-06 06:01:13.918080 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-06 06:01:13.921524 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-06 06:01:13.924551 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-06 06:01:13.928065 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-06 06:01:13.947224 (MainThread): Partial parsing not enabled
2021-10-06 06:01:14.002830 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.036909 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-06 06:01:14.074652 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-06 06:01:14.313694 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-06 06:01:14.318907 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25755801-a6dc-44c2-a53e-1f378b773485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f621309e970>]}
2021-10-06 06:01:14.388747 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-06 06:01:14.390635 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-06 06:01:14.392036 (MainThread): 
2021-10-06 06:01:14.392942 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:01:14.397325 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-06 06:01:14.415744 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-06 06:01:14.416234 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-06 06:01:14.416609 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-06 06:01:14.421922 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-06 06:01:14.425577 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-06 06:01:14.432800 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-06 06:01:14.441718 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:01:14.442173 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-06 06:01:14.442493 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-06 06:01:14.446662 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:01:14.447158 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-06 06:01:14.447515 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-06 06:01:14.449907 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-06 06:01:14.462346 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-06 06:01:14.462963 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-06 06:01:14.472574 (MainThread): Using postgres connection "master".
2021-10-06 06:01:14.472993 (MainThread): On master: BEGIN
2021-10-06 06:01:14.473255 (MainThread): Opening a new connection, currently in state init
2021-10-06 06:01:14.476520 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:01:14.476898 (MainThread): Using postgres connection "master".
2021-10-06 06:01:14.477148 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-06 06:01:14.482101 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-06 06:01:14.482620 (MainThread): On master: ROLLBACK
2021-10-06 06:01:14.483118 (MainThread): Using postgres connection "master".
2021-10-06 06:01:14.483371 (MainThread): On master: BEGIN
2021-10-06 06:01:14.483917 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:01:14.484291 (MainThread): On master: COMMIT
2021-10-06 06:01:14.484589 (MainThread): Using postgres connection "master".
2021-10-06 06:01:14.484871 (MainThread): On master: COMMIT
2021-10-06 06:01:14.485326 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:01:14.485585 (MainThread): On master: Close
2021-10-06 06:01:14.486158 (MainThread): 06:01:14 | Concurrency: 2 threads (target='dev')
2021-10-06 06:01:14.486488 (MainThread): 06:01:14 | 
2021-10-06 06:01:14.490025 (Thread-1): Began running node model.my_new_project.task1
2021-10-06 06:01:14.491685 (Thread-1): 06:01:14 | 1 of 1 START table model public.task1................................ [RUN]
2021-10-06 06:01:14.492306 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.492732 (Thread-1): Compiling model.my_new_project.task1
2021-10-06 06:01:14.514813 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-06 06:01:14.526398 (Thread-1): finished collecting timing info
2021-10-06 06:01:14.555828 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.556504 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-06 06:01:14.556994 (Thread-1): Opening a new connection, currently in state closed
2021-10-06 06:01:14.561257 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:01:14.564749 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.565217 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-06 06:01:14.565980 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-06 06:01:14.584011 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-06 06:01:14.591868 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.592163 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-06 06:01:14.592711 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:01:14.593041 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.593310 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */


  create  table "dellstore"."public"."task1__dbt_tmp"
  as (
    

SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM "dellstore"."public"."products"
GROUP BY first_name
  );
2021-10-06 06:01:14.788351 (Thread-1): SQL status: SELECT 200 in 0.19 seconds
2021-10-06 06:01:14.799088 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.799559 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1" rename to "task1__dbt_backup"
2021-10-06 06:01:14.800411 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 06:01:14.804012 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.811662 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1__dbt_tmp" rename to "task1"
2021-10-06 06:01:14.812586 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-06 06:01:14.820826 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-06 06:01:14.821264 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.821586 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-06 06:01:14.855989 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-10-06 06:01:14.860326 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-06 06:01:14.860998 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-06 06:01:14.895211 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-06 06:01:14.898294 (Thread-1): finished collecting timing info
2021-10-06 06:01:14.899018 (Thread-1): On model.my_new_project.task1: Close
2021-10-06 06:01:14.900161 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '25755801-a6dc-44c2-a53e-1f378b773485', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62126d73a0>]}
2021-10-06 06:01:14.901634 (Thread-1): 06:01:14 | 1 of 1 OK created table model public.task1........................... [SELECT 200 in 0.41s]
2021-10-06 06:01:14.902314 (Thread-1): Finished running node model.my_new_project.task1
2021-10-06 06:01:14.904969 (MainThread): Acquiring new postgres connection "master".
2021-10-06 06:01:14.905586 (MainThread): Using postgres connection "master".
2021-10-06 06:01:14.906087 (MainThread): On master: BEGIN
2021-10-06 06:01:14.906738 (MainThread): Opening a new connection, currently in state closed
2021-10-06 06:01:14.911556 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-06 06:01:14.912159 (MainThread): On master: COMMIT
2021-10-06 06:01:14.912817 (MainThread): Using postgres connection "master".
2021-10-06 06:01:14.913482 (MainThread): On master: COMMIT
2021-10-06 06:01:14.914306 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-06 06:01:14.914994 (MainThread): On master: Close
2021-10-06 06:01:14.916051 (MainThread): 06:01:14 | 
2021-10-06 06:01:14.916840 (MainThread): 06:01:14 | Finished running 1 table model in 0.52s.
2021-10-06 06:01:14.917451 (MainThread): Connection 'master' was properly closed.
2021-10-06 06:01:14.918299 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-06 06:01:14.971213 (MainThread): 
2021-10-06 06:01:14.972092 (MainThread): Completed successfully
2021-10-06 06:01:14.972772 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-06 06:01:14.973451 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6212fc6bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6212f3d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62126c8ca0>]}
2021-10-06 06:01:14.974210 (MainThread): Flushing usage events
2021-10-07 18:25:34.046514 (MainThread): Running with dbt=0.19.0
2021-10-07 18:25:34.403386 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:25:34.430828 (MainThread): Tracking: tracking
2021-10-07 18:25:34.433962 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd143c59a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1456861c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd143c6a220>]}
2021-10-07 18:25:34.480153 (MainThread): Partial parsing not enabled
2021-10-07 18:25:34.490129 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:25:34.492472 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:25:34.562380 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:25:34.567463 (MainThread): Parsing macros/relations.sql
2021-10-07 18:25:34.570826 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:25:34.578296 (MainThread): Parsing macros/core.sql
2021-10-07 18:25:34.588547 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:25:34.665492 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:25:34.668959 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:25:34.671847 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:25:34.687737 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:25:34.691470 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:25:34.695193 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:25:34.698367 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:25:34.723207 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:25:34.772707 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:25:34.777840 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:25:34.826200 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:25:34.853181 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:25:34.864480 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:25:34.868481 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:25:34.894435 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:25:34.901968 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:25:34.909830 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:25:34.918054 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:25:34.920498 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:25:34.922720 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:25:34.925547 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:25:35.104591 (MainThread): Partial parsing not enabled
2021-10-07 18:25:35.230809 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:25:35.310420 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:25:35.322475 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd143bc7730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd143a89e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd143a7c7c0>]}
2021-10-07 18:25:35.323564 (MainThread): Flushing usage events
2021-10-07 18:25:36.543736 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:25:36.546925 (MainThread): Encountered an error:
2021-10-07 18:25:36.550211 (MainThread): Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify('creditcard'::int8) }} = FALSE
2021-10-07 18:25:36.573295 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 16, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 16
    WHERE {{ luhn_verify('creditcard'::int8) }} = FALSE

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify('creditcard'::int8) }} = FALSE

2021-10-07 18:25:53.796294 (MainThread): Running with dbt=0.19.0
2021-10-07 18:25:53.924300 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:25:53.929936 (MainThread): Tracking: tracking
2021-10-07 18:25:53.932369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2a131970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2bbdc280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2a143160>]}
2021-10-07 18:25:53.975728 (MainThread): Partial parsing not enabled
2021-10-07 18:25:53.985572 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:25:53.987508 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:25:54.015450 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:25:54.019224 (MainThread): Parsing macros/relations.sql
2021-10-07 18:25:54.021646 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:25:54.025593 (MainThread): Parsing macros/core.sql
2021-10-07 18:25:54.031496 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:25:54.081163 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:25:54.084440 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:25:54.086892 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:25:54.100774 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:25:54.103633 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:25:54.105401 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:25:54.107048 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:25:54.118796 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:25:54.153352 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:25:54.158434 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:25:54.239304 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:25:54.283836 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:25:54.301023 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:25:54.306782 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:25:54.341855 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:25:54.356434 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:25:54.374104 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:25:54.392872 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:25:54.398608 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:25:54.404087 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:25:54.410008 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:25:54.444832 (MainThread): Partial parsing not enabled
2021-10-07 18:25:54.545604 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:25:54.614060 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:25:54.678547 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:25:54.991637 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:25:54.998985 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f22cdd08-083c-43c3-b081-389b70a4913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29f86d60>]}
2021-10-07 18:25:55.057688 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:25:55.059858 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:25:55.063864 (MainThread): 
2021-10-07 18:25:55.065262 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:25:55.068081 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:25:55.082332 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:25:55.083021 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:25:55.083670 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:25:55.089612 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:25:55.092917 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:25:55.099802 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:25:55.108091 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:25:55.108638 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:25:55.109134 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:25:55.113653 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:25:55.114405 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:25:55.115013 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:25:55.739730 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.62 seconds
2021-10-07 18:25:55.784607 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:25:55.787018 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:25:55.821371 (MainThread): Using postgres connection "master".
2021-10-07 18:25:55.823018 (MainThread): On master: BEGIN
2021-10-07 18:25:55.824388 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:25:55.836975 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:25:55.838318 (MainThread): Using postgres connection "master".
2021-10-07 18:25:55.839394 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:25:55.954727 (MainThread): SQL status: SELECT 0 in 0.11 seconds
2021-10-07 18:25:55.956667 (MainThread): On master: ROLLBACK
2021-10-07 18:25:55.958492 (MainThread): Using postgres connection "master".
2021-10-07 18:25:55.959433 (MainThread): On master: BEGIN
2021-10-07 18:25:55.963903 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:25:55.965038 (MainThread): On master: COMMIT
2021-10-07 18:25:55.965939 (MainThread): Using postgres connection "master".
2021-10-07 18:25:55.968280 (MainThread): On master: COMMIT
2021-10-07 18:25:55.970207 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:25:55.971217 (MainThread): On master: Close
2021-10-07 18:25:55.973138 (MainThread): 18:25:55 | Concurrency: 2 threads (target='dev')
2021-10-07 18:25:55.973990 (MainThread): 18:25:55 | 
2021-10-07 18:25:55.984321 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:25:55.987914 (Thread-1): 18:25:55 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:25:55.989426 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:25:55.990099 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:25:56.013835 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:25:56.026745 (Thread-1): finished collecting timing info
2021-10-07 18:25:56.058710 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:25:56.059170 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:25:56.059507 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:25:56.063724 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:25:56.066853 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:25:56.067209 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:25:56.067762 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:25:56.080507 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:25:56.128357 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:25:56.129576 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:25:56.131590 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:25:56.133200 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:25:56.134440 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData
WHERE 
    /*(creditcard / 100)::numeric(16, )*/
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::column_name/ (10^n)::column_name ), 10::column_name)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:25:56.136925 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 21:     SELECT
             ^

2021-10-07 18:25:56.137988 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:25:56.140165 (Thread-1): finished collecting timing info
2021-10-07 18:25:56.142212 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:25:56.144679 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 21:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 21:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 21:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:25:56.153040 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f22cdd08-083c-43c3-b081-389b70a4913c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29f030a0>]}
2021-10-07 18:25:56.158279 (Thread-1): 18:25:56 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.16s]
2021-10-07 18:25:56.159633 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:25:56.167812 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:25:56.168933 (MainThread): Using postgres connection "master".
2021-10-07 18:25:56.169809 (MainThread): On master: BEGIN
2021-10-07 18:25:56.170536 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:25:56.177244 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:25:56.177890 (MainThread): On master: COMMIT
2021-10-07 18:25:56.178293 (MainThread): Using postgres connection "master".
2021-10-07 18:25:56.178666 (MainThread): On master: COMMIT
2021-10-07 18:25:56.179355 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:25:56.179959 (MainThread): On master: Close
2021-10-07 18:25:56.180908 (MainThread): 18:25:56 | 
2021-10-07 18:25:56.181544 (MainThread): 18:25:56 | Finished running 1 table model in 1.12s.
2021-10-07 18:25:56.182258 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:25:56.182986 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:25:56.238032 (MainThread): 
2021-10-07 18:25:56.238619 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:25:56.239235 (MainThread): 
2021-10-07 18:25:56.239790 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:25:56.240619 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:25:56.241744 (MainThread):   LINE 21:     SELECT
2021-10-07 18:25:56.242932 (MainThread):                ^
2021-10-07 18:25:56.244818 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:25:56.246358 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:25:56.247560 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29ee0f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe2a034160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbe29685760>]}
2021-10-07 18:25:56.249037 (MainThread): Flushing usage events
2021-10-07 18:26:32.973411 (MainThread): Running with dbt=0.19.0
2021-10-07 18:26:33.123030 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:26:33.127168 (MainThread): Tracking: tracking
2021-10-07 18:26:33.129338 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080b984910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080ef8b430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080b996100>]}
2021-10-07 18:26:33.171290 (MainThread): Partial parsing not enabled
2021-10-07 18:26:33.179362 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:26:33.181139 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:26:33.206566 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:26:33.209838 (MainThread): Parsing macros/relations.sql
2021-10-07 18:26:33.212117 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:26:33.215673 (MainThread): Parsing macros/core.sql
2021-10-07 18:26:33.220955 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:26:33.301904 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:26:33.307751 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:26:33.313029 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:26:33.334150 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:26:33.337994 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:26:33.341039 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:26:33.344086 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:26:33.369200 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:26:33.423867 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:26:33.428929 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:26:33.506746 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:26:33.546868 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:26:33.554649 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:26:33.557544 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:26:33.573613 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:26:33.580534 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:26:33.588953 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:26:33.598885 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:26:33.601533 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:26:33.604025 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:26:33.607281 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:26:33.626273 (MainThread): Partial parsing not enabled
2021-10-07 18:26:33.724721 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:26:33.778990 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:26:33.843092 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:26:34.251572 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:26:34.260009 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3139453a-b364-47b6-b28b-ffcc67f9c707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080b7dbdc0>]}
2021-10-07 18:26:34.318912 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:26:34.320973 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:26:34.322657 (MainThread): 
2021-10-07 18:26:34.323744 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:26:34.326543 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:26:34.342219 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:26:34.342880 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:26:34.343454 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:26:34.350055 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:26:34.353369 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:26:34.359459 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:26:34.368148 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:26:34.368920 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:26:34.369385 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:26:34.373366 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:26:34.373977 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:26:34.374478 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:26:34.377198 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:26:34.389152 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:26:34.390055 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:26:34.400639 (MainThread): Using postgres connection "master".
2021-10-07 18:26:34.401321 (MainThread): On master: BEGIN
2021-10-07 18:26:34.401819 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:26:34.405894 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:26:34.406469 (MainThread): Using postgres connection "master".
2021-10-07 18:26:34.407008 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:26:34.413206 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:26:34.414043 (MainThread): On master: ROLLBACK
2021-10-07 18:26:34.414722 (MainThread): Using postgres connection "master".
2021-10-07 18:26:34.415264 (MainThread): On master: BEGIN
2021-10-07 18:26:34.416358 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:26:34.416926 (MainThread): On master: COMMIT
2021-10-07 18:26:34.417477 (MainThread): Using postgres connection "master".
2021-10-07 18:26:34.418109 (MainThread): On master: COMMIT
2021-10-07 18:26:34.418935 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:26:34.419551 (MainThread): On master: Close
2021-10-07 18:26:34.420378 (MainThread): 18:26:34 | Concurrency: 2 threads (target='dev')
2021-10-07 18:26:34.420932 (MainThread): 18:26:34 | 
2021-10-07 18:26:34.425593 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:26:34.427773 (Thread-1): 18:26:34 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:26:34.428700 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:26:34.429252 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:26:34.452866 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:26:34.466110 (Thread-1): finished collecting timing info
2021-10-07 18:26:34.494468 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:26:34.495449 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:26:34.496257 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:26:34.500403 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:26:34.503762 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:26:34.504406 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:26:34.505108 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:26:34.518926 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:26:34.529661 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:26:34.530075 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:26:34.530858 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:26:34.531245 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:26:34.531627 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) as orderCustomerData
WHERE 
    /*(creditcard / 100)::numeric(16, )*/
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::column_name/ (10^n)::column_name ), 10::column_name)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:26:34.532419 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 21:     SELECT
             ^

2021-10-07 18:26:34.532875 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:26:34.533670 (Thread-1): finished collecting timing info
2021-10-07 18:26:34.534326 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:26:34.535213 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 21:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 21:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 21:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:26:34.537461 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3139453a-b364-47b6-b28b-ffcc67f9c707', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080b82ab50>]}
2021-10-07 18:26:34.539279 (Thread-1): 18:26:34 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 18:26:34.539880 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:26:34.542123 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:26:34.542766 (MainThread): Using postgres connection "master".
2021-10-07 18:26:34.543213 (MainThread): On master: BEGIN
2021-10-07 18:26:34.543768 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:26:34.548249 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:26:34.548821 (MainThread): On master: COMMIT
2021-10-07 18:26:34.549191 (MainThread): Using postgres connection "master".
2021-10-07 18:26:34.549725 (MainThread): On master: COMMIT
2021-10-07 18:26:34.550571 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:26:34.551043 (MainThread): On master: Close
2021-10-07 18:26:34.551788 (MainThread): 18:26:34 | 
2021-10-07 18:26:34.552327 (MainThread): 18:26:34 | Finished running 1 table model in 0.23s.
2021-10-07 18:26:34.552869 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:26:34.553307 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:26:34.606824 (MainThread): 
2021-10-07 18:26:34.607297 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:26:34.607817 (MainThread): 
2021-10-07 18:26:34.608410 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:26:34.609542 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:26:34.610809 (MainThread):   LINE 21:     SELECT
2021-10-07 18:26:34.611812 (MainThread):                ^
2021-10-07 18:26:34.614482 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:26:34.615651 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:26:34.616650 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080aec9dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080b74c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f080b83f850>]}
2021-10-07 18:26:34.617762 (MainThread): Flushing usage events
2021-10-07 18:27:35.950561 (MainThread): Running with dbt=0.19.0
2021-10-07 18:27:36.350129 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:27:36.356129 (MainThread): Tracking: tracking
2021-10-07 18:27:36.359410 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2eed19a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b3097d2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2eee2190>]}
2021-10-07 18:27:36.407088 (MainThread): Partial parsing not enabled
2021-10-07 18:27:36.422036 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:27:36.424032 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:27:36.452756 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:27:36.457109 (MainThread): Parsing macros/relations.sql
2021-10-07 18:27:36.459937 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:27:36.464946 (MainThread): Parsing macros/core.sql
2021-10-07 18:27:36.473314 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:27:36.548336 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:27:36.554008 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:27:36.559168 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:27:36.584044 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:27:36.589187 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:27:36.592960 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:27:36.596316 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:27:36.622281 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:27:36.669667 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:27:36.673540 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:27:36.727626 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:27:36.758634 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:27:36.774697 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:27:36.780486 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:27:36.817091 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:27:36.832626 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:27:36.841265 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:27:36.850675 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:27:36.854261 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:27:36.857314 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:27:36.861031 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:27:36.884647 (MainThread): Partial parsing not enabled
2021-10-07 18:27:36.971803 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:27:37.034035 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:27:37.040709 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2ee8d100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2ed0afa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9b2ecf5730>]}
2021-10-07 18:27:37.041608 (MainThread): Flushing usage events
2021-10-07 18:27:37.734110 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:27:37.736680 (MainThread): Encountered an error:
2021-10-07 18:27:37.738524 (MainThread): Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify(creditcard::int8) }} = FALSE
2021-10-07 18:27:37.753512 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 16, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 16
    WHERE {{ luhn_verify(creditcard::int8) }} = FALSE

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify(creditcard::int8) }} = FALSE

2021-10-07 18:33:11.361064 (MainThread): Running with dbt=0.19.0
2021-10-07 18:33:11.529288 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:33:11.538147 (MainThread): Tracking: tracking
2021-10-07 18:33:11.541653 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645d114a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645ebbf1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645d126220>]}
2021-10-07 18:33:11.590849 (MainThread): Partial parsing not enabled
2021-10-07 18:33:11.609762 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:33:11.613835 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:33:11.661920 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:33:11.668982 (MainThread): Parsing macros/relations.sql
2021-10-07 18:33:11.673375 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:33:11.680999 (MainThread): Parsing macros/core.sql
2021-10-07 18:33:11.692742 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:33:11.749831 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:33:11.753154 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:33:11.755623 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:33:11.766462 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:33:11.768864 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:33:11.770724 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:33:11.772362 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:33:11.783254 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:33:11.808186 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:33:11.810784 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:33:11.849287 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:33:11.875267 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:33:11.886428 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:33:11.889908 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:33:11.910146 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:33:11.917018 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:33:11.924704 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:33:11.934932 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:33:11.938370 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:33:11.941440 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:33:11.945187 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:33:11.964583 (MainThread): Partial parsing not enabled
2021-10-07 18:33:12.017528 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:33:12.059692 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:33:12.103811 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:33:12.420654 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:33:12.428951 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dd79043-428e-4fd1-8a0f-8269c8743d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645cf6cdf0>]}
2021-10-07 18:33:12.489141 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:33:12.491354 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:33:12.492878 (MainThread): 
2021-10-07 18:33:12.493765 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:33:12.496634 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:33:12.510374 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:33:12.511213 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:33:12.511687 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:33:12.517094 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:33:12.520799 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:33:12.526995 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:33:12.535173 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:33:12.535866 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:33:12.536383 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:33:12.540321 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:12.540887 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:33:12.541362 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:33:12.543972 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:33:12.556669 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:33:12.557601 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:33:12.569009 (MainThread): Using postgres connection "master".
2021-10-07 18:33:12.569548 (MainThread): On master: BEGIN
2021-10-07 18:33:12.569992 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:33:12.574123 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:12.574733 (MainThread): Using postgres connection "master".
2021-10-07 18:33:12.575139 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:33:12.581048 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:33:12.581806 (MainThread): On master: ROLLBACK
2021-10-07 18:33:12.582863 (MainThread): Using postgres connection "master".
2021-10-07 18:33:12.583564 (MainThread): On master: BEGIN
2021-10-07 18:33:12.585218 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:12.585799 (MainThread): On master: COMMIT
2021-10-07 18:33:12.586478 (MainThread): Using postgres connection "master".
2021-10-07 18:33:12.587114 (MainThread): On master: COMMIT
2021-10-07 18:33:12.588084 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:33:12.588742 (MainThread): On master: Close
2021-10-07 18:33:12.589772 (MainThread): 18:33:12 | Concurrency: 2 threads (target='dev')
2021-10-07 18:33:12.590487 (MainThread): 18:33:12 | 
2021-10-07 18:33:12.598094 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:33:12.601631 (Thread-1): 18:33:12 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:33:12.602853 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:33:12.603557 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:33:12.627888 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:33:12.703617 (Thread-1): finished collecting timing info
2021-10-07 18:33:12.769350 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:12.770355 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:33:12.771297 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:33:12.779086 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 18:33:12.785251 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:12.786044 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:33:12.787428 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:33:12.812129 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:33:12.827079 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:12.827922 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:33:12.829351 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:12.830080 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:12.830841 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    /*( / 100)::numeric(16, )*/
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::column::int8/ (10^n)::column::int8 ), 10::column::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:33:12.832240 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 21:     SELECT
             ^

2021-10-07 18:33:12.832973 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:33:12.834279 (Thread-1): finished collecting timing info
2021-10-07 18:33:12.835360 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:33:12.836526 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 21:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 21:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 21:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:33:12.840320 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dd79043-428e-4fd1-8a0f-8269c8743d06', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645d002670>]}
2021-10-07 18:33:12.843201 (Thread-1): 18:33:12 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.24s]
2021-10-07 18:33:12.844001 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:33:12.847283 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:33:12.848164 (MainThread): Using postgres connection "master".
2021-10-07 18:33:12.848893 (MainThread): On master: BEGIN
2021-10-07 18:33:12.849563 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:33:12.856572 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:33:12.857307 (MainThread): On master: COMMIT
2021-10-07 18:33:12.857957 (MainThread): Using postgres connection "master".
2021-10-07 18:33:12.858618 (MainThread): On master: COMMIT
2021-10-07 18:33:12.859730 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:33:12.860425 (MainThread): On master: Close
2021-10-07 18:33:12.861778 (MainThread): 18:33:12 | 
2021-10-07 18:33:12.862959 (MainThread): 18:33:12 | Finished running 1 table model in 0.37s.
2021-10-07 18:33:12.864016 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:33:12.864585 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:33:12.926836 (MainThread): 
2021-10-07 18:33:12.927710 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:33:12.929356 (MainThread): 
2021-10-07 18:33:12.930672 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:33:12.931389 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:33:12.933039 (MainThread):   LINE 21:     SELECT
2021-10-07 18:33:12.934534 (MainThread):                ^
2021-10-07 18:33:12.935364 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:33:12.936700 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:33:12.937690 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645cf4f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645d0ebe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f645c663fd0>]}
2021-10-07 18:33:12.938458 (MainThread): Flushing usage events
2021-10-07 18:33:32.523765 (MainThread): Running with dbt=0.19.0
2021-10-07 18:33:32.853144 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:33:32.923944 (MainThread): Tracking: tracking
2021-10-07 18:33:32.928399 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ab4d8910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03aeadf430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ab4e9100>]}
2021-10-07 18:33:33.009939 (MainThread): Partial parsing not enabled
2021-10-07 18:33:33.027931 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:33:33.031722 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:33:33.086066 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:33:33.092260 (MainThread): Parsing macros/relations.sql
2021-10-07 18:33:33.096933 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:33:33.104487 (MainThread): Parsing macros/core.sql
2021-10-07 18:33:33.116049 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:33:33.183863 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:33:33.187306 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:33:33.189680 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:33:33.201122 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:33:33.203686 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:33:33.205937 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:33:33.207598 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:33:33.218961 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:33:33.244294 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:33:33.247028 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:33:33.294916 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:33:33.344442 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:33:33.362841 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:33:33.369193 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:33:33.403933 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:33:33.414989 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:33:33.428449 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:33:33.444951 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:33:33.450015 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:33:33.454618 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:33:33.459751 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:33:33.487936 (MainThread): Partial parsing not enabled
2021-10-07 18:33:33.558925 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:33:33.619886 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:33:33.674683 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:33:33.958872 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:33:33.965765 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1f4e5577-0fc9-44fa-a5c1-10d50459e1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ab32fc70>]}
2021-10-07 18:33:34.031973 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:33:34.034103 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:33:34.035598 (MainThread): 
2021-10-07 18:33:34.037546 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:33:34.040381 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:33:34.054925 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:33:34.055718 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:33:34.056631 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:33:34.061912 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:33:34.065467 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:33:34.072032 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:33:34.080561 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:33:34.081149 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:33:34.081660 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:33:34.086052 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:34.086690 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:33:34.087310 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:33:34.090022 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:33:34.102868 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:33:34.103735 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:33:34.114180 (MainThread): Using postgres connection "master".
2021-10-07 18:33:34.114799 (MainThread): On master: BEGIN
2021-10-07 18:33:34.115295 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:33:34.119424 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:34.119967 (MainThread): Using postgres connection "master".
2021-10-07 18:33:34.120373 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:33:34.126066 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:33:34.126811 (MainThread): On master: ROLLBACK
2021-10-07 18:33:34.127543 (MainThread): Using postgres connection "master".
2021-10-07 18:33:34.127956 (MainThread): On master: BEGIN
2021-10-07 18:33:34.128892 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:34.129388 (MainThread): On master: COMMIT
2021-10-07 18:33:34.129870 (MainThread): Using postgres connection "master".
2021-10-07 18:33:34.130325 (MainThread): On master: COMMIT
2021-10-07 18:33:34.131027 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:33:34.131501 (MainThread): On master: Close
2021-10-07 18:33:34.132248 (MainThread): 18:33:34 | Concurrency: 2 threads (target='dev')
2021-10-07 18:33:34.132842 (MainThread): 18:33:34 | 
2021-10-07 18:33:34.136922 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:33:34.138867 (Thread-1): 18:33:34 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:33:34.139692 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:33:34.140185 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:33:34.161996 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:33:34.175440 (Thread-1): finished collecting timing info
2021-10-07 18:33:34.220254 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:34.220854 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:33:34.221195 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:33:34.224795 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:33:34.228336 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:34.228947 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:33:34.229968 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:33:34.243291 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:33:34.254648 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:34.255294 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:33:34.256308 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:34.256909 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:34.257417 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    /*( / 100)::numeric(16, )*/
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::column::int8/ (10^n)::column::int8 ), 10::column::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:33:34.258329 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^

2021-10-07 18:33:34.258745 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:33:34.259528 (Thread-1): finished collecting timing info
2021-10-07 18:33:34.260182 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:33:34.260999 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:33:34.263233 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1f4e5577-0fc9-44fa-a5c1-10d50459e1e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ab3937c0>]}
2021-10-07 18:33:34.264949 (Thread-1): 18:33:34 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.12s]
2021-10-07 18:33:34.265506 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:33:34.268317 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:33:34.268963 (MainThread): Using postgres connection "master".
2021-10-07 18:33:34.269406 (MainThread): On master: BEGIN
2021-10-07 18:33:34.269959 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:33:34.274543 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:34.275065 (MainThread): On master: COMMIT
2021-10-07 18:33:34.275556 (MainThread): Using postgres connection "master".
2021-10-07 18:33:34.275970 (MainThread): On master: COMMIT
2021-10-07 18:33:34.276686 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:33:34.277121 (MainThread): On master: Close
2021-10-07 18:33:34.277865 (MainThread): 18:33:34 | 
2021-10-07 18:33:34.278534 (MainThread): 18:33:34 | Finished running 1 table model in 0.24s.
2021-10-07 18:33:34.279594 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:33:34.280940 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:33:34.332603 (MainThread): 
2021-10-07 18:33:34.333060 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:33:34.333574 (MainThread): 
2021-10-07 18:33:34.334002 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:33:34.334668 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:33:34.336253 (MainThread):   LINE 20:     SELECT
2021-10-07 18:33:34.337281 (MainThread):                ^
2021-10-07 18:33:34.338252 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:33:34.339131 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:33:34.340153 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ab3a1370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03ab2a2e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a89c0fa0>]}
2021-10-07 18:33:34.341455 (MainThread): Flushing usage events
2021-10-07 18:33:53.293927 (MainThread): Running with dbt=0.19.0
2021-10-07 18:33:53.426478 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:33:53.432388 (MainThread): Tracking: tracking
2021-10-07 18:33:53.434767 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa765ed7a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa767982310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa765ee8280>]}
2021-10-07 18:33:53.476470 (MainThread): Partial parsing not enabled
2021-10-07 18:33:53.482538 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:33:53.484527 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:33:53.509872 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:33:53.513678 (MainThread): Parsing macros/relations.sql
2021-10-07 18:33:53.515802 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:33:53.519877 (MainThread): Parsing macros/core.sql
2021-10-07 18:33:53.531756 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:33:53.598515 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:33:53.603232 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:33:53.606846 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:33:53.623707 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:33:53.628299 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:33:53.631336 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:33:53.634260 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:33:53.658284 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:33:53.709120 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:33:53.714928 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:33:53.790151 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:33:53.829070 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:33:53.847051 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:33:53.852853 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:33:53.890588 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:33:53.904974 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:33:53.919434 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:33:53.931779 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:33:53.934842 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:33:53.938857 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:33:53.943977 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:33:53.964222 (MainThread): Partial parsing not enabled
2021-10-07 18:33:54.018662 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:33:54.063458 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:33:54.114706 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:33:54.504335 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:33:54.512043 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c09224cc-3547-4477-b300-711063569839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa765d2dfd0>]}
2021-10-07 18:33:54.576966 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:33:54.579806 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:33:54.581953 (MainThread): 
2021-10-07 18:33:54.584178 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:33:54.588230 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:33:54.609323 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:33:54.610168 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:33:54.610683 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:33:54.616727 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:33:54.620959 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:33:54.628016 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:33:54.637222 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:33:54.637948 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:33:54.638429 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:33:54.642342 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:54.642893 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:33:54.643368 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:33:54.646955 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:33:54.658677 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:33:54.659482 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:33:54.669745 (MainThread): Using postgres connection "master".
2021-10-07 18:33:54.670549 (MainThread): On master: BEGIN
2021-10-07 18:33:54.671261 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:33:54.677502 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:33:54.678231 (MainThread): Using postgres connection "master".
2021-10-07 18:33:54.678892 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:33:54.687575 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:33:54.688728 (MainThread): On master: ROLLBACK
2021-10-07 18:33:54.689688 (MainThread): Using postgres connection "master".
2021-10-07 18:33:54.690301 (MainThread): On master: BEGIN
2021-10-07 18:33:54.691709 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:54.692284 (MainThread): On master: COMMIT
2021-10-07 18:33:54.692930 (MainThread): Using postgres connection "master".
2021-10-07 18:33:54.693581 (MainThread): On master: COMMIT
2021-10-07 18:33:54.694627 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:33:54.695245 (MainThread): On master: Close
2021-10-07 18:33:54.696373 (MainThread): 18:33:54 | Concurrency: 2 threads (target='dev')
2021-10-07 18:33:54.697137 (MainThread): 18:33:54 | 
2021-10-07 18:33:54.706480 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:33:54.709378 (Thread-1): 18:33:54 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:33:54.710811 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:33:54.711649 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:33:54.735390 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:33:54.769471 (Thread-1): finished collecting timing info
2021-10-07 18:33:54.815928 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:54.816575 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:33:54.817245 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:33:54.821298 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:33:54.824753 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:54.825400 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:33:54.826270 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:33:54.843943 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:33:54.861133 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:54.862009 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:33:54.863143 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:33:54.863854 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:33:54.864668 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * FROM 
    "dellstore"."public"."orders" AS ord
	JOIN
	"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    /*( / 100)::numeric(16, )*/
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::column::int8/ (10^n)::column::int8 ), 10::column::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:33:54.865873 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^

2021-10-07 18:33:54.866597 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:33:54.867690 (Thread-1): finished collecting timing info
2021-10-07 18:33:54.868751 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:33:54.869906 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:33:54.873473 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c09224cc-3547-4477-b300-711063569839', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7654358b0>]}
2021-10-07 18:33:54.876055 (Thread-1): 18:33:54 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.16s]
2021-10-07 18:33:54.876854 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:33:54.880110 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:33:54.881028 (MainThread): Using postgres connection "master".
2021-10-07 18:33:54.881685 (MainThread): On master: BEGIN
2021-10-07 18:33:54.882330 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:33:54.888691 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:33:54.889479 (MainThread): On master: COMMIT
2021-10-07 18:33:54.890212 (MainThread): Using postgres connection "master".
2021-10-07 18:33:54.890988 (MainThread): On master: COMMIT
2021-10-07 18:33:54.892216 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:33:54.893247 (MainThread): On master: Close
2021-10-07 18:33:54.894488 (MainThread): 18:33:54 | 
2021-10-07 18:33:54.895455 (MainThread): 18:33:54 | Finished running 1 table model in 0.31s.
2021-10-07 18:33:54.896763 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:33:54.898051 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:33:54.966828 (MainThread): 
2021-10-07 18:33:54.967478 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:33:54.967902 (MainThread): 
2021-10-07 18:33:54.968487 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:33:54.969543 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:33:54.970267 (MainThread):   LINE 20:     SELECT
2021-10-07 18:33:54.971434 (MainThread):                ^
2021-10-07 18:33:54.972101 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:33:54.972884 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:33:54.973695 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa765e00bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa765d3b160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa765db7280>]}
2021-10-07 18:33:54.975315 (MainThread): Flushing usage events
2021-10-07 18:37:38.984971 (MainThread): Running with dbt=0.19.0
2021-10-07 18:37:39.127606 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:37:39.131905 (MainThread): Tracking: tracking
2021-10-07 18:37:39.134116 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00269c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c03871400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c0027b0d0>]}
2021-10-07 18:37:39.182602 (MainThread): Partial parsing not enabled
2021-10-07 18:37:39.192333 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:37:39.194407 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:37:39.220184 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:37:39.223757 (MainThread): Parsing macros/relations.sql
2021-10-07 18:37:39.226232 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:37:39.230739 (MainThread): Parsing macros/core.sql
2021-10-07 18:37:39.237500 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:37:39.304131 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:37:39.308871 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:37:39.314080 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:37:39.337843 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:37:39.341469 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:37:39.343838 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:37:39.345802 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:37:39.358057 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:37:39.383075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:37:39.385994 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:37:39.428142 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:37:39.462052 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:37:39.478012 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:37:39.483800 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:37:39.522500 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:37:39.537706 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:37:39.555940 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:37:39.574761 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:37:39.580230 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:37:39.585028 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:37:39.590833 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:37:39.623188 (MainThread): Partial parsing not enabled
2021-10-07 18:37:39.699248 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:37:39.765158 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:37:39.831307 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:37:40.204799 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:37:40.211274 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1e1738e1-c0ce-4fc9-9408-9832d9bfcb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c000bf5b0>]}
2021-10-07 18:37:40.275821 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:37:40.277759 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:37:40.279297 (MainThread): 
2021-10-07 18:37:40.280286 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:37:40.283088 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:37:40.297917 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:37:40.298595 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:37:40.299256 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:37:40.305296 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:37:40.308597 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:37:40.315002 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:37:40.323539 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:37:40.324164 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:37:40.324650 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:37:40.328895 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:37:40.329388 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:37:40.330174 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:37:40.333547 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:37:40.344505 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:37:40.345370 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:37:40.356367 (MainThread): Using postgres connection "master".
2021-10-07 18:37:40.357118 (MainThread): On master: BEGIN
2021-10-07 18:37:40.357629 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:37:40.361648 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:37:40.362290 (MainThread): Using postgres connection "master".
2021-10-07 18:37:40.362745 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:37:40.368333 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 18:37:40.369159 (MainThread): On master: ROLLBACK
2021-10-07 18:37:40.369959 (MainThread): Using postgres connection "master".
2021-10-07 18:37:40.370507 (MainThread): On master: BEGIN
2021-10-07 18:37:40.371481 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:37:40.371948 (MainThread): On master: COMMIT
2021-10-07 18:37:40.372457 (MainThread): Using postgres connection "master".
2021-10-07 18:37:40.372954 (MainThread): On master: COMMIT
2021-10-07 18:37:40.373692 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:37:40.374353 (MainThread): On master: Close
2021-10-07 18:37:40.375134 (MainThread): 18:37:40 | Concurrency: 2 threads (target='dev')
2021-10-07 18:37:40.375742 (MainThread): 18:37:40 | 
2021-10-07 18:37:40.955794 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:37:40.959162 (Thread-1): 18:37:40 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:37:40.960481 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:37:40.961654 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:37:40.997361 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:37:41.008217 (Thread-1): finished collecting timing info
2021-10-07 18:37:41.036367 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.037179 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:37:41.037625 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:37:41.041771 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:37:41.045138 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.045660 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:37:41.046453 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:37:41.061421 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:37:41.077768 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.078548 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:37:41.079912 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:37:41.080898 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.081688 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 18:37:41.861379 (Thread-1): SQL status: SELECT 365 in 0.78 seconds
2021-10-07 18:37:41.876310 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.877141 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-07 18:37:41.878660 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 18:37:41.884529 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.885358 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-07 18:37:41.886742 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 18:37:41.904316 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-07 18:37:41.905348 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.906226 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-07 18:37:41.954924 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-10-07 18:37:41.963370 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:37:41.964089 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:37:41.996416 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-07 18:37:42.007419 (Thread-1): finished collecting timing info
2021-10-07 18:37:42.009223 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:37:42.012625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1e1738e1-c0ce-4fc9-9408-9832d9bfcb30', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bff7c7f10>]}
2021-10-07 18:37:42.018077 (Thread-1): 18:37:42 | 1 of 1 OK created table model public.task2........................... [SELECT 365 in 1.05s]
2021-10-07 18:37:42.019795 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:37:42.026880 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:37:42.028416 (MainThread): Using postgres connection "master".
2021-10-07 18:37:42.029716 (MainThread): On master: BEGIN
2021-10-07 18:37:42.031005 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:37:42.043559 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:37:42.045055 (MainThread): On master: COMMIT
2021-10-07 18:37:42.046437 (MainThread): Using postgres connection "master".
2021-10-07 18:37:42.047440 (MainThread): On master: COMMIT
2021-10-07 18:37:42.049517 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:37:42.050824 (MainThread): On master: Close
2021-10-07 18:37:42.053545 (MainThread): 18:37:42 | 
2021-10-07 18:37:42.055667 (MainThread): 18:37:42 | Finished running 1 table model in 1.77s.
2021-10-07 18:37:42.057569 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:37:42.059431 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:37:42.125897 (MainThread): 
2021-10-07 18:37:42.126526 (MainThread): Completed successfully
2021-10-07 18:37:42.127272 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-07 18:37:42.128038 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8c00097c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfd78be50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8bfd78b970>]}
2021-10-07 18:37:42.128961 (MainThread): Flushing usage events
2021-10-07 18:38:37.724065 (MainThread): Running with dbt=0.19.0
2021-10-07 18:38:37.850659 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:38:37.855334 (MainThread): Tracking: tracking
2021-10-07 18:38:37.857705 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa150ee910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa186f5430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa15100100>]}
2021-10-07 18:38:37.898241 (MainThread): Partial parsing not enabled
2021-10-07 18:38:37.914829 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:38:37.917539 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa15140c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1508d670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa1508d7f0>]}
2021-10-07 18:38:37.918228 (MainThread): Flushing usage events
2021-10-07 18:38:38.541520 (MainThread): Encountered an error:
2021-10-07 18:38:38.550309 (MainThread): Compilation Error
  dbt found two macros named "luhn_verify" in the project "my_new_project".
   To fix this error, rename or remove one of the following macros:
      - macros/luhn_verify.sql
      - macros/luhn_verify.sql
2021-10-07 18:38:38.565880 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 111, in parse_file
    self.results.add_macro(block.file, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/results.py", line 143, in add_macro
    raise_compiler_error(msg)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two macros named "luhn_verify" in the project "my_new_project".
   To fix this error, rename or remove one of the following macros:
      - macros/luhn_verify.sql
      - macros/luhn_verify.sql

2021-10-07 18:39:15.048837 (MainThread): Running with dbt=0.19.0
2021-10-07 18:39:15.208552 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:39:15.214337 (MainThread): Tracking: tracking
2021-10-07 18:39:15.216627 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5020669d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe503b11310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5020771c0>]}
2021-10-07 18:39:15.260166 (MainThread): Partial parsing not enabled
2021-10-07 18:39:15.269921 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:39:15.272311 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe5020045e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe502004760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe502004e20>]}
2021-10-07 18:39:15.273012 (MainThread): Flushing usage events
2021-10-07 18:39:15.903776 (MainThread): Encountered an error:
2021-10-07 18:39:15.907094 (MainThread): Compilation Error
  dbt found two macros named "luhn_verify" in the project "my_new_project".
   To fix this error, rename or remove one of the following macros:
      - macros/luhn_verify.sql
      - macros/luhn_verify.sql
2021-10-07 18:39:15.917265 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 111, in parse_file
    self.results.add_macro(block.file, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/results.py", line 143, in add_macro
    raise_compiler_error(msg)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two macros named "luhn_verify" in the project "my_new_project".
   To fix this error, rename or remove one of the following macros:
      - macros/luhn_verify.sql
      - macros/luhn_verify.sql

2021-10-07 18:39:55.956589 (MainThread): Running with dbt=0.19.0
2021-10-07 18:39:56.180965 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:39:56.187960 (MainThread): Tracking: tracking
2021-10-07 18:39:56.191122 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bdd33970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bf7df280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bdd44160>]}
2021-10-07 18:39:56.243433 (MainThread): Partial parsing not enabled
2021-10-07 18:39:56.252495 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:39:56.255046 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bdcd3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bdcd3670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa4bdcd3790>]}
2021-10-07 18:39:56.255689 (MainThread): Flushing usage events
2021-10-07 18:39:56.916082 (MainThread): Encountered an error:
2021-10-07 18:39:56.919710 (MainThread): Compilation Error
  dbt found two macros named "luhn_verify" in the project "my_new_project".
   To fix this error, rename or remove one of the following macros:
      - macros/luhn_verify.sql
      - macros/luhn_verify.sql
2021-10-07 18:39:56.936929 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 111, in parse_file
    self.results.add_macro(block.file, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/results.py", line 143, in add_macro
    raise_compiler_error(msg)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error
  dbt found two macros named "luhn_verify" in the project "my_new_project".
   To fix this error, rename or remove one of the following macros:
      - macros/luhn_verify.sql
      - macros/luhn_verify.sql

2021-10-07 18:40:03.085270 (MainThread): Running with dbt=0.19.0
2021-10-07 18:40:03.210200 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:40:03.215921 (MainThread): Tracking: tracking
2021-10-07 18:40:03.218188 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a25f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065bd0b310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a2701c0>]}
2021-10-07 18:40:03.259994 (MainThread): Partial parsing not enabled
2021-10-07 18:40:03.270614 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:40:03.273147 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:40:03.298649 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:40:03.302200 (MainThread): Parsing macros/relations.sql
2021-10-07 18:40:03.304596 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:40:03.309034 (MainThread): Parsing macros/core.sql
2021-10-07 18:40:03.315410 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:40:03.406240 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:40:03.412592 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:40:03.417748 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:40:03.442917 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:40:03.448120 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:40:03.451374 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:40:03.454632 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:40:03.474983 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:40:03.530078 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:40:03.535862 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:40:03.616054 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:40:03.667215 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:40:03.685256 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:40:03.691210 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:40:03.723650 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:40:03.731183 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:40:03.741066 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:40:03.750947 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:40:03.754178 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:40:03.756869 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:40:03.760086 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:40:03.779718 (MainThread): Partial parsing not enabled
2021-10-07 18:40:03.838328 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:40:03.871959 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:40:03.907346 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:40:04.258026 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:40:04.272405 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c9e81c2-3687-4453-a685-cfbe4bcb3669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a0bb340>]}
2021-10-07 18:40:04.346233 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:40:04.348540 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:40:04.351864 (MainThread): 
2021-10-07 18:40:04.353212 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:40:04.355855 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:40:04.372061 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:40:04.372849 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:40:04.373381 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:40:04.378375 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:40:04.382082 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:40:04.388764 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:40:04.396796 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:40:04.397543 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:40:04.398629 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:40:04.402997 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:04.403533 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:40:04.403962 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:40:04.406642 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:40:04.418519 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:40:04.419457 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:40:04.429962 (MainThread): Using postgres connection "master".
2021-10-07 18:40:04.430674 (MainThread): On master: BEGIN
2021-10-07 18:40:04.431180 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:40:04.435311 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:04.435920 (MainThread): Using postgres connection "master".
2021-10-07 18:40:04.436420 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:40:04.442400 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:40:04.443676 (MainThread): On master: ROLLBACK
2021-10-07 18:40:04.445051 (MainThread): Using postgres connection "master".
2021-10-07 18:40:04.445924 (MainThread): On master: BEGIN
2021-10-07 18:40:04.447934 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:04.448914 (MainThread): On master: COMMIT
2021-10-07 18:40:04.449836 (MainThread): Using postgres connection "master".
2021-10-07 18:40:04.450764 (MainThread): On master: COMMIT
2021-10-07 18:40:04.452181 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:40:04.453256 (MainThread): On master: Close
2021-10-07 18:40:04.454712 (MainThread): 18:40:04 | Concurrency: 2 threads (target='dev')
2021-10-07 18:40:04.455693 (MainThread): 18:40:04 | 
2021-10-07 18:40:04.465234 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:40:04.468881 (Thread-1): 18:40:04 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:40:04.470330 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:40:04.471862 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:40:04.511891 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:40:04.551609 (Thread-1): finished collecting timing info
2021-10-07 18:40:04.596390 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:04.597094 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:40:04.597710 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:40:04.602073 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:40:04.605931 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:04.606605 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:40:04.607366 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:40:04.620562 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:40:04.632255 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:04.632910 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:40:04.633812 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:04.634333 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:04.634814 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn_verify2(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 18:40:04.636347 (Thread-1): Postgres error: function luhn_verify2(bigint) does not exist
LINE 19: WHERE luhn_verify2(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 18:40:04.636906 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:40:04.637944 (Thread-1): finished collecting timing info
2021-10-07 18:40:04.638750 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:40:04.639667 (Thread-1): Database Error in model task2 (models/task2.sql)
  function luhn_verify2(bigint) does not exist
  LINE 19: WHERE luhn_verify2(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn_verify2(bigint) does not exist
LINE 19: WHERE luhn_verify2(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn_verify2(bigint) does not exist
  LINE 19: WHERE luhn_verify2(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:40:04.642562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c9e81c2-3687-4453-a685-cfbe4bcb3669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a15e1c0>]}
2021-10-07 18:40:04.645045 (Thread-1): 18:40:04 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.17s]
2021-10-07 18:40:04.645893 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:40:04.649624 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:40:04.650580 (MainThread): Using postgres connection "master".
2021-10-07 18:40:04.651363 (MainThread): On master: BEGIN
2021-10-07 18:40:04.652076 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:40:04.658780 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:40:04.659670 (MainThread): On master: COMMIT
2021-10-07 18:40:04.660527 (MainThread): Using postgres connection "master".
2021-10-07 18:40:04.661179 (MainThread): On master: COMMIT
2021-10-07 18:40:04.662171 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:40:04.663101 (MainThread): On master: Close
2021-10-07 18:40:04.664686 (MainThread): 18:40:04 | 
2021-10-07 18:40:04.665523 (MainThread): 18:40:04 | Finished running 1 table model in 0.31s.
2021-10-07 18:40:04.666644 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:40:04.667869 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:40:04.728958 (MainThread): 
2021-10-07 18:40:04.729602 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:40:04.730447 (MainThread): 
2021-10-07 18:40:04.731261 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:40:04.733112 (MainThread):   function luhn_verify2(bigint) does not exist
2021-10-07 18:40:04.734166 (MainThread):   LINE 19: WHERE luhn_verify2(creditcard::int8) = FALSE
2021-10-07 18:40:04.735132 (MainThread):                  ^
2021-10-07 18:40:04.735983 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 18:40:04.737581 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:40:04.738527 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:40:04.739460 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a034c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a194100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f065a194910>]}
2021-10-07 18:40:04.740451 (MainThread): Flushing usage events
2021-10-07 18:40:47.483090 (MainThread): Running with dbt=0.19.0
2021-10-07 18:40:47.625742 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:40:47.631068 (MainThread): Tracking: tracking
2021-10-07 18:40:47.633376 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd86bd9be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8a1e1400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd86beb0d0>]}
2021-10-07 18:40:47.672590 (MainThread): Partial parsing not enabled
2021-10-07 18:40:47.680845 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:40:47.683579 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:40:47.709500 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:40:47.713014 (MainThread): Parsing macros/relations.sql
2021-10-07 18:40:47.715302 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:40:47.719076 (MainThread): Parsing macros/core.sql
2021-10-07 18:40:47.725347 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:40:47.780625 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:40:47.784438 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:40:47.787775 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:40:47.801986 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:40:47.807115 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:40:47.811062 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:40:47.814803 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:40:47.838303 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:40:47.895609 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:40:47.901221 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:40:47.966580 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:40:47.989625 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:40:47.998018 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:40:48.000633 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:40:48.017523 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:40:48.023696 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:40:48.031767 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:40:48.050100 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:40:48.055476 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:40:48.060485 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:40:48.066882 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:40:48.103387 (MainThread): Partial parsing not enabled
2021-10-07 18:40:48.208899 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:40:48.264594 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:40:48.332634 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:40:48.756262 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:40:48.762551 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da915d41-7c27-4f24-8bad-87677360d396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd86a35250>]}
2021-10-07 18:40:48.830525 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:40:48.833088 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:40:48.835094 (MainThread): 
2021-10-07 18:40:48.836944 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:40:48.840046 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:40:48.859646 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:40:48.860412 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:40:48.860964 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:40:48.867056 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:40:48.871443 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:40:48.877861 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:40:48.886396 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:40:48.887010 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:40:48.887473 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:40:48.891535 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:48.892052 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:40:48.892510 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:40:48.895025 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:40:48.906788 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:40:48.907610 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:40:48.917695 (MainThread): Using postgres connection "master".
2021-10-07 18:40:48.918542 (MainThread): On master: BEGIN
2021-10-07 18:40:48.918956 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:40:48.923131 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:48.923742 (MainThread): Using postgres connection "master".
2021-10-07 18:40:48.924326 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:40:48.929877 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:40:48.930632 (MainThread): On master: ROLLBACK
2021-10-07 18:40:48.931392 (MainThread): Using postgres connection "master".
2021-10-07 18:40:48.931805 (MainThread): On master: BEGIN
2021-10-07 18:40:48.932898 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:48.933383 (MainThread): On master: COMMIT
2021-10-07 18:40:48.933806 (MainThread): Using postgres connection "master".
2021-10-07 18:40:48.934399 (MainThread): On master: COMMIT
2021-10-07 18:40:48.935126 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:40:48.935613 (MainThread): On master: Close
2021-10-07 18:40:48.936565 (MainThread): 18:40:48 | Concurrency: 2 threads (target='dev')
2021-10-07 18:40:48.937041 (MainThread): 18:40:48 | 
2021-10-07 18:40:48.941350 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:40:48.943245 (Thread-1): 18:40:48 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:40:48.944031 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:40:48.944368 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:40:48.966389 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:40:48.978511 (Thread-1): finished collecting timing info
2021-10-07 18:40:49.008289 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:49.008878 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:40:49.009359 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:40:49.013406 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:40:49.016760 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:49.017296 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:40:49.018145 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:40:49.031032 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:40:49.044307 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:49.044827 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:40:49.045765 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:49.046532 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:40:49.047060 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn_verify2(creditcard::bigint) = FALSE
GROUP BY orderdate
  );
2021-10-07 18:40:49.048617 (Thread-1): Postgres error: function luhn_verify2(bigint) does not exist
LINE 19: WHERE luhn_verify2(creditcard::bigint) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 18:40:49.049278 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:40:49.050225 (Thread-1): finished collecting timing info
2021-10-07 18:40:49.050969 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:40:49.051873 (Thread-1): Database Error in model task2 (models/task2.sql)
  function luhn_verify2(bigint) does not exist
  LINE 19: WHERE luhn_verify2(creditcard::bigint) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn_verify2(bigint) does not exist
LINE 19: WHERE luhn_verify2(creditcard::bigint) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn_verify2(bigint) does not exist
  LINE 19: WHERE luhn_verify2(creditcard::bigint) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:40:49.054412 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da915d41-7c27-4f24-8bad-87677360d396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd869afd00>]}
2021-10-07 18:40:49.056282 (Thread-1): 18:40:49 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 18:40:49.056922 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:40:49.059275 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:40:49.059947 (MainThread): Using postgres connection "master".
2021-10-07 18:40:49.060578 (MainThread): On master: BEGIN
2021-10-07 18:40:49.061114 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:40:49.065538 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:40:49.066135 (MainThread): On master: COMMIT
2021-10-07 18:40:49.066615 (MainThread): Using postgres connection "master".
2021-10-07 18:40:49.067129 (MainThread): On master: COMMIT
2021-10-07 18:40:49.067967 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:40:49.068584 (MainThread): On master: Close
2021-10-07 18:40:49.069485 (MainThread): 18:40:49 | 
2021-10-07 18:40:49.070125 (MainThread): 18:40:49 | Finished running 1 table model in 0.23s.
2021-10-07 18:40:49.071018 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:40:49.071992 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:40:49.130108 (MainThread): 
2021-10-07 18:40:49.130597 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:40:49.131620 (MainThread): 
2021-10-07 18:40:49.132571 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:40:49.134000 (MainThread):   function luhn_verify2(bigint) does not exist
2021-10-07 18:40:49.135118 (MainThread):   LINE 19: WHERE luhn_verify2(creditcard::bigint) = FALSE
2021-10-07 18:40:49.136064 (MainThread):                  ^
2021-10-07 18:40:49.137284 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 18:40:49.138109 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:40:49.138827 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:40:49.139787 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd86986760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8610e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbd8610e6a0>]}
2021-10-07 18:40:49.140514 (MainThread): Flushing usage events
2021-10-07 18:47:22.223015 (MainThread): Running with dbt=0.19.0
2021-10-07 18:47:22.368645 (MainThread): running dbt with arguments Namespace(args='{creditcard: 5589148987143471}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_vrify2', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 18:47:22.373624 (MainThread): Tracking: tracking
2021-10-07 18:47:22.376180 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f892ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5fa3d7c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f89402e0>]}
2021-10-07 18:47:22.418326 (MainThread): Partial parsing not enabled
2021-10-07 18:47:22.426914 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:47:22.429521 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:47:22.457449 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:47:22.461317 (MainThread): Parsing macros/relations.sql
2021-10-07 18:47:22.463667 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:47:22.467569 (MainThread): Parsing macros/core.sql
2021-10-07 18:47:22.474085 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:47:22.532420 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:47:22.535821 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:47:22.538614 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:47:22.551440 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:47:22.554204 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:47:22.556400 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:47:22.558256 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:47:22.570682 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:47:22.599159 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:47:22.602122 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:47:22.646146 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:47:22.673344 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:47:22.683061 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:47:22.686862 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:47:22.706543 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:47:22.715773 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:47:22.727576 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:47:22.739215 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:47:22.742934 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:47:22.746161 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:47:22.749716 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:47:22.769057 (MainThread): Partial parsing not enabled
2021-10-07 18:47:22.846956 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:47:22.916664 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:47:22.984616 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:47:23.387878 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:47:23.396411 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22db7049-4b90-419d-8859-d60e60bcd653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f878a0d0>]}
2021-10-07 18:47:23.453987 (MainThread): Acquiring new postgres connection "macro_luhn_vrify2".
2021-10-07 18:47:23.454583 (MainThread): Using postgres connection "macro_luhn_vrify2".
2021-10-07 18:47:23.455154 (MainThread): On macro_luhn_vrify2: BEGIN
2021-10-07 18:47:23.455670 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:47:23.460764 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:47:23.461398 (MainThread): On macro_luhn_vrify2: COMMIT
2021-10-07 18:47:23.461873 (MainThread): Using postgres connection "macro_luhn_vrify2".
2021-10-07 18:47:23.462281 (MainThread): On macro_luhn_vrify2: COMMIT
2021-10-07 18:47:23.463055 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:47:23.463594 (MainThread): On macro_luhn_vrify2: Close
2021-10-07 18:47:23.464709 (MainThread): Encountered an error while running operation: Runtime Error
  dbt could not find a macro with the name "luhn_vrify2" in any package
2021-10-07 18:47:23.465177 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 984, in execute_macro
    raise RuntimeException(
dbt.exceptions.RuntimeException: Runtime Error
  dbt could not find a macro with the name "luhn_vrify2" in any package
2021-10-07 18:47:23.466859 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f892ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f86d8c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc5f86d8cd0>]}
2021-10-07 18:47:23.467532 (MainThread): Flushing usage events
2021-10-07 18:47:24.075018 (MainThread): Connection 'macro_luhn_vrify2' was properly closed.
2021-10-07 18:47:38.596414 (MainThread): Running with dbt=0.19.0
2021-10-07 18:47:38.726746 (MainThread): running dbt with arguments Namespace(args='{creditcard: 5589148987143471}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify2', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 18:47:38.731970 (MainThread): Tracking: tracking
2021-10-07 18:47:38.735369 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1bddadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1d881d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1bdeb460>]}
2021-10-07 18:47:38.777446 (MainThread): Partial parsing not enabled
2021-10-07 18:47:38.786947 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:47:38.789762 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:47:38.824236 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:47:38.828109 (MainThread): Parsing macros/relations.sql
2021-10-07 18:47:38.830498 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:47:38.834817 (MainThread): Parsing macros/core.sql
2021-10-07 18:47:38.841163 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:47:38.905042 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:47:38.908423 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:47:38.911252 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:47:38.924784 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:47:38.927666 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:47:38.929687 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:47:38.931562 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:47:38.945498 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:47:38.975297 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:47:38.978788 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:47:39.032136 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:47:39.073850 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:47:39.090517 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:47:39.096465 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:47:39.132919 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:47:39.145681 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:47:39.157326 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:47:39.167134 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:47:39.170567 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:47:39.176828 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:47:39.180490 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:47:39.198422 (MainThread): Partial parsing not enabled
2021-10-07 18:47:39.260715 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:47:39.302523 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:47:39.339332 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:47:39.620813 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:47:39.627983 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '692ca14d-4c7c-40e4-a4f9-b9ea9da794d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1bc35340>]}
2021-10-07 18:47:39.679691 (MainThread): Acquiring new postgres connection "macro_luhn_verify2".
2021-10-07 18:47:39.680270 (MainThread): Using postgres connection "macro_luhn_verify2".
2021-10-07 18:47:39.680747 (MainThread): On macro_luhn_verify2: BEGIN
2021-10-07 18:47:39.681252 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:47:39.686247 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:47:39.686777 (MainThread): On macro_luhn_verify2: COMMIT
2021-10-07 18:47:39.687265 (MainThread): Using postgres connection "macro_luhn_verify2".
2021-10-07 18:47:39.687781 (MainThread): On macro_luhn_verify2: COMMIT
2021-10-07 18:47:39.688527 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:47:39.691577 (MainThread): On macro_luhn_verify2: Close
2021-10-07 18:47:39.692553 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1bddadc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1bb9bd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba1bb9bd90>]}
2021-10-07 18:47:39.693131 (MainThread): Flushing usage events
2021-10-07 18:47:40.273850 (MainThread): Connection 'macro_luhn_verify2' was properly closed.
2021-10-07 18:48:34.532230 (MainThread): Running with dbt=0.19.0
2021-10-07 18:48:34.714749 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:48:34.721306 (MainThread): Tracking: tracking
2021-10-07 18:48:34.723874 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9fdeb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2aa1896310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9fdfc1c0>]}
2021-10-07 18:48:34.764469 (MainThread): Partial parsing not enabled
2021-10-07 18:48:34.772988 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:48:34.775787 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:48:34.803161 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:48:34.807171 (MainThread): Parsing macros/relations.sql
2021-10-07 18:48:34.809572 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:48:34.813715 (MainThread): Parsing macros/core.sql
2021-10-07 18:48:34.819903 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:48:34.927327 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:48:34.931886 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:48:34.935549 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:48:34.947868 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:48:34.950542 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:48:34.952389 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:48:34.954088 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:48:34.968244 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:48:34.995110 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:48:34.997767 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:48:35.032940 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:48:35.054956 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:48:35.062705 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:48:35.069469 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:48:35.087368 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:48:35.093920 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:48:35.101541 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:48:35.110069 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:48:35.114601 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:48:35.118072 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:48:35.121768 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:48:35.150709 (MainThread): Partial parsing not enabled
2021-10-07 18:48:35.226092 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:48:35.266555 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:48:35.271396 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9fdb18b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9fc23880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2a9fc1eee0>]}
2021-10-07 18:48:35.272210 (MainThread): Flushing usage events
2021-10-07 18:48:35.941486 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:48:35.944919 (MainThread): Encountered an error:
2021-10-07 18:48:35.947247 (MainThread): Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify2(creditcard::bigint) }} = FALSE
2021-10-07 18:48:35.959741 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 16, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 16
    WHERE {{ luhn_verify2(creditcard::bigint) }} = FALSE

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify2(creditcard::bigint) }} = FALSE

2021-10-07 18:49:59.891366 (MainThread): Running with dbt=0.19.0
2021-10-07 18:50:00.019589 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:50:00.025612 (MainThread): Tracking: tracking
2021-10-07 18:50:00.027907 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c8724940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4cbd2a460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c8734130>]}
2021-10-07 18:50:00.072073 (MainThread): Partial parsing not enabled
2021-10-07 18:50:00.081171 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:50:00.083651 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:50:00.109723 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:50:00.113375 (MainThread): Parsing macros/relations.sql
2021-10-07 18:50:00.116083 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:50:00.119574 (MainThread): Parsing macros/core.sql
2021-10-07 18:50:00.125555 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:50:00.211511 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:50:00.218029 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:50:00.223307 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:50:00.249499 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:50:00.255077 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:50:00.258680 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:50:00.261956 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:50:00.288036 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:50:00.332279 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:50:00.335544 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:50:00.370394 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:50:00.396509 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:50:00.406310 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:50:00.409664 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:50:00.429661 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:50:00.436563 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:50:00.446175 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:50:00.455174 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:50:00.457860 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:50:00.460335 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:50:00.463317 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:50:00.481606 (MainThread): Partial parsing not enabled
2021-10-07 18:50:00.540781 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:50:00.587819 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:50:00.653964 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:50:00.982620 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:50:00.991264 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '117a87b7-b3fc-4628-81d5-9fbd82e67e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c8579760>]}
2021-10-07 18:50:01.064383 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:50:01.066618 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:50:01.068336 (MainThread): 
2021-10-07 18:50:01.069642 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:50:01.072468 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:50:01.089324 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:50:01.090156 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:50:01.090862 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:50:01.096201 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:50:01.100080 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:50:01.106711 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:50:01.114801 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:50:01.115714 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:50:01.116343 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:50:01.121450 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:50:01.121985 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:50:01.122365 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:50:01.125186 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:50:01.139808 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:50:01.140896 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:50:01.153180 (MainThread): Using postgres connection "master".
2021-10-07 18:50:01.153870 (MainThread): On master: BEGIN
2021-10-07 18:50:01.154346 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:50:01.159269 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:50:01.159838 (MainThread): Using postgres connection "master".
2021-10-07 18:50:01.160243 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:50:01.166860 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:50:01.167626 (MainThread): On master: ROLLBACK
2021-10-07 18:50:01.168392 (MainThread): Using postgres connection "master".
2021-10-07 18:50:01.168832 (MainThread): On master: BEGIN
2021-10-07 18:50:01.169764 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:50:01.170274 (MainThread): On master: COMMIT
2021-10-07 18:50:01.170652 (MainThread): Using postgres connection "master".
2021-10-07 18:50:01.171083 (MainThread): On master: COMMIT
2021-10-07 18:50:01.172142 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:50:01.172663 (MainThread): On master: Close
2021-10-07 18:50:01.173511 (MainThread): 18:50:01 | Concurrency: 2 threads (target='dev')
2021-10-07 18:50:01.174074 (MainThread): 18:50:01 | 
2021-10-07 18:50:01.178462 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:50:01.180269 (Thread-1): 18:50:01 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:50:01.181171 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:50:01.181877 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:50:01.209071 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:50:01.385486 (Thread-1): finished collecting timing info
2021-10-07 18:50:01.427397 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:50:01.428044 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:50:01.428599 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:50:01.432985 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:50:01.436102 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:50:01.436571 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:50:01.437222 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:50:01.453266 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:50:01.462491 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:50:01.462908 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:50:01.463708 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:50:01.464275 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:50:01.464671 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::creditcard/ (10^n)::creditcard ), 10::creditcard)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:50:01.465676 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^

2021-10-07 18:50:01.466175 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:50:01.467312 (Thread-1): finished collecting timing info
2021-10-07 18:50:01.468089 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:50:01.469179 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:50:01.471866 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '117a87b7-b3fc-4628-81d5-9fbd82e67e48', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c865cb80>]}
2021-10-07 18:50:01.474229 (Thread-1): 18:50:01 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.29s]
2021-10-07 18:50:01.475065 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:50:01.477678 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:50:01.478232 (MainThread): Using postgres connection "master".
2021-10-07 18:50:01.478737 (MainThread): On master: BEGIN
2021-10-07 18:50:01.479155 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:50:01.483245 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:50:01.483775 (MainThread): On master: COMMIT
2021-10-07 18:50:01.484222 (MainThread): Using postgres connection "master".
2021-10-07 18:50:01.484562 (MainThread): On master: COMMIT
2021-10-07 18:50:01.485309 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:50:01.486105 (MainThread): On master: Close
2021-10-07 18:50:01.487276 (MainThread): 18:50:01 | 
2021-10-07 18:50:01.487879 (MainThread): 18:50:01 | Finished running 1 table model in 0.42s.
2021-10-07 18:50:01.488652 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:50:01.489375 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:50:01.542707 (MainThread): 
2021-10-07 18:50:01.545018 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:50:01.545649 (MainThread): 
2021-10-07 18:50:01.546246 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:50:01.547122 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:50:01.549083 (MainThread):   LINE 20:     SELECT
2021-10-07 18:50:01.550847 (MainThread):                ^
2021-10-07 18:50:01.551723 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:50:01.552846 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:50:01.553971 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c84f7310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c8507d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff4c7c84ee0>]}
2021-10-07 18:50:01.555797 (MainThread): Flushing usage events
2021-10-07 18:51:00.497742 (MainThread): Running with dbt=0.19.0
2021-10-07 18:51:00.664069 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:51:00.673467 (MainThread): Tracking: tracking
2021-10-07 18:51:00.677799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc7f4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dfdf9400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc8030d0>]}
2021-10-07 18:51:00.735362 (MainThread): Partial parsing not enabled
2021-10-07 18:51:00.744406 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:51:00.746910 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:51:00.772264 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:51:00.776473 (MainThread): Parsing macros/relations.sql
2021-10-07 18:51:00.778710 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:51:00.781983 (MainThread): Parsing macros/core.sql
2021-10-07 18:51:00.787668 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:51:00.843996 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:51:00.847330 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:51:00.849886 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:51:00.860741 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:51:00.863372 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:51:00.865334 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:51:00.866979 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:51:00.878466 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:51:00.908549 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:51:00.911857 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:51:00.961928 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:51:01.004019 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:51:01.022094 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:51:01.028009 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:51:01.063124 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:51:01.075076 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:51:01.091424 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:51:01.108924 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:51:01.114733 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:51:01.119590 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:51:01.125854 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:51:01.161705 (MainThread): Partial parsing not enabled
2021-10-07 18:51:01.271947 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:51:01.334025 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:51:01.402406 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:51:01.890238 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:51:01.904449 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ec2eb475-223e-4ead-b0a1-ee18b3b2dad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc6497f0>]}
2021-10-07 18:51:01.984732 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:51:01.988228 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:51:01.991074 (MainThread): 
2021-10-07 18:51:01.992608 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:51:01.998446 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:51:02.019117 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:51:02.020057 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:51:02.020661 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:51:02.027043 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:51:02.031132 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:51:02.040059 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:51:02.051741 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:51:02.052396 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:51:02.053089 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:51:02.058188 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:51:02.058908 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:51:02.059574 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:51:02.062856 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:51:02.078291 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:51:02.079518 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:51:02.093133 (MainThread): Using postgres connection "master".
2021-10-07 18:51:02.093864 (MainThread): On master: BEGIN
2021-10-07 18:51:02.094557 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:51:02.099848 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:51:02.100596 (MainThread): Using postgres connection "master".
2021-10-07 18:51:02.101262 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:51:02.108390 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:51:02.109582 (MainThread): On master: ROLLBACK
2021-10-07 18:51:02.110563 (MainThread): Using postgres connection "master".
2021-10-07 18:51:02.111325 (MainThread): On master: BEGIN
2021-10-07 18:51:02.112876 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:51:02.113501 (MainThread): On master: COMMIT
2021-10-07 18:51:02.114269 (MainThread): Using postgres connection "master".
2021-10-07 18:51:02.114820 (MainThread): On master: COMMIT
2021-10-07 18:51:02.115978 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:51:02.116831 (MainThread): On master: Close
2021-10-07 18:51:02.118240 (MainThread): 18:51:02 | Concurrency: 2 threads (target='dev')
2021-10-07 18:51:02.119162 (MainThread): 18:51:02 | 
2021-10-07 18:51:02.125938 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:51:02.129504 (Thread-1): 18:51:02 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:51:02.130935 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:51:02.131923 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:51:02.160920 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:51:02.173418 (Thread-1): finished collecting timing info
2021-10-07 18:51:02.203862 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:51:02.204516 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:51:02.205053 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:51:02.209238 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:51:02.212412 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:51:02.213017 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:51:02.213770 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:51:02.226716 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:51:02.240439 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:51:02.241071 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:51:02.242035 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:51:02.242610 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:51:02.243182 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:51:02.244241 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^

2021-10-07 18:51:02.244862 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:51:02.245811 (Thread-1): finished collecting timing info
2021-10-07 18:51:02.246536 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:51:02.247463 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:51:02.250016 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ec2eb475-223e-4ead-b0a1-ee18b3b2dad8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc63aac0>]}
2021-10-07 18:51:02.251886 (Thread-1): 18:51:02 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.12s]
2021-10-07 18:51:02.252562 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:51:02.254941 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:51:02.255642 (MainThread): Using postgres connection "master".
2021-10-07 18:51:02.256126 (MainThread): On master: BEGIN
2021-10-07 18:51:02.256699 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:51:02.261227 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:51:02.261924 (MainThread): On master: COMMIT
2021-10-07 18:51:02.262528 (MainThread): Using postgres connection "master".
2021-10-07 18:51:02.263116 (MainThread): On master: COMMIT
2021-10-07 18:51:02.264178 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:51:02.264855 (MainThread): On master: Close
2021-10-07 18:51:02.265975 (MainThread): 18:51:02 | 
2021-10-07 18:51:02.266584 (MainThread): 18:51:02 | Finished running 1 table model in 0.27s.
2021-10-07 18:51:02.267460 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:51:02.268192 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:51:02.327333 (MainThread): 
2021-10-07 18:51:02.327997 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:51:02.328553 (MainThread): 
2021-10-07 18:51:02.329029 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:51:02.329762 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:51:02.330662 (MainThread):   LINE 20:     SELECT
2021-10-07 18:51:02.332446 (MainThread):                ^
2021-10-07 18:51:02.333336 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:51:02.334294 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:51:02.335409 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc5be5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc5d7d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60dc698640>]}
2021-10-07 18:51:02.336436 (MainThread): Flushing usage events
2021-10-07 18:53:17.401785 (MainThread): Running with dbt=0.19.0
2021-10-07 18:53:17.540852 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:53:17.546890 (MainThread): Tracking: tracking
2021-10-07 18:53:17.549131 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14571cfa30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1458c7a1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14571e1220>]}
2021-10-07 18:53:17.592468 (MainThread): Partial parsing not enabled
2021-10-07 18:53:17.601332 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:53:17.604358 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:53:17.630502 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:53:17.634314 (MainThread): Parsing macros/relations.sql
2021-10-07 18:53:17.636605 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:53:17.640059 (MainThread): Parsing macros/core.sql
2021-10-07 18:53:17.646096 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:53:17.759403 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:53:17.766021 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:53:17.771270 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:53:17.796645 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:53:17.801738 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:53:17.805732 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:53:17.808982 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:53:17.854420 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:53:17.899825 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:53:17.903735 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:53:17.941127 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:53:17.980274 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:53:17.989807 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:53:17.992840 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:53:18.010453 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:53:18.018463 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:53:18.028814 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:53:18.039363 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:53:18.042307 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:53:18.045749 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:53:18.048882 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:53:18.069290 (MainThread): Partial parsing not enabled
2021-10-07 18:53:18.125413 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:53:18.191478 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:53:18.270597 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:53:18.728934 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:53:18.742633 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a0ac9d3-392a-4478-ba93-41b631af6ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1457028760>]}
2021-10-07 18:53:18.814226 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:53:18.816553 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:53:18.818886 (MainThread): 
2021-10-07 18:53:18.819995 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:53:18.822917 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:53:18.839950 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:53:18.840726 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:53:18.841242 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:53:18.846216 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-07 18:53:18.850013 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:53:18.857282 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:53:18.866302 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:53:18.866879 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:53:18.867299 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:53:18.871554 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:18.872225 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:53:18.872644 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:53:18.875703 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:53:18.889877 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:53:18.890668 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:53:18.901640 (MainThread): Using postgres connection "master".
2021-10-07 18:53:18.902195 (MainThread): On master: BEGIN
2021-10-07 18:53:18.902737 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:53:18.906942 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:18.907517 (MainThread): Using postgres connection "master".
2021-10-07 18:53:18.907940 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:53:18.913905 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:53:18.914759 (MainThread): On master: ROLLBACK
2021-10-07 18:53:18.915539 (MainThread): Using postgres connection "master".
2021-10-07 18:53:18.916095 (MainThread): On master: BEGIN
2021-10-07 18:53:18.917289 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:18.917786 (MainThread): On master: COMMIT
2021-10-07 18:53:18.918316 (MainThread): Using postgres connection "master".
2021-10-07 18:53:18.918791 (MainThread): On master: COMMIT
2021-10-07 18:53:18.919547 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:53:18.920034 (MainThread): On master: Close
2021-10-07 18:53:18.920832 (MainThread): 18:53:18 | Concurrency: 2 threads (target='dev')
2021-10-07 18:53:18.921346 (MainThread): 18:53:18 | 
2021-10-07 18:53:18.942576 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:53:18.944656 (Thread-1): 18:53:18 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:53:18.945521 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:53:18.945983 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:53:18.969798 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:53:18.983796 (Thread-1): finished collecting timing info
2021-10-07 18:53:19.013362 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:19.014008 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:53:19.014512 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:53:19.018942 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:53:19.022363 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:19.022940 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:53:19.023758 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:53:19.038132 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:53:19.069780 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:19.070759 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:53:19.072311 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:19.073134 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:19.073878 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:53:19.075430 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^

2021-10-07 18:53:19.076197 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:53:19.077503 (Thread-1): finished collecting timing info
2021-10-07 18:53:19.078676 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:53:19.080130 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 20:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:53:19.084646 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3a0ac9d3-392a-4478-ba93-41b631af6ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1457075df0>]}
2021-10-07 18:53:19.088048 (Thread-1): 18:53:19 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.14s]
2021-10-07 18:53:19.088989 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:53:19.094758 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:53:19.095596 (MainThread): Using postgres connection "master".
2021-10-07 18:53:19.096391 (MainThread): On master: BEGIN
2021-10-07 18:53:19.097885 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:53:19.106406 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:53:19.107478 (MainThread): On master: COMMIT
2021-10-07 18:53:19.108255 (MainThread): Using postgres connection "master".
2021-10-07 18:53:19.109115 (MainThread): On master: COMMIT
2021-10-07 18:53:19.110785 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:53:19.111908 (MainThread): On master: Close
2021-10-07 18:53:19.113888 (MainThread): 18:53:19 | 
2021-10-07 18:53:19.115062 (MainThread): 18:53:19 | Finished running 1 table model in 0.29s.
2021-10-07 18:53:19.117212 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:53:19.119362 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:53:19.182736 (MainThread): 
2021-10-07 18:53:19.183289 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:53:19.184137 (MainThread): 
2021-10-07 18:53:19.185626 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:53:19.186788 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:53:19.188735 (MainThread):   LINE 20:     SELECT
2021-10-07 18:53:19.189978 (MainThread):                ^
2021-10-07 18:53:19.190835 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:53:19.191667 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:53:19.192599 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14571347c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1456fb4220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f14566f60d0>]}
2021-10-07 18:53:19.193373 (MainThread): Flushing usage events
2021-10-07 18:53:36.693325 (MainThread): Running with dbt=0.19.0
2021-10-07 18:53:36.828934 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:53:36.835091 (MainThread): Tracking: tracking
2021-10-07 18:53:36.837330 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f2763910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f5d6a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f2774100>]}
2021-10-07 18:53:36.879534 (MainThread): Partial parsing not enabled
2021-10-07 18:53:36.899511 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:53:36.905589 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:53:36.952070 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:53:36.959380 (MainThread): Parsing macros/relations.sql
2021-10-07 18:53:36.964319 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:53:36.972174 (MainThread): Parsing macros/core.sql
2021-10-07 18:53:36.984167 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:53:37.055656 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:53:37.058774 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:53:37.061269 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:53:37.073691 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:53:37.076772 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:53:37.079088 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:53:37.081088 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:53:37.095350 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:53:37.130341 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:53:37.134864 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:53:37.187773 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:53:37.227516 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:53:37.246009 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:53:37.251771 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:53:37.280217 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:53:37.288597 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:53:37.299116 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:53:37.309738 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:53:37.313104 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:53:37.315797 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:53:37.318991 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:53:37.338037 (MainThread): Partial parsing not enabled
2021-10-07 18:53:37.392872 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:53:37.430031 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:53:37.478352 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:53:37.921926 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:53:37.934507 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20867c24-d445-407c-b925-7438be5472ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f25bc730>]}
2021-10-07 18:53:38.011785 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:53:38.013924 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:53:38.015431 (MainThread): 
2021-10-07 18:53:38.017027 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:53:38.019588 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:53:38.034710 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:53:38.035366 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:53:38.035872 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:53:38.041209 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:53:38.047612 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:53:38.058679 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:53:38.072045 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:53:38.073054 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:53:38.073735 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:53:38.079082 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:53:38.079779 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:53:38.080381 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:53:38.083996 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:53:38.098918 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:53:38.099992 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:53:38.112891 (MainThread): Using postgres connection "master".
2021-10-07 18:53:38.113505 (MainThread): On master: BEGIN
2021-10-07 18:53:38.114034 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:53:38.120015 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:53:38.120795 (MainThread): Using postgres connection "master".
2021-10-07 18:53:38.121727 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:53:38.131224 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:53:38.132459 (MainThread): On master: ROLLBACK
2021-10-07 18:53:38.133704 (MainThread): Using postgres connection "master".
2021-10-07 18:53:38.134550 (MainThread): On master: BEGIN
2021-10-07 18:53:38.136362 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:38.137134 (MainThread): On master: COMMIT
2021-10-07 18:53:38.137946 (MainThread): Using postgres connection "master".
2021-10-07 18:53:38.138729 (MainThread): On master: COMMIT
2021-10-07 18:53:38.139932 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:53:38.140733 (MainThread): On master: Close
2021-10-07 18:53:38.142048 (MainThread): 18:53:38 | Concurrency: 2 threads (target='dev')
2021-10-07 18:53:38.142989 (MainThread): 18:53:38 | 
2021-10-07 18:53:38.152520 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:53:38.156238 (Thread-1): 18:53:38 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:53:38.157718 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:53:38.160357 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:53:38.200036 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:53:38.213081 (Thread-1): finished collecting timing info
2021-10-07 18:53:38.259892 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:38.260636 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:53:38.261064 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:53:38.265451 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:53:38.269498 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:38.270092 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:53:38.270953 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:53:38.287033 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:53:38.313400 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:38.313779 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:53:38.314437 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:38.314869 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:53:38.315227 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    SELECT MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:53:38.315958 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 20:     SELECT MOD(SUM(doubled_digit / INT8 '10' + doubled_digit...
             ^

2021-10-07 18:53:38.316346 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:53:38.316991 (Thread-1): finished collecting timing info
2021-10-07 18:53:38.317627 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:53:38.318357 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT MOD(SUM(doubled_digit / INT8 '10' + doubled_digit...
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 20:     SELECT MOD(SUM(doubled_digit / INT8 '10' + doubled_digit...
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 20:     SELECT MOD(SUM(doubled_digit / INT8 '10' + doubled_digit...
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:53:38.320625 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '20867c24-d445-407c-b925-7438be5472ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f2527c40>]}
2021-10-07 18:53:38.322465 (Thread-1): 18:53:38 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.16s]
2021-10-07 18:53:38.323120 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:53:38.325438 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:53:38.325920 (MainThread): Using postgres connection "master".
2021-10-07 18:53:38.326227 (MainThread): On master: BEGIN
2021-10-07 18:53:38.326527 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:53:38.330243 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:53:38.330773 (MainThread): On master: COMMIT
2021-10-07 18:53:38.331184 (MainThread): Using postgres connection "master".
2021-10-07 18:53:38.331509 (MainThread): On master: COMMIT
2021-10-07 18:53:38.332252 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:53:38.332686 (MainThread): On master: Close
2021-10-07 18:53:38.335302 (MainThread): 18:53:38 | 
2021-10-07 18:53:38.335960 (MainThread): 18:53:38 | Finished running 1 table model in 0.32s.
2021-10-07 18:53:38.337014 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:53:38.338498 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:53:38.397503 (MainThread): 
2021-10-07 18:53:38.398009 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:53:38.400959 (MainThread): 
2021-10-07 18:53:38.402024 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:53:38.403290 (MainThread):   syntax error at or near "SELECT"
2021-10-07 18:53:38.404076 (MainThread):   LINE 20:     SELECT MOD(SUM(doubled_digit / INT8 '10' + doubled_digit...
2021-10-07 18:53:38.405185 (MainThread):                ^
2021-10-07 18:53:38.405992 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:53:38.406870 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:53:38.408006 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f2527c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f26bd760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff8f250be50>]}
2021-10-07 18:53:38.408891 (MainThread): Flushing usage events
2021-10-07 18:57:01.863420 (MainThread): Running with dbt=0.19.0
2021-10-07 18:57:02.002155 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:57:02.012430 (MainThread): Tracking: tracking
2021-10-07 18:57:02.017555 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e7036910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6ea63d430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e7048100>]}
2021-10-07 18:57:02.080499 (MainThread): Partial parsing not enabled
2021-10-07 18:57:02.091135 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:57:02.094359 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:57:02.122663 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:57:02.126448 (MainThread): Parsing macros/relations.sql
2021-10-07 18:57:02.128724 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:57:02.132943 (MainThread): Parsing macros/core.sql
2021-10-07 18:57:02.138631 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:57:02.194030 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:57:02.197489 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:57:02.200446 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:57:02.213320 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:57:02.216076 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:57:02.217828 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:57:02.219374 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:57:02.233107 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:57:02.260622 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:57:02.263485 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:57:02.298283 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:57:02.335532 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:57:02.350568 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:57:02.356046 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:57:02.394129 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:57:02.408633 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:57:02.426697 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:57:02.446126 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:57:02.451621 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:57:02.456690 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:57:02.462583 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:57:02.500070 (MainThread): Partial parsing not enabled
2021-10-07 18:57:02.615003 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:57:02.678853 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:57:02.717809 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:57:03.210788 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:57:03.216875 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd30118c3-e816-454c-a556-3ed1a75f18de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6e8f610>]}
2021-10-07 18:57:03.277751 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:57:03.279908 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:57:03.281538 (MainThread): 
2021-10-07 18:57:03.282464 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:57:03.285560 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:57:03.302366 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:57:03.303131 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:57:03.304161 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:57:03.310493 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:57:03.314501 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:57:03.322224 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:57:03.331507 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:57:03.332227 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:57:03.332653 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:57:03.337901 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:57:03.338585 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:57:03.339118 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:57:03.342233 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:57:03.356747 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:57:03.357861 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:57:03.370821 (MainThread): Using postgres connection "master".
2021-10-07 18:57:03.371747 (MainThread): On master: BEGIN
2021-10-07 18:57:03.372299 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:57:03.377303 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:57:03.377984 (MainThread): Using postgres connection "master".
2021-10-07 18:57:03.378623 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:57:03.385282 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:57:03.386267 (MainThread): On master: ROLLBACK
2021-10-07 18:57:03.387225 (MainThread): Using postgres connection "master".
2021-10-07 18:57:03.387801 (MainThread): On master: BEGIN
2021-10-07 18:57:03.389129 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:03.389724 (MainThread): On master: COMMIT
2021-10-07 18:57:03.390318 (MainThread): Using postgres connection "master".
2021-10-07 18:57:03.391023 (MainThread): On master: COMMIT
2021-10-07 18:57:03.392138 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:57:03.392758 (MainThread): On master: Close
2021-10-07 18:57:03.394164 (MainThread): 18:57:03 | Concurrency: 2 threads (target='dev')
2021-10-07 18:57:03.395170 (MainThread): 18:57:03 | 
2021-10-07 18:57:03.403972 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:57:03.408226 (Thread-1): 18:57:03 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:57:03.410121 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:57:03.411281 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:57:03.446314 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:57:03.469673 (Thread-1): finished collecting timing info
2021-10-07 18:57:03.516495 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:03.517192 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:57:03.517657 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:57:03.522055 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:57:03.525775 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:03.526373 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:57:03.527133 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:57:03.541441 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:57:03.552016 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:03.552386 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:57:03.553075 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:03.553535 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:03.554035 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    doubled_digits = MOD( ( $1::::int8/ (10^n)::::int8 ), 10::::int8) * (MOD(n,2) + 1)
    MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:57:03.555204 (Thread-1): Postgres error: syntax error at or near "::"
LINE 20:     doubled_digits = MOD( ( $1::::int8/ (10^n)::::int8 ), 10...
                                         ^

2021-10-07 18:57:03.555733 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:57:03.556581 (Thread-1): finished collecting timing info
2021-10-07 18:57:03.557279 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:57:03.558177 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "::"
  LINE 20:     doubled_digits = MOD( ( $1::::int8/ (10^n)::::int8 ), 10...
                                           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "::"
LINE 20:     doubled_digits = MOD( ( $1::::int8/ (10^n)::::int8 ), 10...
                                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "::"
  LINE 20:     doubled_digits = MOD( ( $1::::int8/ (10^n)::::int8 ), 10...
                                           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:57:03.560550 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd30118c3-e816-454c-a556-3ed1a75f18de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6f714c0>]}
2021-10-07 18:57:03.562307 (Thread-1): 18:57:03 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.15s]
2021-10-07 18:57:03.562953 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:57:03.565230 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:57:03.566198 (MainThread): Using postgres connection "master".
2021-10-07 18:57:03.566806 (MainThread): On master: BEGIN
2021-10-07 18:57:03.567471 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:57:03.571870 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:03.572475 (MainThread): On master: COMMIT
2021-10-07 18:57:03.572920 (MainThread): Using postgres connection "master".
2021-10-07 18:57:03.573414 (MainThread): On master: COMMIT
2021-10-07 18:57:03.574098 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:57:03.574649 (MainThread): On master: Close
2021-10-07 18:57:03.575458 (MainThread): 18:57:03 | 
2021-10-07 18:57:03.575968 (MainThread): 18:57:03 | Finished running 1 table model in 0.29s.
2021-10-07 18:57:03.576464 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:57:03.576825 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:57:03.633311 (MainThread): 
2021-10-07 18:57:03.634014 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:57:03.635130 (MainThread): 
2021-10-07 18:57:03.636003 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:57:03.637499 (MainThread):   syntax error at or near "::"
2021-10-07 18:57:03.638396 (MainThread):   LINE 20:     doubled_digits = MOD( ( $1::::int8/ (10^n)::::int8 ), 10...
2021-10-07 18:57:03.639338 (MainThread):                                            ^
2021-10-07 18:57:03.640137 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:57:03.640941 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:57:03.641867 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6f83760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6ddde50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6e6f714c0>]}
2021-10-07 18:57:03.642644 (MainThread): Flushing usage events
2021-10-07 18:57:18.620701 (MainThread): Running with dbt=0.19.0
2021-10-07 18:57:18.818421 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:57:18.827827 (MainThread): Tracking: tracking
2021-10-07 18:57:18.832207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed75ca00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aef207370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed76d1f0>]}
2021-10-07 18:57:18.898036 (MainThread): Partial parsing not enabled
2021-10-07 18:57:18.913697 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:57:18.916942 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:57:18.942769 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:57:18.946952 (MainThread): Parsing macros/relations.sql
2021-10-07 18:57:18.949164 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:57:18.952593 (MainThread): Parsing macros/core.sql
2021-10-07 18:57:18.958398 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:57:19.015907 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:57:19.019492 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:57:19.023064 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:57:19.037255 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:57:19.040521 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:57:19.043012 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:57:19.045491 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:57:19.065168 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:57:19.097700 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:57:19.100731 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:57:19.139261 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:57:19.171409 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:57:19.189239 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:57:19.195598 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:57:19.233757 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:57:19.249030 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:57:19.268024 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:57:19.287513 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:57:19.293746 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:57:19.299026 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:57:19.305284 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:57:19.332405 (MainThread): Partial parsing not enabled
2021-10-07 18:57:19.429295 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:57:19.497827 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:57:19.548245 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:57:19.870662 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:57:19.878917 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb1f1e2c-fb6b-42f0-8249-40bbf59cb802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed5b37c0>]}
2021-10-07 18:57:19.949443 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:57:19.951465 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:57:19.953165 (MainThread): 
2021-10-07 18:57:19.954134 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:57:19.957170 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:57:19.974412 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:57:19.975043 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:57:19.975659 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:57:19.980680 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:57:19.984703 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:57:19.991794 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:57:20.000074 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:57:20.000669 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:57:20.001047 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:57:20.005628 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:20.006226 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:57:20.006646 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:57:20.009388 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:57:20.022731 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:57:20.023698 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:57:20.034390 (MainThread): Using postgres connection "master".
2021-10-07 18:57:20.034996 (MainThread): On master: BEGIN
2021-10-07 18:57:20.035484 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:57:20.039963 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:20.040673 (MainThread): Using postgres connection "master".
2021-10-07 18:57:20.041516 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:57:20.047334 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:57:20.048149 (MainThread): On master: ROLLBACK
2021-10-07 18:57:20.049043 (MainThread): Using postgres connection "master".
2021-10-07 18:57:20.049587 (MainThread): On master: BEGIN
2021-10-07 18:57:20.050837 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:20.051475 (MainThread): On master: COMMIT
2021-10-07 18:57:20.052053 (MainThread): Using postgres connection "master".
2021-10-07 18:57:20.052461 (MainThread): On master: COMMIT
2021-10-07 18:57:20.053200 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:57:20.053728 (MainThread): On master: Close
2021-10-07 18:57:20.054579 (MainThread): 18:57:20 | Concurrency: 2 threads (target='dev')
2021-10-07 18:57:20.055229 (MainThread): 18:57:20 | 
2021-10-07 18:57:20.060510 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:57:20.062719 (Thread-1): 18:57:20 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:57:20.063645 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:57:20.064181 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:57:20.089470 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:57:20.098342 (Thread-1): finished collecting timing info
2021-10-07 18:57:20.132024 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:20.133490 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:57:20.134016 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:57:20.138103 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:57:20.141316 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:20.141826 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:57:20.142520 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:57:20.158451 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:57:20.169070 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:20.169601 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:57:20.170309 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:20.170643 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:20.170926 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    doubled_digits = MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1)
    MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:57:20.171706 (Thread-1): Postgres error: syntax error at or near "MOD"
LINE 21:     MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8...
             ^

2021-10-07 18:57:20.172083 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:57:20.172726 (Thread-1): finished collecting timing info
2021-10-07 18:57:20.173578 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:57:20.174540 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "MOD"
  LINE 21:     MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8...
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "MOD"
LINE 21:     MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8...
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "MOD"
  LINE 21:     MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8...
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:57:20.177497 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'eb1f1e2c-fb6b-42f0-8249-40bbf59cb802', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed780e50>]}
2021-10-07 18:57:20.179558 (Thread-1): 18:57:20 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 18:57:20.180252 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:57:20.183172 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:57:20.183734 (MainThread): Using postgres connection "master".
2021-10-07 18:57:20.184272 (MainThread): On master: BEGIN
2021-10-07 18:57:20.184747 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:57:20.189461 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:20.190104 (MainThread): On master: COMMIT
2021-10-07 18:57:20.190486 (MainThread): Using postgres connection "master".
2021-10-07 18:57:20.190871 (MainThread): On master: COMMIT
2021-10-07 18:57:20.191501 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:57:20.191903 (MainThread): On master: Close
2021-10-07 18:57:20.192614 (MainThread): 18:57:20 | 
2021-10-07 18:57:20.193685 (MainThread): 18:57:20 | Finished running 1 table model in 0.24s.
2021-10-07 18:57:20.195098 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:57:20.196463 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:57:20.251399 (MainThread): 
2021-10-07 18:57:20.252608 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:57:20.253491 (MainThread): 
2021-10-07 18:57:20.254175 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:57:20.254898 (MainThread):   syntax error at or near "MOD"
2021-10-07 18:57:20.256328 (MainThread):   LINE 21:     MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8...
2021-10-07 18:57:20.257141 (MainThread):                ^
2021-10-07 18:57:20.258140 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:57:20.258944 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:57:20.259973 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed780e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed53d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5aed65b250>]}
2021-10-07 18:57:20.260738 (MainThread): Flushing usage events
2021-10-07 18:57:44.634367 (MainThread): Running with dbt=0.19.0
2021-10-07 18:57:44.792159 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:57:44.798439 (MainThread): Tracking: tracking
2021-10-07 18:57:44.801342 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452cd5cfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f45303653a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452cd6e070>]}
2021-10-07 18:57:44.856517 (MainThread): Partial parsing not enabled
2021-10-07 18:57:44.868443 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:57:44.872578 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:57:44.907028 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:57:44.911287 (MainThread): Parsing macros/relations.sql
2021-10-07 18:57:44.915338 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:57:44.919765 (MainThread): Parsing macros/core.sql
2021-10-07 18:57:44.926201 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:57:44.983217 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:57:44.987031 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:57:44.990152 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:57:45.004467 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:57:45.008265 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:57:45.010935 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:57:45.013359 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:57:45.032688 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:57:45.061859 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:57:45.064894 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:57:45.101931 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:57:45.127285 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:57:45.135856 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:57:45.138782 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:57:45.162293 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:57:45.171362 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:57:45.180427 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:57:45.199668 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:57:45.205228 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:57:45.210008 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:57:45.216428 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:57:45.251025 (MainThread): Partial parsing not enabled
2021-10-07 18:57:45.359252 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:57:45.447459 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:57:45.536526 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:57:45.814606 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:57:45.820476 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f629e7bc-128e-46de-ad3b-97a6d18f25c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452cbb56a0>]}
2021-10-07 18:57:45.882709 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:57:45.884989 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:57:45.886417 (MainThread): 
2021-10-07 18:57:45.887176 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:57:45.889940 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:57:45.908770 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:57:45.909409 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:57:45.909898 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:57:45.914952 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:57:45.918713 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:57:45.925550 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:57:45.933804 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:57:45.934507 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:57:45.935022 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:57:45.939507 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:45.940170 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:57:45.940633 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:57:45.943368 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:57:45.955886 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:57:45.956784 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:57:45.967580 (MainThread): Using postgres connection "master".
2021-10-07 18:57:45.968191 (MainThread): On master: BEGIN
2021-10-07 18:57:45.968700 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:57:45.972651 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:45.973273 (MainThread): Using postgres connection "master".
2021-10-07 18:57:45.973700 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:57:45.978943 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 18:57:45.979744 (MainThread): On master: ROLLBACK
2021-10-07 18:57:45.980414 (MainThread): Using postgres connection "master".
2021-10-07 18:57:45.980832 (MainThread): On master: BEGIN
2021-10-07 18:57:45.981662 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:45.982127 (MainThread): On master: COMMIT
2021-10-07 18:57:45.982667 (MainThread): Using postgres connection "master".
2021-10-07 18:57:45.983109 (MainThread): On master: COMMIT
2021-10-07 18:57:45.983968 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:57:45.984556 (MainThread): On master: Close
2021-10-07 18:57:45.985483 (MainThread): 18:57:45 | Concurrency: 2 threads (target='dev')
2021-10-07 18:57:45.986042 (MainThread): 18:57:45 | 
2021-10-07 18:57:45.991028 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:57:45.992973 (Thread-1): 18:57:45 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:57:45.993838 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:57:45.995114 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:57:46.015548 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:57:46.025947 (Thread-1): finished collecting timing info
2021-10-07 18:57:46.056341 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:46.057023 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:57:46.057401 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:57:46.061546 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:57:46.065145 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:46.065830 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:57:46.066711 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:57:46.080725 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:57:46.093327 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:46.093773 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:57:46.094654 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:46.095131 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:57:46.095655 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    doubled_digits = MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1);
    MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0;
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:57:46.096456 (Thread-1): Postgres error: syntax error at or near ";"
LINE 20: ...:creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1);
                                                                       ^

2021-10-07 18:57:46.096966 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:57:46.097873 (Thread-1): finished collecting timing info
2021-10-07 18:57:46.098630 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:57:46.099395 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 20: ...:creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1);
                                                                         ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 20: ...:creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1);
                                                                       ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 20: ...:creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1);
                                                                         ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:57:46.101656 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f629e7bc-128e-46de-ad3b-97a6d18f25c6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452cbfeaf0>]}
2021-10-07 18:57:46.103473 (Thread-1): 18:57:46 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 18:57:46.103981 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:57:46.106380 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:57:46.106905 (MainThread): Using postgres connection "master".
2021-10-07 18:57:46.107319 (MainThread): On master: BEGIN
2021-10-07 18:57:46.107675 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:57:46.111470 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:57:46.112046 (MainThread): On master: COMMIT
2021-10-07 18:57:46.112468 (MainThread): Using postgres connection "master".
2021-10-07 18:57:46.112838 (MainThread): On master: COMMIT
2021-10-07 18:57:46.113561 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:57:46.114048 (MainThread): On master: Close
2021-10-07 18:57:46.114810 (MainThread): 18:57:46 | 
2021-10-07 18:57:46.115352 (MainThread): 18:57:46 | Finished running 1 table model in 0.23s.
2021-10-07 18:57:46.115780 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:57:46.116254 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:57:46.173404 (MainThread): 
2021-10-07 18:57:46.174054 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:57:46.174685 (MainThread): 
2021-10-07 18:57:46.175350 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:57:46.176203 (MainThread):   syntax error at or near ";"
2021-10-07 18:57:46.177026 (MainThread):   LINE 20: ...:creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1);
2021-10-07 18:57:46.178178 (MainThread):                                                                          ^
2021-10-07 18:57:46.178956 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:57:46.180095 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:57:46.181200 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452cb0bc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452cc02430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f452c2bd220>]}
2021-10-07 18:57:46.182045 (MainThread): Flushing usage events
2021-10-07 18:58:33.721584 (MainThread): Running with dbt=0.19.0
2021-10-07 18:58:33.855559 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:58:33.861074 (MainThread): Tracking: tracking
2021-10-07 18:58:33.863795 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f115f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f2c0a310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f11701c0>]}
2021-10-07 18:58:33.906712 (MainThread): Partial parsing not enabled
2021-10-07 18:58:33.924915 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:58:33.928958 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:58:33.957609 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:58:33.961117 (MainThread): Parsing macros/relations.sql
2021-10-07 18:58:33.963543 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:58:33.967292 (MainThread): Parsing macros/core.sql
2021-10-07 18:58:33.973421 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:58:34.029658 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:58:34.032916 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:58:34.036287 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:58:34.049312 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:58:34.052427 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:58:34.054397 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:58:34.056334 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:58:34.068791 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:58:34.096993 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:58:34.100205 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:58:34.141052 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:58:34.166893 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:58:34.176035 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:58:34.179200 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:58:34.198974 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:58:34.207888 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:58:34.217415 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:58:34.227737 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:58:34.231144 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:58:34.233762 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:58:34.237258 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:58:34.257075 (MainThread): Partial parsing not enabled
2021-10-07 18:58:34.314498 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:58:34.355673 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:58:34.400657 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:58:34.696582 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:58:34.702555 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '515104ca-08d1-42d1-a571-b14ff01ad75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0fb6880>]}
2021-10-07 18:58:34.759630 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:58:34.761672 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:58:34.763272 (MainThread): 
2021-10-07 18:58:34.764454 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:58:34.767270 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:58:34.781143 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:58:34.781819 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:58:34.782244 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:58:34.788032 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:58:34.791681 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:58:34.797540 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:58:34.806093 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:58:34.806844 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:58:34.807352 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:58:34.811238 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:34.811751 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:58:34.812208 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:58:34.814923 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:58:34.826731 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:58:34.827629 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:58:34.838678 (MainThread): Using postgres connection "master".
2021-10-07 18:58:34.839281 (MainThread): On master: BEGIN
2021-10-07 18:58:34.839659 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:58:34.843762 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:34.844280 (MainThread): Using postgres connection "master".
2021-10-07 18:58:34.844702 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:58:34.850389 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:58:34.851251 (MainThread): On master: ROLLBACK
2021-10-07 18:58:34.851927 (MainThread): Using postgres connection "master".
2021-10-07 18:58:34.852444 (MainThread): On master: BEGIN
2021-10-07 18:58:34.853265 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:34.853734 (MainThread): On master: COMMIT
2021-10-07 18:58:34.854211 (MainThread): Using postgres connection "master".
2021-10-07 18:58:34.854549 (MainThread): On master: COMMIT
2021-10-07 18:58:34.855158 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:58:34.855628 (MainThread): On master: Close
2021-10-07 18:58:34.856338 (MainThread): 18:58:34 | Concurrency: 2 threads (target='dev')
2021-10-07 18:58:34.856899 (MainThread): 18:58:34 | 
2021-10-07 18:58:34.861446 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:58:34.863295 (Thread-1): 18:58:34 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:58:34.863952 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:58:34.864412 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:58:34.894425 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:58:34.906423 (Thread-1): finished collecting timing info
2021-10-07 18:58:34.936542 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:34.937177 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:58:34.937597 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:58:34.941793 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:58:34.944986 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:34.945488 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:58:34.946309 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:58:34.958979 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:58:34.969262 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:34.969769 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:58:34.970475 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:34.971001 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:34.971471 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    doubled_digits = MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1)
    MOD(SUM(
        MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) / INT8 '10' 
    + MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:58:34.972417 (Thread-1): Postgres error: syntax error at or near "MOD"
LINE 21:     MOD(SUM(
             ^

2021-10-07 18:58:34.972976 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:58:34.973748 (Thread-1): finished collecting timing info
2021-10-07 18:58:34.974590 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:58:34.975460 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "MOD"
  LINE 21:     MOD(SUM(
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "MOD"
LINE 21:     MOD(SUM(
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "MOD"
  LINE 21:     MOD(SUM(
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:58:34.978013 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '515104ca-08d1-42d1-a571-b14ff01ad75a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0f35e80>]}
2021-10-07 18:58:34.979698 (Thread-1): 18:58:34 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 18:58:34.980336 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:58:34.983038 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:58:34.983687 (MainThread): Using postgres connection "master".
2021-10-07 18:58:34.984174 (MainThread): On master: BEGIN
2021-10-07 18:58:34.984690 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:58:34.988935 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:34.989693 (MainThread): On master: COMMIT
2021-10-07 18:58:34.990204 (MainThread): Using postgres connection "master".
2021-10-07 18:58:34.990820 (MainThread): On master: COMMIT
2021-10-07 18:58:34.991658 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:58:34.992249 (MainThread): On master: Close
2021-10-07 18:58:34.993228 (MainThread): 18:58:34 | 
2021-10-07 18:58:34.993904 (MainThread): 18:58:34 | Finished running 1 table model in 0.23s.
2021-10-07 18:58:34.994652 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:58:34.995165 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:58:35.050493 (MainThread): 
2021-10-07 18:58:35.051216 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:58:35.052221 (MainThread): 
2021-10-07 18:58:35.053223 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:58:35.054299 (MainThread):   syntax error at or near "MOD"
2021-10-07 18:58:35.055133 (MainThread):   LINE 21:     MOD(SUM(
2021-10-07 18:58:35.056110 (MainThread):                ^
2021-10-07 18:58:35.056997 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:58:35.058146 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:58:35.059222 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f0685d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f10c4130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa6f06c1430>]}
2021-10-07 18:58:35.060011 (MainThread): Flushing usage events
2021-10-07 18:58:48.908282 (MainThread): Running with dbt=0.19.0
2021-10-07 18:58:49.061194 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:58:49.067414 (MainThread): Tracking: tracking
2021-10-07 18:58:49.069652 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7475ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f77d663a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f7476f070>]}
2021-10-07 18:58:49.114678 (MainThread): Partial parsing not enabled
2021-10-07 18:58:49.133654 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:58:49.142518 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:58:49.184675 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:58:49.191704 (MainThread): Parsing macros/relations.sql
2021-10-07 18:58:49.196428 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:58:49.203279 (MainThread): Parsing macros/core.sql
2021-10-07 18:58:49.211518 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:58:49.271158 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:58:49.277423 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:58:49.282653 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:58:49.305470 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:58:49.308718 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:58:49.311037 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:58:49.313007 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:58:49.331238 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:58:49.390975 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:58:49.394596 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:58:49.443072 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:58:49.472850 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:58:49.482075 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:58:49.486350 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:58:49.505247 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:58:49.513474 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:58:49.522820 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:58:49.532848 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:58:49.535829 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:58:49.538412 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:58:49.541511 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:58:49.560665 (MainThread): Partial parsing not enabled
2021-10-07 18:58:49.622424 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:58:49.657700 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:58:49.696639 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:58:50.006678 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:58:50.015705 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa94c597-88f5-4439-b69d-2d349e9c49d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f745b7580>]}
2021-10-07 18:58:50.084113 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:58:50.086283 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:58:50.087752 (MainThread): 
2021-10-07 18:58:50.088470 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:58:50.091206 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:58:50.106893 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:58:50.107598 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:58:50.108174 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:58:50.113250 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:58:50.116656 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:58:50.123449 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:58:50.132075 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:58:50.132926 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:58:50.133726 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:58:50.139238 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 18:58:50.139787 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:58:50.140166 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:58:50.143175 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:58:50.155980 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:58:50.156858 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:58:50.167916 (MainThread): Using postgres connection "master".
2021-10-07 18:58:50.168654 (MainThread): On master: BEGIN
2021-10-07 18:58:50.169164 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:58:50.173561 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:50.174111 (MainThread): Using postgres connection "master".
2021-10-07 18:58:50.174583 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:58:50.180536 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:58:50.181427 (MainThread): On master: ROLLBACK
2021-10-07 18:58:50.182179 (MainThread): Using postgres connection "master".
2021-10-07 18:58:50.182642 (MainThread): On master: BEGIN
2021-10-07 18:58:50.183596 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:50.184042 (MainThread): On master: COMMIT
2021-10-07 18:58:50.184551 (MainThread): Using postgres connection "master".
2021-10-07 18:58:50.185002 (MainThread): On master: COMMIT
2021-10-07 18:58:50.185790 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:58:50.186313 (MainThread): On master: Close
2021-10-07 18:58:50.187153 (MainThread): 18:58:50 | Concurrency: 2 threads (target='dev')
2021-10-07 18:58:50.187653 (MainThread): 18:58:50 | 
2021-10-07 18:58:50.191863 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:58:50.193882 (Thread-1): 18:58:50 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:58:50.194952 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:58:50.195478 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:58:50.219181 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:58:50.232335 (Thread-1): finished collecting timing info
2021-10-07 18:58:50.263744 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:50.264422 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:58:50.264892 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:58:50.270116 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 18:58:50.273705 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:50.274404 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:58:50.275332 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:58:50.290201 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:58:50.302654 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:50.303149 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:58:50.303864 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:50.304552 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:58:50.305027 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    MOD(SUM(
        MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) / INT8 '10' 
    + MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:58:50.306129 (Thread-1): Postgres error: syntax error at or near ";"
LINE 22: ...0::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
                                                                       ^

2021-10-07 18:58:50.306693 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:58:50.307591 (Thread-1): finished collecting timing info
2021-10-07 18:58:50.308383 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:58:50.309255 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 22: ...0::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
                                                                         ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near ";"
LINE 22: ...0::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
                                                                       ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near ";"
  LINE 22: ...0::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
                                                                         ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:58:50.311658 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa94c597-88f5-4439-b69d-2d349e9c49d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f746b0dc0>]}
2021-10-07 18:58:50.313642 (Thread-1): 18:58:50 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.12s]
2021-10-07 18:58:50.314539 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:58:50.317559 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:58:50.318461 (MainThread): Using postgres connection "master".
2021-10-07 18:58:50.318891 (MainThread): On master: BEGIN
2021-10-07 18:58:50.319401 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:58:50.323790 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:58:50.324323 (MainThread): On master: COMMIT
2021-10-07 18:58:50.324709 (MainThread): Using postgres connection "master".
2021-10-07 18:58:50.325137 (MainThread): On master: COMMIT
2021-10-07 18:58:50.325839 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:58:50.326249 (MainThread): On master: Close
2021-10-07 18:58:50.327035 (MainThread): 18:58:50 | 
2021-10-07 18:58:50.327760 (MainThread): 18:58:50 | Finished running 1 table model in 0.24s.
2021-10-07 18:58:50.328372 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:58:50.329000 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:58:50.388658 (MainThread): 
2021-10-07 18:58:50.389149 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:58:50.389974 (MainThread): 
2021-10-07 18:58:50.390598 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:58:50.391400 (MainThread):   syntax error at or near ";"
2021-10-07 18:58:50.392737 (MainThread):   LINE 22: ...0::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0;
2021-10-07 18:58:50.393587 (MainThread):                                                                          ^
2021-10-07 18:58:50.395060 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:58:50.396034 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:58:50.397169 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f73ca71f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f74611760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1f74506dc0>]}
2021-10-07 18:58:50.397883 (MainThread): Flushing usage events
2021-10-07 18:59:02.160640 (MainThread): Running with dbt=0.19.0
2021-10-07 18:59:02.281137 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 18:59:02.285519 (MainThread): Tracking: tracking
2021-10-07 18:59:02.287759 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979e3a6be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f97a19ad400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979e3b60d0>]}
2021-10-07 18:59:02.328745 (MainThread): Partial parsing not enabled
2021-10-07 18:59:02.341455 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 18:59:02.344999 (MainThread): Parsing macros/adapters.sql
2021-10-07 18:59:02.375142 (MainThread): Parsing macros/catalog.sql
2021-10-07 18:59:02.378568 (MainThread): Parsing macros/relations.sql
2021-10-07 18:59:02.381104 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 18:59:02.385101 (MainThread): Parsing macros/core.sql
2021-10-07 18:59:02.390670 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 18:59:02.446059 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 18:59:02.448982 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 18:59:02.451429 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 18:59:02.464881 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 18:59:02.468145 (MainThread): Parsing macros/etc/query.sql
2021-10-07 18:59:02.470355 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 18:59:02.473253 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 18:59:02.487002 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 18:59:02.519618 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 18:59:02.522893 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 18:59:02.572392 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 18:59:02.605763 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 18:59:02.617827 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 18:59:02.621444 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 18:59:02.655447 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 18:59:02.669766 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 18:59:02.688059 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 18:59:02.701361 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 18:59:02.704680 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 18:59:02.707134 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 18:59:02.710183 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 18:59:02.726421 (MainThread): Partial parsing not enabled
2021-10-07 18:59:02.790753 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 18:59:02.836576 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:59:02.872182 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 18:59:03.120846 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 18:59:03.126315 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '63cece1a-af2f-4d03-8762-9605047e8c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979e1fd5e0>]}
2021-10-07 18:59:03.190664 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 18:59:03.191969 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 18:59:03.193314 (MainThread): 
2021-10-07 18:59:03.194075 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:59:03.198099 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 18:59:03.217303 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 18:59:03.217829 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 18:59:03.218209 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 18:59:03.223506 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 18:59:03.228002 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 18:59:03.236146 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 18:59:03.244981 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:59:03.245409 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 18:59:03.245697 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 18:59:03.249497 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:59:03.250054 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 18:59:03.250593 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 18:59:03.253587 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 18:59:03.266693 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 18:59:03.267688 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 18:59:03.278621 (MainThread): Using postgres connection "master".
2021-10-07 18:59:03.279274 (MainThread): On master: BEGIN
2021-10-07 18:59:03.279675 (MainThread): Opening a new connection, currently in state init
2021-10-07 18:59:03.283926 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:59:03.284401 (MainThread): Using postgres connection "master".
2021-10-07 18:59:03.284885 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 18:59:03.291423 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 18:59:03.292417 (MainThread): On master: ROLLBACK
2021-10-07 18:59:03.293223 (MainThread): Using postgres connection "master".
2021-10-07 18:59:03.293613 (MainThread): On master: BEGIN
2021-10-07 18:59:03.294838 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:59:03.295427 (MainThread): On master: COMMIT
2021-10-07 18:59:03.295900 (MainThread): Using postgres connection "master".
2021-10-07 18:59:03.296202 (MainThread): On master: COMMIT
2021-10-07 18:59:03.296963 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:59:03.297660 (MainThread): On master: Close
2021-10-07 18:59:03.298529 (MainThread): 18:59:03 | Concurrency: 2 threads (target='dev')
2021-10-07 18:59:03.299221 (MainThread): 18:59:03 | 
2021-10-07 18:59:03.304903 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 18:59:03.306989 (Thread-1): 18:59:03 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 18:59:03.308027 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 18:59:03.308467 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 18:59:03.339809 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 18:59:03.347679 (Thread-1): finished collecting timing info
2021-10-07 18:59:03.382219 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:59:03.382999 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 18:59:03.383445 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 18:59:03.387325 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:59:03.390667 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:59:03.391145 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 18:59:03.391760 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 18:59:03.406695 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 18:59:03.413739 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:59:03.414073 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 18:59:03.414902 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:59:03.415261 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 18:59:03.415521 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    MOD(SUM(
        MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) / INT8 '10' 
    + MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0
 = FALSE
GROUP BY orderdate
  );
2021-10-07 18:59:03.416526 (Thread-1): Postgres error: syntax error at or near "="
LINE 23:  = FALSE
          ^

2021-10-07 18:59:03.417008 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 18:59:03.417653 (Thread-1): finished collecting timing info
2021-10-07 18:59:03.418308 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 18:59:03.418957 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "="
  LINE 23:  = FALSE
            ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "="
LINE 23:  = FALSE
          ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "="
  LINE 23:  = FALSE
            ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:59:03.421229 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '63cece1a-af2f-4d03-8762-9605047e8c76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979e2d3dc0>]}
2021-10-07 18:59:03.422954 (Thread-1): 18:59:03 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 18:59:03.423421 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 18:59:03.425829 (MainThread): Acquiring new postgres connection "master".
2021-10-07 18:59:03.426288 (MainThread): Using postgres connection "master".
2021-10-07 18:59:03.426569 (MainThread): On master: BEGIN
2021-10-07 18:59:03.426953 (MainThread): Opening a new connection, currently in state closed
2021-10-07 18:59:03.431302 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 18:59:03.432431 (MainThread): On master: COMMIT
2021-10-07 18:59:03.433427 (MainThread): Using postgres connection "master".
2021-10-07 18:59:03.433753 (MainThread): On master: COMMIT
2021-10-07 18:59:03.434398 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 18:59:03.434847 (MainThread): On master: Close
2021-10-07 18:59:03.435601 (MainThread): 18:59:03 | 
2021-10-07 18:59:03.436052 (MainThread): 18:59:03 | Finished running 1 table model in 0.24s.
2021-10-07 18:59:03.436525 (MainThread): Connection 'master' was properly closed.
2021-10-07 18:59:03.437116 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 18:59:03.508213 (MainThread): 
2021-10-07 18:59:03.508679 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 18:59:03.509262 (MainThread): 
2021-10-07 18:59:03.510164 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 18:59:03.511447 (MainThread):   syntax error at or near "="
2021-10-07 18:59:03.512433 (MainThread):   LINE 23:  = FALSE
2021-10-07 18:59:03.513262 (MainThread):             ^
2021-10-07 18:59:03.517106 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 18:59:03.517843 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 18:59:03.518683 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979e26d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979e2e1220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f979d907340>]}
2021-10-07 18:59:03.519637 (MainThread): Flushing usage events
2021-10-07 19:03:00.126239 (MainThread): Running with dbt=0.19.0
2021-10-07 19:03:00.299571 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:03:00.306217 (MainThread): Tracking: tracking
2021-10-07 19:03:00.309209 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f6521940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f9b28460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f6532130>]}
2021-10-07 19:03:00.358087 (MainThread): Partial parsing not enabled
2021-10-07 19:03:00.366502 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:03:00.370019 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:03:00.397518 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:03:00.404872 (MainThread): Parsing macros/relations.sql
2021-10-07 19:03:00.409512 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:03:00.417241 (MainThread): Parsing macros/core.sql
2021-10-07 19:03:00.428749 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:03:00.496756 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:03:00.500240 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:03:00.503545 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:03:00.518845 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:03:00.522267 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:03:00.524579 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:03:00.527587 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:03:00.544189 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:03:00.573640 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:03:00.578553 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:03:00.618915 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:03:00.651660 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:03:00.661734 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:03:00.666074 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:03:00.688939 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:03:00.697708 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:03:00.707805 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:03:00.718249 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:03:00.721196 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:03:00.723736 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:03:00.727050 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:03:00.745556 (MainThread): Partial parsing not enabled
2021-10-07 19:03:00.802907 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:03:00.837701 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:03:00.876601 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:03:01.144571 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:03:01.154093 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '306f4a4b-bfe6-4d7d-a610-23bfb739a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f6378700>]}
2021-10-07 19:03:01.216790 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:03:01.219054 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:03:01.221070 (MainThread): 
2021-10-07 19:03:01.222113 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:03:01.225081 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:03:01.242235 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:03:01.242845 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:03:01.243360 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:03:01.248631 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:03:01.252633 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:03:01.259865 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:03:01.268639 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:03:01.269847 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:03:01.270818 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:03:01.275186 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:03:01.275716 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:03:01.276039 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:03:01.278700 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:03:01.291536 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:03:01.292509 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:03:01.303731 (MainThread): Using postgres connection "master".
2021-10-07 19:03:01.304267 (MainThread): On master: BEGIN
2021-10-07 19:03:01.304808 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:03:01.308907 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:03:01.309401 (MainThread): Using postgres connection "master".
2021-10-07 19:03:01.309764 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:03:01.315716 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:03:01.316446 (MainThread): On master: ROLLBACK
2021-10-07 19:03:01.317445 (MainThread): Using postgres connection "master".
2021-10-07 19:03:01.318124 (MainThread): On master: BEGIN
2021-10-07 19:03:01.319166 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:03:01.319709 (MainThread): On master: COMMIT
2021-10-07 19:03:01.320153 (MainThread): Using postgres connection "master".
2021-10-07 19:03:01.320543 (MainThread): On master: COMMIT
2021-10-07 19:03:01.321289 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:03:01.321736 (MainThread): On master: Close
2021-10-07 19:03:01.322494 (MainThread): 19:03:01 | Concurrency: 2 threads (target='dev')
2021-10-07 19:03:01.323142 (MainThread): 19:03:01 | 
2021-10-07 19:03:01.327292 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:03:01.329126 (Thread-1): 19:03:01 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:03:01.329834 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:03:01.330243 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:03:01.351101 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:03:01.362805 (Thread-1): finished collecting timing info
2021-10-07 19:03:01.395571 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:03:01.396206 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:03:01.396680 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:03:01.401092 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:03:01.404927 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:03:01.405538 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:03:01.406418 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:03:01.421245 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:03:01.444270 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:03:01.445005 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:03:01.445870 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:03:01.446271 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:03:01.446598 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    (MOD(SUM(
        MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) / INT8 '10' 
        + MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int8 ), 10::creditcard::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0)
 = FALSE
GROUP BY orderdate
  );
2021-10-07 19:03:01.447767 (Thread-1): Postgres error: type "creditcard" does not exist
LINE 21:         MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int...
                            ^

2021-10-07 19:03:01.448185 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:03:01.448855 (Thread-1): finished collecting timing info
2021-10-07 19:03:01.449484 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:03:01.450164 (Thread-1): Database Error in model task2 (models/task2.sql)
  type "creditcard" does not exist
  LINE 21:         MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int...
                              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedObject: type "creditcard" does not exist
LINE 21:         MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int...
                            ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  type "creditcard" does not exist
  LINE 21:         MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int...
                              ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:03:01.452354 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '306f4a4b-bfe6-4d7d-a610-23bfb739a639', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f645d070>]}
2021-10-07 19:03:01.454064 (Thread-1): 19:03:01 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.12s]
2021-10-07 19:03:01.454597 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:03:01.456944 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:03:01.457491 (MainThread): Using postgres connection "master".
2021-10-07 19:03:01.457862 (MainThread): On master: BEGIN
2021-10-07 19:03:01.458254 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:03:01.462335 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:03:01.462897 (MainThread): On master: COMMIT
2021-10-07 19:03:01.463231 (MainThread): Using postgres connection "master".
2021-10-07 19:03:01.463575 (MainThread): On master: COMMIT
2021-10-07 19:03:01.464293 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:03:01.464741 (MainThread): On master: Close
2021-10-07 19:03:01.465525 (MainThread): 19:03:01 | 
2021-10-07 19:03:01.466047 (MainThread): 19:03:01 | Finished running 1 table model in 0.24s.
2021-10-07 19:03:01.466471 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:03:01.466977 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:03:01.521819 (MainThread): 
2021-10-07 19:03:01.522369 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:03:01.522965 (MainThread): 
2021-10-07 19:03:01.523653 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:03:01.524470 (MainThread):   type "creditcard" does not exist
2021-10-07 19:03:01.525624 (MainThread):   LINE 21:         MOD( ( $1::creditcard::int8/ (10^n)::creditcard::int...
2021-10-07 19:03:01.527052 (MainThread):                               ^
2021-10-07 19:03:01.528675 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:03:01.529608 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:03:01.530651 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f62c5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f646d760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f52f6383940>]}
2021-10-07 19:03:01.531438 (MainThread): Flushing usage events
2021-10-07 19:04:07.117540 (MainThread): Running with dbt=0.19.0
2021-10-07 19:04:07.301185 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:04:07.306991 (MainThread): Tracking: tracking
2021-10-07 19:04:07.309123 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce3036970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce4ae2280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce3047160>]}
2021-10-07 19:04:07.350016 (MainThread): Partial parsing not enabled
2021-10-07 19:04:07.360350 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:04:07.363271 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:04:07.391282 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:04:07.395722 (MainThread): Parsing macros/relations.sql
2021-10-07 19:04:07.398286 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:04:07.402217 (MainThread): Parsing macros/core.sql
2021-10-07 19:04:07.407896 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:04:07.463672 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:04:07.467074 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:04:07.469591 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:04:07.482119 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:04:07.485753 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:04:07.487933 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:04:07.489903 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:04:07.502059 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:04:07.529346 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:04:07.532402 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:04:07.576960 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:04:07.621616 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:04:07.639907 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:04:07.645961 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:04:07.684684 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:04:07.699160 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:04:07.718588 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:04:07.737295 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:04:07.742727 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:04:07.747726 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:04:07.753626 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:04:07.789383 (MainThread): Partial parsing not enabled
2021-10-07 19:04:07.897338 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:04:07.936524 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:04:07.975964 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:04:08.357959 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:04:08.367199 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fc2a9e3-1eff-4a3b-aa84-9762c73f77a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce2e8c730>]}
2021-10-07 19:04:08.438714 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:04:08.442647 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 140 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:04:08.446135 (MainThread): 
2021-10-07 19:04:08.447956 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:04:08.453741 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:04:08.480291 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:04:08.481114 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:04:08.481807 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:04:08.488826 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:04:08.492707 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:04:08.499489 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:04:08.508674 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:04:08.509301 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:04:08.509826 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:04:08.514013 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:04:08.514603 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:04:08.515119 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:04:08.518376 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:04:08.530332 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:04:08.531426 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:04:08.541998 (MainThread): Using postgres connection "master".
2021-10-07 19:04:08.542930 (MainThread): On master: BEGIN
2021-10-07 19:04:08.543480 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:04:08.547804 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:04:08.548408 (MainThread): Using postgres connection "master".
2021-10-07 19:04:08.548888 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:04:08.554840 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:04:08.555660 (MainThread): On master: ROLLBACK
2021-10-07 19:04:08.556398 (MainThread): Using postgres connection "master".
2021-10-07 19:04:08.556874 (MainThread): On master: BEGIN
2021-10-07 19:04:08.557938 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:04:08.558387 (MainThread): On master: COMMIT
2021-10-07 19:04:08.558862 (MainThread): Using postgres connection "master".
2021-10-07 19:04:08.559346 (MainThread): On master: COMMIT
2021-10-07 19:04:08.560094 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:04:08.560647 (MainThread): On master: Close
2021-10-07 19:04:08.561635 (MainThread): 19:04:08 | Concurrency: 2 threads (target='dev')
2021-10-07 19:04:08.562201 (MainThread): 19:04:08 | 
2021-10-07 19:04:08.566599 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:04:08.568626 (Thread-1): 19:04:08 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:04:08.569580 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:04:08.570018 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:04:08.593133 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:04:08.604946 (Thread-1): finished collecting timing info
2021-10-07 19:04:08.632705 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:04:08.633432 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:04:08.633857 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:04:08.638278 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:04:08.641662 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:04:08.642370 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:04:08.643150 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:04:08.656415 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:04:08.669299 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:04:08.669847 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:04:08.670822 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:04:08.671339 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:04:08.671767 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 
    (MOD(SUM(
        MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,2) + 1) / INT8 '10' 
        + MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,2) + 1) % INT8 '10'), 10) = 0)
 = FALSE
GROUP BY orderdate
  );
2021-10-07 19:04:08.673198 (Thread-1): Postgres error: there is no parameter $1
LINE 21:         MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,...
                        ^

2021-10-07 19:04:08.673676 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:04:08.674605 (Thread-1): finished collecting timing info
2021-10-07 19:04:08.675256 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:04:08.676052 (Thread-1): Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 21:         MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,...
                          ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedParameter: there is no parameter $1
LINE 21:         MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,...
                        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 21:         MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,...
                          ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:04:08.678539 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8fc2a9e3-1eff-4a3b-aa84-9762c73f77a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce2ee9af0>]}
2021-10-07 19:04:08.681863 (Thread-1): 19:04:08 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:04:08.682808 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:04:08.686964 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:04:08.687987 (MainThread): Using postgres connection "master".
2021-10-07 19:04:08.688860 (MainThread): On master: BEGIN
2021-10-07 19:04:08.689751 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:04:08.697509 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:04:08.698467 (MainThread): On master: COMMIT
2021-10-07 19:04:08.699212 (MainThread): Using postgres connection "master".
2021-10-07 19:04:08.699845 (MainThread): On master: COMMIT
2021-10-07 19:04:08.701178 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:04:08.701983 (MainThread): On master: Close
2021-10-07 19:04:08.703435 (MainThread): 19:04:08 | 
2021-10-07 19:04:08.704097 (MainThread): 19:04:08 | Finished running 1 table model in 0.26s.
2021-10-07 19:04:08.705941 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:04:08.707329 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:04:08.766627 (MainThread): 
2021-10-07 19:04:08.767267 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:04:08.768316 (MainThread): 
2021-10-07 19:04:08.769278 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:04:08.770722 (MainThread):   there is no parameter $1
2021-10-07 19:04:08.771948 (MainThread):   LINE 21:         MOD( ( $1::int8/ (10^n)::int8 ), 10::int8) * (MOD(n,...
2021-10-07 19:04:08.773190 (MainThread):                           ^
2021-10-07 19:04:08.774272 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:04:08.776058 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:04:08.777343 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce2598f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce2ed6340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1ce2f085e0>]}
2021-10-07 19:04:08.778166 (MainThread): Flushing usage events
2021-10-07 19:09:48.970007 (MainThread): Running with dbt=0.19.0
2021-10-07 19:09:49.100753 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:09:49.104953 (MainThread): Tracking: tracking
2021-10-07 19:09:49.107428 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a5676c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a711deb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a5688430>]}
2021-10-07 19:09:49.155196 (MainThread): Partial parsing not enabled
2021-10-07 19:09:49.164235 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:09:49.168706 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:09:49.203449 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:09:49.207039 (MainThread): Parsing macros/relations.sql
2021-10-07 19:09:49.209271 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:09:49.213372 (MainThread): Parsing macros/core.sql
2021-10-07 19:09:49.220446 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:09:49.282941 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:09:49.287102 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:09:49.289902 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:09:49.302445 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:09:49.305125 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:09:49.307106 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:09:49.309061 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:09:49.323277 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:09:49.358451 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:09:49.361433 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:09:49.403430 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:09:49.433155 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:09:49.444407 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:09:49.447999 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:09:49.471225 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:09:49.479506 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:09:49.490376 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:09:49.501308 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:09:49.504265 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:09:49.506870 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:09:49.509861 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:09:49.527747 (MainThread): Partial parsing not enabled
2021-10-07 19:09:49.592692 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:09:49.628031 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:09:49.677135 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:09:49.969508 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:09:49.979808 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '46a8b0a5-2e73-4364-8d77-618aefb4798e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a54cf1f0>]}
2021-10-07 19:09:50.027657 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 19:09:50.028209 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:09:50.028613 (MainThread): On macro_Luhns: BEGIN
2021-10-07 19:09:50.029078 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:09:50.033475 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:09:50.033987 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:09:50.034509 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:09:50.034829 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:09:50.035661 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:09:50.039488 (MainThread): 10005.0
2021-10-07 19:09:50.040096 (MainThread): On macro_Luhns: Close
2021-10-07 19:09:50.040873 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a5676c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a5555250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f03a710ff70>]}
2021-10-07 19:09:50.041542 (MainThread): Flushing usage events
2021-10-07 19:09:50.678375 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 19:10:32.846310 (MainThread): Running with dbt=0.19.0
2021-10-07 19:10:32.999515 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:10:33.005487 (MainThread): Tracking: tracking
2021-10-07 19:10:33.007769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e523bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3ffcbd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e5353a0>]}
2021-10-07 19:10:33.051702 (MainThread): Partial parsing not enabled
2021-10-07 19:10:33.070599 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:10:33.074464 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e511850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e54a970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4a3e54adf0>]}
2021-10-07 19:10:33.075256 (MainThread): Flushing usage events
2021-10-07 19:10:33.771625 (MainThread): Encountered an error:
2021-10-07 19:10:33.775302 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  invalid syntax for function call expression
    line 3
      {{log( cn=10, True)}}
2021-10-07 19:10:33.792829 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: invalid syntax for function call expression
  line 3
    {{log( cn=10, True)}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  invalid syntax for function call expression
    line 3
      {{log( cn=10, True)}}

2021-10-07 19:11:12.887391 (MainThread): Running with dbt=0.19.0
2021-10-07 19:11:13.056149 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:11:13.061286 (MainThread): Tracking: tracking
2021-10-07 19:11:13.063722 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060c781c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060e228eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060c793430>]}
2021-10-07 19:11:13.107410 (MainThread): Partial parsing not enabled
2021-10-07 19:11:13.117792 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:11:13.121355 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060c79d2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060c7a2a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f060c7a2eb0>]}
2021-10-07 19:11:13.122075 (MainThread): Flushing usage events
2021-10-07 19:11:13.751075 (MainThread): Encountered an error:
2021-10-07 19:11:13.754192 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token ')', got '='
    line 3
      {% set b = (cn = 10) %}
2021-10-07 19:11:13.771613 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token ')', got '='
  line 3
    {% set b = (cn = 10) %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token ')', got '='
    line 3
      {% set b = (cn = 10) %}

2021-10-07 19:11:47.239798 (MainThread): Running with dbt=0.19.0
2021-10-07 19:11:47.355190 (MainThread): running dbt with arguments Namespace(args='{cc: 100050}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:11:47.359907 (MainThread): Tracking: tracking
2021-10-07 19:11:47.361866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db17c2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db3269f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db17d4400>]}
2021-10-07 19:11:47.402841 (MainThread): Partial parsing not enabled
2021-10-07 19:11:47.410762 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:11:47.414817 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:11:47.441031 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:11:47.444679 (MainThread): Parsing macros/relations.sql
2021-10-07 19:11:47.446942 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:11:47.450593 (MainThread): Parsing macros/core.sql
2021-10-07 19:11:47.456392 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:11:47.514084 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:11:47.517214 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:11:47.519854 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:11:47.535724 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:11:47.538582 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:11:47.540547 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:11:47.542118 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:11:47.554481 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:11:47.580121 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:11:47.583081 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:11:47.623705 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:11:47.651458 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:11:47.661776 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:11:47.665222 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:11:47.682886 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:11:47.690362 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:11:47.699161 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:11:47.708799 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:11:47.712156 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:11:47.715768 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:11:47.718694 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:11:47.735803 (MainThread): Partial parsing not enabled
2021-10-07 19:11:47.841783 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:11:47.907630 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:11:47.977018 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:11:48.325833 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:11:48.339161 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cae86130-b327-4be4-bee4-135947eaafa2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db15a3250>]}
2021-10-07 19:11:48.413630 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 19:11:48.414244 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:11:48.414673 (MainThread): On macro_Luhns: BEGIN
2021-10-07 19:11:48.415261 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:11:48.419942 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:11:48.420547 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:11:48.421059 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:11:48.421561 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:11:48.422237 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:11:48.426486 (MainThread): False
2021-10-07 19:11:48.427256 (MainThread): On macro_Luhns: Close
2021-10-07 19:11:48.429380 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db17c2c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db1663f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7db1663ac0>]}
2021-10-07 19:11:48.429994 (MainThread): Flushing usage events
2021-10-07 19:11:49.023020 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 19:11:58.067257 (MainThread): Running with dbt=0.19.0
2021-10-07 19:11:58.238267 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:11:58.244307 (MainThread): Tracking: tracking
2021-10-07 19:11:58.246663 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b8c3bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32ba6e2e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b8c4c340>]}
2021-10-07 19:11:58.286946 (MainThread): Partial parsing not enabled
2021-10-07 19:11:58.295254 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:11:58.299390 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:11:58.326196 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:11:58.329950 (MainThread): Parsing macros/relations.sql
2021-10-07 19:11:58.332347 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:11:58.336258 (MainThread): Parsing macros/core.sql
2021-10-07 19:11:58.342037 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:11:58.399575 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:11:58.403164 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:11:58.405925 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:11:58.418251 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:11:58.420829 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:11:58.424602 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:11:58.427555 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:11:58.443064 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:11:58.499271 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:11:58.505548 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:11:58.586977 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:11:58.638989 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:11:58.657640 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:11:58.664135 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:11:58.696007 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:11:58.705316 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:11:58.714606 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:11:58.723091 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:11:58.726802 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:11:58.729186 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:11:58.731953 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:11:58.752117 (MainThread): Partial parsing not enabled
2021-10-07 19:11:58.807787 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:11:58.847984 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:11:58.917063 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:11:59.385620 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:11:59.396163 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ea2b1bcc-2d54-4300-9bf3-cee2af6e17db', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b8a1b0d0>]}
2021-10-07 19:11:59.465889 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 19:11:59.466671 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:11:59.467225 (MainThread): On macro_Luhns: BEGIN
2021-10-07 19:11:59.467851 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:11:59.473515 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:11:59.474219 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:11:59.474835 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:11:59.475390 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:11:59.476231 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:11:59.481753 (MainThread): True
2021-10-07 19:11:59.482651 (MainThread): On macro_Luhns: Close
2021-10-07 19:11:59.484911 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b8c3bbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b8aeec40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32b8aeec10>]}
2021-10-07 19:11:59.485867 (MainThread): Flushing usage events
2021-10-07 19:12:00.088064 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 19:24:23.517371 (MainThread): Running with dbt=0.19.0
2021-10-07 19:24:23.680267 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:24:23.689493 (MainThread): Tracking: tracking
2021-10-07 19:24:23.693996 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25c30d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a276d6dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25c42400>]}
2021-10-07 19:24:23.750175 (MainThread): Partial parsing not enabled
2021-10-07 19:24:23.758887 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:24:23.763504 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:24:23.789203 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:24:23.792660 (MainThread): Parsing macros/relations.sql
2021-10-07 19:24:23.795073 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:24:23.798706 (MainThread): Parsing macros/core.sql
2021-10-07 19:24:23.804636 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:24:23.866745 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:24:23.870727 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:24:23.874544 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:24:23.890810 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:24:23.893856 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:24:23.895847 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:24:23.897715 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:24:23.909298 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:24:23.934644 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:24:23.937331 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:24:23.981722 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:24:24.007855 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:24:24.018160 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:24:24.021804 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:24:24.041484 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:24:24.048289 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:24:24.056203 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:24:24.066485 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:24:24.069423 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:24:24.071897 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:24:24.074819 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:24:24.092863 (MainThread): Partial parsing not enabled
2021-10-07 19:24:24.150931 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:24:24.196694 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:24:24.239725 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:24:24.568266 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:24:24.580966 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a463857c-256f-445e-8e5c-e21ffdeae495', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25a10280>]}
2021-10-07 19:24:24.638624 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 19:24:24.639234 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:24:24.639768 (MainThread): On macro_Luhns: BEGIN
2021-10-07 19:24:24.640402 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:24:24.645347 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:24:24.646043 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:24:24.646596 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:24:24.647201 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:24:24.648019 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:24:24.654121 (MainThread): 10.0
2021-10-07 19:24:24.654774 (MainThread): True
2021-10-07 19:24:24.655433 (MainThread): On macro_Luhns: Close
2021-10-07 19:24:24.656360 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25c30d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25adc8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5a25adca00>]}
2021-10-07 19:24:24.657199 (MainThread): Flushing usage events
2021-10-07 19:24:26.728719 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 19:24:38.549911 (MainThread): Running with dbt=0.19.0
2021-10-07 19:24:38.722233 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:24:38.728544 (MainThread): Tracking: tracking
2021-10-07 19:24:38.731351 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f809c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea112b0e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f81b370>]}
2021-10-07 19:24:38.778183 (MainThread): Partial parsing not enabled
2021-10-07 19:24:38.787331 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:24:38.791630 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:24:38.818218 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:24:38.821759 (MainThread): Parsing macros/relations.sql
2021-10-07 19:24:38.824548 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:24:38.828259 (MainThread): Parsing macros/core.sql
2021-10-07 19:24:38.833958 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:24:38.884160 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:24:38.887512 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:24:38.890585 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:24:38.906492 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:24:38.911256 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:24:38.914624 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:24:38.917973 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:24:38.945487 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:24:38.990138 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:24:38.994146 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:24:39.032557 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:24:39.066859 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:24:39.084741 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:24:39.091228 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:24:39.133455 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:24:39.148548 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:24:39.167092 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:24:39.183804 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:24:39.189153 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:24:39.194581 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:24:39.200694 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:24:39.235813 (MainThread): Partial parsing not enabled
2021-10-07 19:24:39.346202 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:24:39.414954 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:24:39.488241 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:24:39.903279 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:24:39.909852 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b3024f01-6b96-41de-b2a8-ebb0aa7e476e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f5ea100>]}
2021-10-07 19:24:39.963843 (MainThread): Acquiring new postgres connection "macro_Luhns".
2021-10-07 19:24:39.964445 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:24:39.964960 (MainThread): On macro_Luhns: BEGIN
2021-10-07 19:24:39.965460 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:24:39.970459 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:24:39.971218 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:24:39.972004 (MainThread): Using postgres connection "macro_Luhns".
2021-10-07 19:24:39.972542 (MainThread): On macro_Luhns: COMMIT
2021-10-07 19:24:39.973432 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:24:39.978496 (MainThread): 10.0
2021-10-07 19:24:39.979159 (MainThread): True
2021-10-07 19:24:39.979799 (MainThread): On macro_Luhns: Close
2021-10-07 19:24:39.980775 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f809c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f6a92b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea0f6a9a30>]}
2021-10-07 19:24:39.981481 (MainThread): Flushing usage events
2021-10-07 19:24:40.558599 (MainThread): Connection 'macro_Luhns' was properly closed.
2021-10-07 19:25:04.082810 (MainThread): Running with dbt=0.19.0
2021-10-07 19:25:04.216066 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:25:04.221932 (MainThread): Tracking: tracking
2021-10-07 19:25:04.224207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c1f2bc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c39d3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c1f3d3a0>]}
2021-10-07 19:25:04.269883 (MainThread): Partial parsing not enabled
2021-10-07 19:25:04.291360 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:25:04.299324 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c1f19880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c1f52970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35c1f529a0>]}
2021-10-07 19:25:04.300481 (MainThread): Flushing usage events
2021-10-07 19:25:04.890451 (MainThread): Encountered an error:
2021-10-07 19:25:04.892505 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  unexpected char '$' at 89
    line 4
      {{log( $1::cn, True)}}
2021-10-07 19:25:04.901391 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 4, in template
jinja2.exceptions.TemplateSyntaxError: unexpected char '$' at 89
  line 4
    {{log( $1::cn, True)}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  unexpected char '$' at 89
    line 4
      {{log( $1::cn, True)}}

2021-10-07 19:25:15.082375 (MainThread): Running with dbt=0.19.0
2021-10-07 19:25:15.289994 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:25:15.294708 (MainThread): Tracking: tracking
2021-10-07 19:25:15.296934 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41c77df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba4371efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41c89400>]}
2021-10-07 19:25:15.336284 (MainThread): Partial parsing not enabled
2021-10-07 19:25:15.351214 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:25:15.355207 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41c77ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41c98a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba41c98e80>]}
2021-10-07 19:25:15.356037 (MainThread): Flushing usage events
2021-10-07 19:25:15.948358 (MainThread): Encountered an error:
2021-10-07 19:25:15.951716 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token ',', got ':'
    line 4
      {{log( 1::cn, True)}}
2021-10-07 19:25:15.966907 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 4, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 4
    {{log( 1::cn, True)}}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token ',', got ':'
    line 4
      {{log( 1::cn, True)}}

2021-10-07 19:25:53.664735 (MainThread): Running with dbt=0.19.0
2021-10-07 19:25:53.790591 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:25:53.796233 (MainThread): Tracking: tracking
2021-10-07 19:25:53.798602 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf46b1ed00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf485c6d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf46b303a0>]}
2021-10-07 19:25:53.842092 (MainThread): Partial parsing not enabled
2021-10-07 19:25:53.852302 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:25:53.855939 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf46b0dd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf46abc8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf46abc910>]}
2021-10-07 19:25:53.856715 (MainThread): Flushing usage events
2021-10-07 19:25:54.492129 (MainThread): Encountered an error:
2021-10-07 19:25:54.495281 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  unexpected char '$' at 64
    line 3
      {% set a = $1::cn %}
2021-10-07 19:25:54.512366 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: unexpected char '$' at 64
  line 3
    {% set a = $1::cn %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  unexpected char '$' at 64
    line 3
      {% set a = $1::cn %}

2021-10-07 19:26:10.601790 (MainThread): Running with dbt=0.19.0
2021-10-07 19:26:10.733118 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:26:10.739112 (MainThread): Tracking: tracking
2021-10-07 19:26:10.741695 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34f9e3b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd35148be80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34f9f4370>]}
2021-10-07 19:26:10.787563 (MainThread): Partial parsing not enabled
2021-10-07 19:26:10.912088 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:26:10.924843 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34f9e3970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34fa0a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd34fa0adc0>]}
2021-10-07 19:26:10.926590 (MainThread): Flushing usage events
2021-10-07 19:26:11.530895 (MainThread): Encountered an error:
2021-10-07 19:26:11.534594 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}
2021-10-07 19:26:11.551855 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {% set a = 1::cn %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}

2021-10-07 19:32:56.289969 (MainThread): Running with dbt=0.19.0
2021-10-07 19:32:56.425428 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='Luhns', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:32:56.431461 (MainThread): Tracking: tracking
2021-10-07 19:32:56.434144 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ce354d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2cfdfbdc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ce365400>]}
2021-10-07 19:32:56.479055 (MainThread): Partial parsing not enabled
2021-10-07 19:32:56.494400 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:32:56.498632 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ce354ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ce375a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ce375ee0>]}
2021-10-07 19:32:56.499218 (MainThread): Flushing usage events
2021-10-07 19:32:57.143562 (MainThread): Encountered an error:
2021-10-07 19:32:57.148506 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}
2021-10-07 19:32:57.162213 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {% set a = 1::cn %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}

2021-10-07 19:33:26.837099 (MainThread): Running with dbt=0.19.0
2021-10-07 19:33:26.963061 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify2', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:33:26.968920 (MainThread): Tracking: tracking
2021-10-07 19:33:26.971544 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff598de1ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff59a889d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff598df3370>]}
2021-10-07 19:33:27.012425 (MainThread): Partial parsing not enabled
2021-10-07 19:33:27.020356 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:33:27.024724 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff598de1bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff598e089a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff598e08e20>]}
2021-10-07 19:33:27.025467 (MainThread): Flushing usage events
2021-10-07 19:33:27.631586 (MainThread): Encountered an error:
2021-10-07 19:33:27.635488 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}
2021-10-07 19:33:27.650040 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {% set a = 1::cn %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}

2021-10-07 19:35:12.107843 (MainThread): Running with dbt=0.19.0
2021-10-07 19:35:12.323564 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify3', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:35:12.338406 (MainThread): Tracking: tracking
2021-10-07 19:35:12.345095 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaadfe6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaafa8dca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaadff6310>]}
2021-10-07 19:35:12.404701 (MainThread): Partial parsing not enabled
2021-10-07 19:35:12.432040 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:35:12.440481 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaadffcd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaae00c940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffaae00cdc0>]}
2021-10-07 19:35:12.441639 (MainThread): Flushing usage events
2021-10-07 19:35:13.110490 (MainThread): Encountered an error:
2021-10-07 19:35:13.116297 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}
2021-10-07 19:35:13.129846 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {% set a = 1::cn %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}

2021-10-07 19:36:15.919602 (MainThread): Running with dbt=0.19.0
2021-10-07 19:36:16.237757 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify3', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:36:16.243506 (MainThread): Tracking: tracking
2021-10-07 19:36:16.245916 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71ce13c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71e8bbcd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71ce25340>]}
2021-10-07 19:36:16.289317 (MainThread): Partial parsing not enabled
2021-10-07 19:36:16.299343 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:36:16.303842 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71ce13bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71ce3b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71ce3bdc0>]}
2021-10-07 19:36:16.304478 (MainThread): Flushing usage events
2021-10-07 19:36:16.915775 (MainThread): Encountered an error:
2021-10-07 19:36:16.916959 (MainThread): Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}
2021-10-07 19:36:16.919712 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 535, in parse
    self.handle_exception(source=source)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 3, in template
jinja2.exceptions.TemplateSyntaxError: expected token 'end of statement block', got ':'
  line 3
    {% set a = 1::cn %}

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 52, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 26, in get_full_manifest
    internal: Manifest = adapter.load_macro_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 277, in load_macro_manifest
    manifest = load_macro_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 846, in load_macro_manifest
    return ManifestLoader.load_macros(config, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 457, in load_macros
    return loader.load_only_macros()
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 261, in load_only_macros
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 110, in parse_file
    for node in self.parse_unparsed_macros(base_node):
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/macros.py", line 67, in parse_unparsed_macros
    ast = jinja.parse(block.full_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 509, in parse
    return get_environment().parse(str(string))
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in macro (macros/luhn_verify.sql)
  expected token 'end of statement block', got ':'
    line 3
      {% set a = 1::cn %}

2021-10-07 19:36:30.023800 (MainThread): Running with dbt=0.19.0
2021-10-07 19:36:30.158215 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify3', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:36:30.163944 (MainThread): Tracking: tracking
2021-10-07 19:36:30.166097 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69474ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf6af1bfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69485400>]}
2021-10-07 19:36:30.208171 (MainThread): Partial parsing not enabled
2021-10-07 19:36:30.216316 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:36:30.217919 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:36:30.245224 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:36:30.249189 (MainThread): Parsing macros/relations.sql
2021-10-07 19:36:30.251494 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:36:30.256773 (MainThread): Parsing macros/core.sql
2021-10-07 19:36:30.262653 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:36:30.323604 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:36:30.326633 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:36:30.329304 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:36:30.340827 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:36:30.344349 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:36:30.346646 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:36:30.348279 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:36:30.361380 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:36:30.390028 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:36:30.392769 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:36:30.430724 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:36:30.455131 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:36:30.463840 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:36:30.466785 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:36:30.484475 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:36:30.492182 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:36:30.501760 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:36:30.510318 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:36:30.512763 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:36:30.515319 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:36:30.517984 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:36:30.547954 (MainThread): Partial parsing not enabled
2021-10-07 19:36:30.606395 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:36:30.639681 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:36:30.673703 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:36:30.922233 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:36:30.928747 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '954cfb6e-a3ca-4e2e-bc29-cbaf13274cd1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf692c6a00>]}
2021-10-07 19:36:30.981522 (MainThread): Acquiring new postgres connection "macro_luhn_verify3".
2021-10-07 19:36:30.982068 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:36:30.982622 (MainThread): On macro_luhn_verify3: BEGIN
2021-10-07 19:36:30.983174 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:36:30.988520 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:36:30.989232 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:36:30.990009 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:36:30.990773 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:36:30.991773 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:36:30.994810 (MainThread): Error running SQL: macro luhn_verify3
2021-10-07 19:36:30.995339 (MainThread): Rolling back transaction.
2021-10-07 19:36:30.995853 (MainThread): On macro_luhn_verify3: Close
2021-10-07 19:36:30.996615 (MainThread): Encountered an error while running operation: Compilation Error in macro luhn_verify3 (macros/luhn_verify.sql)
  macro 'dbt_macro__luhn_verify3' takes no keyword argument 'cc'
2021-10-07 19:36:30.997136 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 663, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__luhn_verify3' takes no keyword argument 'cc'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro luhn_verify3 (macros/luhn_verify.sql)
  macro 'dbt_macro__luhn_verify3' takes no keyword argument 'cc'
2021-10-07 19:36:30.999799 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69474ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69236e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcf69236f70>]}
2021-10-07 19:36:31.000435 (MainThread): Flushing usage events
2021-10-07 19:36:31.537086 (MainThread): Connection 'macro_luhn_verify3' was properly closed.
2021-10-07 19:37:03.815969 (MainThread): Running with dbt=0.19.0
2021-10-07 19:37:03.948875 (MainThread): running dbt with arguments Namespace(args='{column: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify3', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:37:03.955116 (MainThread): Tracking: tracking
2021-10-07 19:37:03.957329 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8ac47b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8c6eee50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8ac58340>]}
2021-10-07 19:37:04.000005 (MainThread): Partial parsing not enabled
2021-10-07 19:37:04.008123 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:37:04.009984 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:37:04.038940 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:37:04.044437 (MainThread): Parsing macros/relations.sql
2021-10-07 19:37:04.047151 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:37:04.050967 (MainThread): Parsing macros/core.sql
2021-10-07 19:37:04.056819 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:37:04.114017 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:37:04.116961 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:37:04.119865 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:37:04.132057 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:37:04.134638 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:37:04.136319 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:37:04.137958 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:37:04.149534 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:37:04.178574 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:37:04.181385 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:37:04.217616 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:37:04.240340 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:37:04.250468 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:37:04.253464 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:37:04.272282 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:37:04.279748 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:37:04.288633 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:37:04.297489 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:37:04.301478 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:37:04.305819 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:37:04.309650 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:37:04.328230 (MainThread): Partial parsing not enabled
2021-10-07 19:37:04.384458 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:37:04.418968 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:37:04.453009 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:37:04.702017 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:37:04.707859 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '48ffdf86-3b36-48e5-bc52-ecc60a3beb3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8aa99790>]}
2021-10-07 19:37:04.758024 (MainThread): Acquiring new postgres connection "macro_luhn_verify3".
2021-10-07 19:37:04.758788 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:37:04.759298 (MainThread): On macro_luhn_verify3: BEGIN
2021-10-07 19:37:04.759837 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:37:04.764453 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:37:04.765061 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:37:04.765529 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:37:04.765982 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:37:04.766660 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:37:04.769552 (MainThread): On macro_luhn_verify3: Close
2021-10-07 19:37:04.770447 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8ac47b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8aa07c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f8aa07e80>]}
2021-10-07 19:37:04.771122 (MainThread): Flushing usage events
2021-10-07 19:37:05.343395 (MainThread): Connection 'macro_luhn_verify3' was properly closed.
2021-10-07 19:37:39.597146 (MainThread): Running with dbt=0.19.0
2021-10-07 19:37:39.726923 (MainThread): running dbt with arguments Namespace(args='{column: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify3', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:37:39.731632 (MainThread): Tracking: tracking
2021-10-07 19:37:39.733851 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6926b24dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69285cbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6926b36400>]}
2021-10-07 19:37:39.774177 (MainThread): Partial parsing not enabled
2021-10-07 19:37:39.786704 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:37:39.788336 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:37:39.814542 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:37:39.817894 (MainThread): Parsing macros/relations.sql
2021-10-07 19:37:39.820576 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:37:39.824448 (MainThread): Parsing macros/core.sql
2021-10-07 19:37:39.829938 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:37:39.889091 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:37:39.892053 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:37:39.894702 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:37:39.906505 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:37:39.908980 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:37:39.910765 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:37:39.912649 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:37:39.925064 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:37:39.953219 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:37:39.955923 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:37:39.992263 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:37:40.014627 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:37:40.022924 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:37:40.026007 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:37:40.044394 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:37:40.051199 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:37:40.059678 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:37:40.068202 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:37:40.072257 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:37:40.075758 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:37:40.078768 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:37:40.096709 (MainThread): Partial parsing not enabled
2021-10-07 19:37:40.151684 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:37:40.186581 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:37:40.219919 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:37:40.461253 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:37:40.467451 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'abaf8c56-5a56-41d4-ac15-56b916249f18', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69269778e0>]}
2021-10-07 19:37:40.520020 (MainThread): Acquiring new postgres connection "macro_luhn_verify3".
2021-10-07 19:37:40.520556 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:37:40.520934 (MainThread): On macro_luhn_verify3: BEGIN
2021-10-07 19:37:40.521361 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:37:40.526139 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:37:40.526745 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:37:40.527203 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:37:40.527653 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:37:40.528348 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:37:40.531244 (MainThread): Error running SQL: macro luhn_verify3
2021-10-07 19:37:40.531889 (MainThread): Rolling back transaction.
2021-10-07 19:37:40.532530 (MainThread): On macro_luhn_verify3: Close
2021-10-07 19:37:40.533405 (MainThread): Encountered an error while running operation: Compilation Error in macro luhn_verify3 (macros/luhn_verify.sql)
  macro 'dbt_macro__luhn_verify3' takes no keyword argument 'column'
2021-10-07 19:37:40.534075 (MainThread): 
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 302, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 663, in __call__
    raise TypeError(
TypeError: macro 'dbt_macro__luhn_verify3' takes no keyword argument 'column'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 54, in run
    self._run_unsafe()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run_operation.py", line 41, in _run_unsafe
    res = adapter.execute_macro(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 1002, in execute_macro
    result = macro_function(**kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 259, in call_macro
    return e.value
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 304, in exception_handler
    raise_compiler_error(str(e), self.macro)
  File "/usr/local/lib/python3.8/site-packages/dbt/exceptions.py", line 435, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in macro luhn_verify3 (macros/luhn_verify.sql)
  macro 'dbt_macro__luhn_verify3' takes no keyword argument 'column'
2021-10-07 19:37:40.537540 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6926b24dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69268e6e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f69268e6f70>]}
2021-10-07 19:37:40.538415 (MainThread): Flushing usage events
2021-10-07 19:37:41.123385 (MainThread): Connection 'macro_luhn_verify3' was properly closed.
2021-10-07 19:37:49.982063 (MainThread): Running with dbt=0.19.0
2021-10-07 19:37:50.112965 (MainThread): running dbt with arguments Namespace(args='{cc: 100}', cls=<class 'dbt.task.run_operation.RunOperationTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', macro='luhn_verify3', partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run-operation', single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='run-operation', write_json=True)
2021-10-07 19:37:50.118561 (MainThread): Tracking: tracking
2021-10-07 19:37:50.120869 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d354b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7edfbdf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d3663a0>]}
2021-10-07 19:37:50.163328 (MainThread): Partial parsing not enabled
2021-10-07 19:37:50.174673 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:37:50.176803 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:37:50.204492 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:37:50.207826 (MainThread): Parsing macros/relations.sql
2021-10-07 19:37:50.210073 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:37:50.213651 (MainThread): Parsing macros/core.sql
2021-10-07 19:37:50.218835 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:37:50.275239 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:37:50.279468 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:37:50.283315 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:37:50.295964 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:37:50.298480 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:37:50.300424 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:37:50.302069 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:37:50.314282 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:37:50.341515 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:37:50.344325 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:37:50.382119 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:37:50.405717 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:37:50.413952 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:37:50.416716 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:37:50.435330 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:37:50.442946 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:37:50.451803 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:37:50.461171 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:37:50.463857 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:37:50.466293 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:37:50.469070 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:37:50.488780 (MainThread): Partial parsing not enabled
2021-10-07 19:37:50.545112 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:37:50.577621 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:37:50.612812 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:37:50.855347 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:37:50.861323 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82b9aebd-1827-48d3-9c4d-e498a39bc90a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d1a88e0>]}
2021-10-07 19:37:50.914211 (MainThread): Acquiring new postgres connection "macro_luhn_verify3".
2021-10-07 19:37:50.914870 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:37:50.915406 (MainThread): On macro_luhn_verify3: BEGIN
2021-10-07 19:37:50.915939 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:37:50.921059 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:37:50.921777 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:37:50.922327 (MainThread): Using postgres connection "macro_luhn_verify3".
2021-10-07 19:37:50.922852 (MainThread): On macro_luhn_verify3: COMMIT
2021-10-07 19:37:50.923753 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:37:50.926768 (MainThread): On macro_luhn_verify3: Close
2021-10-07 19:37:50.928761 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d354b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d115ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3f7d115ee0>]}
2021-10-07 19:37:50.929468 (MainThread): Flushing usage events
2021-10-07 19:37:51.481426 (MainThread): Connection 'macro_luhn_verify3' was properly closed.
2021-10-07 19:38:21.363261 (MainThread): Running with dbt=0.19.0
2021-10-07 19:38:21.492762 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:38:21.497633 (MainThread): Tracking: tracking
2021-10-07 19:38:21.499920 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bacd0d9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bae7392b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bacd1f190>]}
2021-10-07 19:38:21.542619 (MainThread): Partial parsing not enabled
2021-10-07 19:38:21.550580 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:38:21.552146 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:38:21.578626 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:38:21.582186 (MainThread): Parsing macros/relations.sql
2021-10-07 19:38:21.584412 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:38:21.588412 (MainThread): Parsing macros/core.sql
2021-10-07 19:38:21.594288 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:38:21.647079 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:38:21.650400 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:38:21.653544 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:38:21.669267 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:38:21.672758 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:38:21.674840 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:38:21.676566 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:38:21.688320 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:38:21.717270 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:38:21.720086 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:38:21.757620 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:38:21.781113 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:38:21.792004 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:38:21.794913 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:38:21.813030 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:38:21.820307 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:38:21.828453 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:38:21.836941 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:38:21.839545 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:38:21.842073 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:38:21.845053 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:38:21.861773 (MainThread): Partial parsing not enabled
2021-10-07 19:38:21.914207 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:38:21.952201 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:38:21.985872 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:38:23.000966 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:38:23.007552 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee5f6a24-9338-4cec-8c2b-89127d106d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bacb62880>]}
2021-10-07 19:38:23.067845 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:38:23.070088 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:38:23.071644 (MainThread): 
2021-10-07 19:38:23.072652 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:38:23.076291 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:38:23.090845 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:38:23.091540 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:38:23.092174 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:38:23.098313 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:38:23.102049 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:38:23.108439 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:38:23.117111 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:38:23.117634 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:38:23.118060 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:38:23.122977 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:23.123704 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:38:23.124490 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:38:23.128309 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:38:23.140687 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:38:23.141782 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:38:23.152996 (MainThread): Using postgres connection "master".
2021-10-07 19:38:23.153490 (MainThread): On master: BEGIN
2021-10-07 19:38:23.153858 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:38:23.159563 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:38:23.160471 (MainThread): Using postgres connection "master".
2021-10-07 19:38:23.161081 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:38:23.167624 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:38:23.168424 (MainThread): On master: ROLLBACK
2021-10-07 19:38:23.169128 (MainThread): Using postgres connection "master".
2021-10-07 19:38:23.169591 (MainThread): On master: BEGIN
2021-10-07 19:38:23.170658 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:23.171214 (MainThread): On master: COMMIT
2021-10-07 19:38:23.171695 (MainThread): Using postgres connection "master".
2021-10-07 19:38:23.172160 (MainThread): On master: COMMIT
2021-10-07 19:38:23.172959 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:38:23.173548 (MainThread): On master: Close
2021-10-07 19:38:23.174362 (MainThread): 19:38:23 | Concurrency: 2 threads (target='dev')
2021-10-07 19:38:23.174914 (MainThread): 19:38:23 | 
2021-10-07 19:38:23.179966 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:38:23.181872 (Thread-1): 19:38:23 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:38:23.182854 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:38:23.183431 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:38:23.205939 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:38:23.219649 (Thread-1): finished collecting timing info
2021-10-07 19:38:23.250471 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:23.251246 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:38:23.251701 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:38:23.255424 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:38:23.258917 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:23.259514 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:38:23.260273 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:38:23.274383 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:38:23.285189 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:23.285689 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:38:23.286466 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:23.287039 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:23.287575 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn_verify3(creditcard) = FALSE
GROUP BY orderdate
  );
2021-10-07 19:38:23.289088 (Thread-1): Postgres error: function luhn_verify3(character varying) does not exist
LINE 19: WHERE luhn_verify3(creditcard) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 19:38:23.289758 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:38:23.290614 (Thread-1): finished collecting timing info
2021-10-07 19:38:23.291370 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:38:23.292145 (Thread-1): Database Error in model task2 (models/task2.sql)
  function luhn_verify3(character varying) does not exist
  LINE 19: WHERE luhn_verify3(creditcard) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn_verify3(character varying) does not exist
LINE 19: WHERE luhn_verify3(creditcard) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn_verify3(character varying) does not exist
  LINE 19: WHERE luhn_verify3(creditcard) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:38:23.294351 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee5f6a24-9338-4cec-8c2b-89127d106d99', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bac26afd0>]}
2021-10-07 19:38:23.295976 (Thread-1): 19:38:23 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:38:23.296528 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:38:23.300164 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:38:23.300768 (MainThread): Using postgres connection "master".
2021-10-07 19:38:23.301386 (MainThread): On master: BEGIN
2021-10-07 19:38:23.301868 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:38:23.306512 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:23.307294 (MainThread): On master: COMMIT
2021-10-07 19:38:23.308046 (MainThread): Using postgres connection "master".
2021-10-07 19:38:23.308843 (MainThread): On master: COMMIT
2021-10-07 19:38:23.310209 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:38:23.311004 (MainThread): On master: Close
2021-10-07 19:38:23.312169 (MainThread): 19:38:23 | 
2021-10-07 19:38:23.312917 (MainThread): 19:38:23 | Finished running 1 table model in 0.24s.
2021-10-07 19:38:23.313560 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:38:23.313960 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:38:23.371248 (MainThread): 
2021-10-07 19:38:23.371997 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:38:23.372845 (MainThread): 
2021-10-07 19:38:23.374290 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:38:23.375972 (MainThread):   function luhn_verify3(character varying) does not exist
2021-10-07 19:38:23.377740 (MainThread):   LINE 19: WHERE luhn_verify3(creditcard) = FALSE
2021-10-07 19:38:23.378688 (MainThread):                  ^
2021-10-07 19:38:23.379458 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 19:38:23.380664 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:38:23.381750 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:38:23.382866 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bac26afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bacb55760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1bacbac160>]}
2021-10-07 19:38:23.383586 (MainThread): Flushing usage events
2021-10-07 19:38:44.942051 (MainThread): Running with dbt=0.19.0
2021-10-07 19:38:45.078596 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:38:45.084715 (MainThread): Tracking: tracking
2021-10-07 19:38:45.086924 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee6fa9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1f01a5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee70b1c0>]}
2021-10-07 19:38:45.129733 (MainThread): Partial parsing not enabled
2021-10-07 19:38:45.136524 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:38:45.138331 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:38:45.167824 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:38:45.171201 (MainThread): Parsing macros/relations.sql
2021-10-07 19:38:45.173608 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:38:45.176990 (MainThread): Parsing macros/core.sql
2021-10-07 19:38:45.183110 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:38:45.239143 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:38:45.243053 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:38:45.245889 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:38:45.259165 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:38:45.262366 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:38:45.264359 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:38:45.265947 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:38:45.277315 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:38:45.306754 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:38:45.309500 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:38:45.347321 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:38:45.371620 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:38:45.379958 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:38:45.382736 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:38:45.401601 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:38:45.408236 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:38:45.416395 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:38:45.425735 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:38:45.428779 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:38:45.431159 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:38:45.433959 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:38:45.452501 (MainThread): Partial parsing not enabled
2021-10-07 19:38:45.511292 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:38:45.550698 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:38:45.585850 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:38:45.833646 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:38:45.841652 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6eec323-c6ee-4d06-8593-1a5acf056448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee550eb0>]}
2021-10-07 19:38:45.899369 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:38:45.901711 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:38:45.904591 (MainThread): 
2021-10-07 19:38:45.906920 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:38:45.909928 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:38:45.925086 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:38:45.925957 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:38:45.926769 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:38:45.932504 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:38:45.935723 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:38:45.942505 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:38:45.951660 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:38:45.952236 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:38:45.952672 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:38:45.956644 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:45.957426 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:38:45.957988 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:38:45.961417 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:38:45.972211 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:38:45.973334 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:38:45.985265 (MainThread): Using postgres connection "master".
2021-10-07 19:38:45.985893 (MainThread): On master: BEGIN
2021-10-07 19:38:45.986372 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:38:45.990530 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:45.991281 (MainThread): Using postgres connection "master".
2021-10-07 19:38:45.991733 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:38:45.996920 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:38:45.997623 (MainThread): On master: ROLLBACK
2021-10-07 19:38:45.998380 (MainThread): Using postgres connection "master".
2021-10-07 19:38:45.998882 (MainThread): On master: BEGIN
2021-10-07 19:38:46.000076 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:46.000581 (MainThread): On master: COMMIT
2021-10-07 19:38:46.001007 (MainThread): Using postgres connection "master".
2021-10-07 19:38:46.001411 (MainThread): On master: COMMIT
2021-10-07 19:38:46.002068 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:38:46.002538 (MainThread): On master: Close
2021-10-07 19:38:46.003341 (MainThread): 19:38:45 | Concurrency: 2 threads (target='dev')
2021-10-07 19:38:46.003972 (MainThread): 19:38:45 | 
2021-10-07 19:38:46.009317 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:38:46.011412 (Thread-1): 19:38:45 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:38:46.012295 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:38:46.012939 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:38:46.033879 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:38:46.143954 (Thread-1): finished collecting timing info
2021-10-07 19:38:46.173627 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:46.174421 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:38:46.175130 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:38:46.179485 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:38:46.182835 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:46.183396 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:38:46.184235 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:38:46.196704 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:38:46.236175 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:46.236657 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:38:46.237420 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:38:46.238025 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:38:46.238569 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

validations as (
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::cc::int8 / (10^n)::cc::int8 ), 10::cc::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$
)

SELECT * FROM validations

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:38:46.239758 (Thread-1): Postgres error: syntax error at or near "as"
LINE 21: validations as (
                     ^

2021-10-07 19:38:46.240429 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:38:46.241369 (Thread-1): finished collecting timing info
2021-10-07 19:38:46.242225 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:38:46.243200 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "as"
  LINE 21: validations as (
                       ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "as"
LINE 21: validations as (
                     ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "as"
  LINE 21: validations as (
                       ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:38:46.245348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6eec323-c6ee-4d06-8593-1a5acf056448', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee4b0640>]}
2021-10-07 19:38:46.247057 (Thread-1): 19:38:46 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.23s]
2021-10-07 19:38:46.247687 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:38:46.250616 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:38:46.251433 (MainThread): Using postgres connection "master".
2021-10-07 19:38:46.251932 (MainThread): On master: BEGIN
2021-10-07 19:38:46.252716 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:38:46.257830 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:38:46.258524 (MainThread): On master: COMMIT
2021-10-07 19:38:46.259240 (MainThread): Using postgres connection "master".
2021-10-07 19:38:46.260166 (MainThread): On master: COMMIT
2021-10-07 19:38:46.261655 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:38:46.262443 (MainThread): On master: Close
2021-10-07 19:38:46.263311 (MainThread): 19:38:46 | 
2021-10-07 19:38:46.263856 (MainThread): 19:38:46 | Finished running 1 table model in 0.36s.
2021-10-07 19:38:46.264545 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:38:46.265106 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:38:46.321594 (MainThread): 
2021-10-07 19:38:46.322357 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:38:46.322819 (MainThread): 
2021-10-07 19:38:46.324168 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:38:46.325334 (MainThread):   syntax error at or near "as"
2021-10-07 19:38:46.326548 (MainThread):   LINE 21: validations as (
2021-10-07 19:38:46.327238 (MainThread):                        ^
2021-10-07 19:38:46.328243 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:38:46.329678 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:38:46.330760 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee4b06d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1ee4c5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd1edc40250>]}
2021-10-07 19:38:46.332029 (MainThread): Flushing usage events
2021-10-07 19:39:07.225308 (MainThread): Running with dbt=0.19.0
2021-10-07 19:39:07.428932 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:39:07.434967 (MainThread): Tracking: tracking
2021-10-07 19:39:07.437210 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71485dbbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714bbe2400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71485eb0d0>]}
2021-10-07 19:39:07.480805 (MainThread): Partial parsing not enabled
2021-10-07 19:39:07.492430 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:39:07.494799 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:39:07.521953 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:39:07.525653 (MainThread): Parsing macros/relations.sql
2021-10-07 19:39:07.528068 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:39:07.531655 (MainThread): Parsing macros/core.sql
2021-10-07 19:39:07.537148 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:39:07.591383 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:39:07.594367 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:39:07.596831 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:39:07.609432 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:39:07.611928 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:39:07.613627 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:39:07.615227 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:39:07.629624 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:39:07.657349 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:39:07.660134 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:39:07.698013 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:39:07.723997 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:39:07.732294 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:39:07.735023 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:39:07.752177 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:39:07.758853 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:39:07.767476 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:39:07.776483 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:39:07.779020 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:39:07.781409 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:39:07.784152 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:39:07.802291 (MainThread): Partial parsing not enabled
2021-10-07 19:39:07.855394 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:39:07.888900 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:39:07.922202 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:39:08.187819 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:39:08.195433 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cc1e192c-18dc-4b03-b119-04835c9acb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f714842fd90>]}
2021-10-07 19:39:08.254721 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:39:08.257688 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:39:08.259374 (MainThread): 
2021-10-07 19:39:08.260272 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:39:08.264370 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:39:08.279645 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:39:08.280539 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:39:08.281160 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:39:08.286041 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-07 19:39:08.289825 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:39:08.296977 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:39:08.304348 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:39:08.304906 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:39:08.305414 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:39:08.310863 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:39:08.311532 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:39:08.312108 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:39:08.314814 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:39:08.326118 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:39:08.326992 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:39:08.337096 (MainThread): Using postgres connection "master".
2021-10-07 19:39:08.337918 (MainThread): On master: BEGIN
2021-10-07 19:39:08.338594 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:39:08.343426 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:39:08.343979 (MainThread): Using postgres connection "master".
2021-10-07 19:39:08.344437 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:39:08.349991 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:39:08.350747 (MainThread): On master: ROLLBACK
2021-10-07 19:39:08.351382 (MainThread): Using postgres connection "master".
2021-10-07 19:39:08.351785 (MainThread): On master: BEGIN
2021-10-07 19:39:08.352711 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:39:08.353339 (MainThread): On master: COMMIT
2021-10-07 19:39:08.353724 (MainThread): Using postgres connection "master".
2021-10-07 19:39:08.354115 (MainThread): On master: COMMIT
2021-10-07 19:39:08.354818 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:39:08.355325 (MainThread): On master: Close
2021-10-07 19:39:08.356028 (MainThread): 19:39:08 | Concurrency: 2 threads (target='dev')
2021-10-07 19:39:08.356686 (MainThread): 19:39:08 | 
2021-10-07 19:39:08.361026 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:39:08.362916 (Thread-1): 19:39:08 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:39:08.363666 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:39:08.364437 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:39:08.387429 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:39:08.400909 (Thread-1): finished collecting timing info
2021-10-07 19:39:08.431478 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:39:08.432183 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:39:08.432759 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:39:08.437229 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:39:08.441368 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:39:08.442111 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:39:08.443136 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:39:08.457882 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:39:08.469744 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:39:08.470099 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:39:08.470770 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:39:08.471157 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:39:08.471475 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

validations AS (
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::cc::int8 / (10^n)::cc::int8 ), 10::cc::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$
)

SELECT * FROM validations

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:39:08.472146 (Thread-1): Postgres error: syntax error at or near "AS"
LINE 21: validations AS (
                     ^

2021-10-07 19:39:08.472508 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:39:08.473160 (Thread-1): finished collecting timing info
2021-10-07 19:39:08.473754 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:39:08.474453 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21: validations AS (
                       ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "AS"
LINE 21: validations AS (
                     ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21: validations AS (
                       ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:39:08.476832 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cc1e192c-18dc-4b03-b119-04835c9acb1d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f71484a2e50>]}
2021-10-07 19:39:08.478547 (Thread-1): 19:39:08 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:39:08.479170 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:39:08.483031 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:39:08.483640 (MainThread): Using postgres connection "master".
2021-10-07 19:39:08.484282 (MainThread): On master: BEGIN
2021-10-07 19:39:08.484796 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:39:08.490320 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:39:08.491139 (MainThread): On master: COMMIT
2021-10-07 19:39:08.491908 (MainThread): Using postgres connection "master".
2021-10-07 19:39:08.492536 (MainThread): On master: COMMIT
2021-10-07 19:39:08.493317 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:39:08.494029 (MainThread): On master: Close
2021-10-07 19:39:08.494981 (MainThread): 19:39:08 | 
2021-10-07 19:39:08.495567 (MainThread): 19:39:08 | Finished running 1 table model in 0.23s.
2021-10-07 19:39:08.496097 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:39:08.496432 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:39:08.556049 (MainThread): 
2021-10-07 19:39:08.556723 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:39:08.557734 (MainThread): 
2021-10-07 19:39:08.558721 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:39:08.559453 (MainThread):   syntax error at or near "AS"
2021-10-07 19:39:08.560601 (MainThread):   LINE 21: validations AS (
2021-10-07 19:39:08.561470 (MainThread):                        ^
2021-10-07 19:39:08.562927 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:39:08.563773 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:39:08.564860 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7147b3a4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7145ac3ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7145ac3b50>]}
2021-10-07 19:39:08.566080 (MainThread): Flushing usage events
2021-10-07 19:40:22.607173 (MainThread): Running with dbt=0.19.0
2021-10-07 19:40:22.735956 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:40:22.741794 (MainThread): Tracking: tracking
2021-10-07 19:40:22.744067 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa761800940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa764e07460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa761812130>]}
2021-10-07 19:40:22.789022 (MainThread): Partial parsing not enabled
2021-10-07 19:40:22.799585 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:40:22.801362 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:40:22.828984 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:40:22.833394 (MainThread): Parsing macros/relations.sql
2021-10-07 19:40:22.835725 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:40:22.840672 (MainThread): Parsing macros/core.sql
2021-10-07 19:40:22.846953 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:40:22.903395 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:40:22.906479 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:40:22.908998 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:40:22.921428 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:40:22.924176 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:40:22.926057 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:40:22.927643 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:40:22.939618 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:40:22.967150 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:40:22.969987 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:40:23.005591 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:40:23.028237 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:40:23.037136 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:40:23.040216 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:40:23.058688 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:40:23.065453 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:40:23.073764 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:40:23.084685 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:40:23.087315 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:40:23.089796 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:40:23.092494 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:40:23.109626 (MainThread): Partial parsing not enabled
2021-10-07 19:40:23.167685 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:40:23.200640 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:40:23.234982 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:40:23.497817 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:40:23.504975 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f9a62192-f2e3-4d97-8ed7-dad8279773bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa761654e50>]}
2021-10-07 19:40:23.563908 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:40:23.566167 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:40:23.568291 (MainThread): 
2021-10-07 19:40:23.570271 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:40:23.573198 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:40:23.588231 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:40:23.588918 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:40:23.589634 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:40:23.595720 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:40:23.599818 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:40:23.605991 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:40:23.614726 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:40:23.615365 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:40:23.615879 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:40:23.620048 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:23.620618 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:40:23.621193 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:40:23.624381 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:40:23.637933 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:40:23.638906 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:40:23.649816 (MainThread): Using postgres connection "master".
2021-10-07 19:40:23.650432 (MainThread): On master: BEGIN
2021-10-07 19:40:23.650940 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:40:23.655010 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:23.655738 (MainThread): Using postgres connection "master".
2021-10-07 19:40:23.656300 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:40:23.661805 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:40:23.662659 (MainThread): On master: ROLLBACK
2021-10-07 19:40:23.663401 (MainThread): Using postgres connection "master".
2021-10-07 19:40:23.663929 (MainThread): On master: BEGIN
2021-10-07 19:40:23.664988 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:23.665518 (MainThread): On master: COMMIT
2021-10-07 19:40:23.666031 (MainThread): Using postgres connection "master".
2021-10-07 19:40:23.666553 (MainThread): On master: COMMIT
2021-10-07 19:40:23.667321 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:40:23.667859 (MainThread): On master: Close
2021-10-07 19:40:23.668608 (MainThread): 19:40:23 | Concurrency: 2 threads (target='dev')
2021-10-07 19:40:23.669426 (MainThread): 19:40:23 | 
2021-10-07 19:40:23.675079 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:40:23.677110 (Thread-1): 19:40:23 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:40:23.678143 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:40:23.678659 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:40:23.701245 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:40:23.714882 (Thread-1): finished collecting timing info
2021-10-07 19:40:23.745249 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:23.745956 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:40:23.746422 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:40:23.751340 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:40:23.757681 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:23.758313 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:40:23.759317 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:40:23.775010 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:40:23.784397 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:23.784766 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:40:23.785637 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:23.786093 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:23.786528 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

    validations AS (
        SELECT
                MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
        FROM
        (SELECT
                MOD( ( $1::cc::int8 / (10^n)::cc::int8 ), 10::cc::int8)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
    )

    SELECT * FROM validations

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:40:23.787323 (Thread-1): Postgres error: syntax error at or near "AS"
LINE 21:     validations AS (
                         ^

2021-10-07 19:40:23.787748 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:40:23.788417 (Thread-1): finished collecting timing info
2021-10-07 19:40:23.789118 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:40:23.789963 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21:     validations AS (
                           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "AS"
LINE 21:     validations AS (
                         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21:     validations AS (
                           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:40:23.792133 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f9a62192-f2e3-4d97-8ed7-dad8279773bb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7617178b0>]}
2021-10-07 19:40:23.793858 (Thread-1): 19:40:23 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:40:23.794427 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:40:23.797162 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:40:23.797838 (MainThread): Using postgres connection "master".
2021-10-07 19:40:23.798330 (MainThread): On master: BEGIN
2021-10-07 19:40:23.798784 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:40:23.803075 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:23.803745 (MainThread): On master: COMMIT
2021-10-07 19:40:23.804290 (MainThread): Using postgres connection "master".
2021-10-07 19:40:23.804839 (MainThread): On master: COMMIT
2021-10-07 19:40:23.805668 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:40:23.806245 (MainThread): On master: Close
2021-10-07 19:40:23.807565 (MainThread): 19:40:23 | 
2021-10-07 19:40:23.808429 (MainThread): 19:40:23 | Finished running 1 table model in 0.24s.
2021-10-07 19:40:23.808852 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:40:23.809531 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:40:23.863653 (MainThread): 
2021-10-07 19:40:23.864134 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:40:23.865057 (MainThread): 
2021-10-07 19:40:23.866246 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:40:23.867291 (MainThread):   syntax error at or near "AS"
2021-10-07 19:40:23.869386 (MainThread):   LINE 21:     validations AS (
2021-10-07 19:40:23.870498 (MainThread):                            ^
2021-10-07 19:40:23.871538 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:40:23.872153 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:40:23.873089 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa761707f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7615d10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa7615d11f0>]}
2021-10-07 19:40:23.874359 (MainThread): Flushing usage events
2021-10-07 19:40:37.620050 (MainThread): Running with dbt=0.19.0
2021-10-07 19:40:37.747506 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:40:37.752387 (MainThread): Tracking: tracking
2021-10-07 19:40:37.754526 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5210c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e55713430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e5211d100>]}
2021-10-07 19:40:37.796059 (MainThread): Partial parsing not enabled
2021-10-07 19:40:37.806596 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:40:37.808493 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:40:37.834940 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:40:37.838249 (MainThread): Parsing macros/relations.sql
2021-10-07 19:40:37.840662 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:40:37.844356 (MainThread): Parsing macros/core.sql
2021-10-07 19:40:37.849843 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:40:37.908068 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:40:37.911232 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:40:37.913792 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:40:37.927706 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:40:37.930828 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:40:37.933061 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:40:37.934738 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:40:37.947286 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:40:37.974240 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:40:37.976953 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:40:38.012732 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:40:38.034858 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:40:38.042733 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:40:38.045347 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:40:38.062108 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:40:38.068940 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:40:38.076774 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:40:38.086831 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:40:38.089575 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:40:38.091829 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:40:38.094652 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:40:38.112547 (MainThread): Partial parsing not enabled
2021-10-07 19:40:38.175282 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:40:38.213396 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:40:38.260467 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:40:38.512747 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:40:38.518913 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e950eb03-30dd-4260-b932-9f7fa946f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e51f60d30>]}
2021-10-07 19:40:38.582249 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:40:38.584264 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:40:38.585935 (MainThread): 
2021-10-07 19:40:38.587628 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:40:38.590761 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:40:38.607068 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:40:38.608528 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:40:38.609473 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:40:38.614914 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:40:38.618041 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:40:38.624783 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:40:38.633591 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:40:38.634222 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:40:38.634647 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:40:38.638618 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:38.639489 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:40:38.640139 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:40:38.643691 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:40:38.655210 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:40:38.656435 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:40:38.668280 (MainThread): Using postgres connection "master".
2021-10-07 19:40:38.668843 (MainThread): On master: BEGIN
2021-10-07 19:40:38.669319 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:40:38.673494 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:38.674318 (MainThread): Using postgres connection "master".
2021-10-07 19:40:38.675070 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:40:38.680458 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:40:38.681329 (MainThread): On master: ROLLBACK
2021-10-07 19:40:38.682177 (MainThread): Using postgres connection "master".
2021-10-07 19:40:38.682672 (MainThread): On master: BEGIN
2021-10-07 19:40:38.683952 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:38.684501 (MainThread): On master: COMMIT
2021-10-07 19:40:38.685018 (MainThread): Using postgres connection "master".
2021-10-07 19:40:38.685546 (MainThread): On master: COMMIT
2021-10-07 19:40:38.686539 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:40:38.687090 (MainThread): On master: Close
2021-10-07 19:40:38.687902 (MainThread): 19:40:38 | Concurrency: 2 threads (target='dev')
2021-10-07 19:40:38.688564 (MainThread): 19:40:38 | 
2021-10-07 19:40:38.693001 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:40:38.695020 (Thread-1): 19:40:38 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:40:38.695797 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:40:38.696294 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:40:38.719329 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:40:38.731670 (Thread-1): finished collecting timing info
2021-10-07 19:40:38.760887 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:38.761594 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:40:38.762177 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:40:38.767373 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 19:40:38.770893 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:38.771734 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:40:38.772690 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:40:38.786616 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:40:38.799863 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:38.800507 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:40:38.801415 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:38.802020 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:40:38.802566 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

    valid AS (
        SELECT
                MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
        FROM
        (SELECT
                MOD( ( $1::cc::int8 / (10^n)::cc::int8 ), 10::cc::int8)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
    )

    SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:40:38.803569 (Thread-1): Postgres error: syntax error at or near "AS"
LINE 21:     valid AS (
                   ^

2021-10-07 19:40:38.804105 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:40:38.805030 (Thread-1): finished collecting timing info
2021-10-07 19:40:38.805736 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:40:38.806611 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21:     valid AS (
                     ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "AS"
LINE 21:     valid AS (
                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21:     valid AS (
                     ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:40:38.808860 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e950eb03-30dd-4260-b932-9f7fa946f5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e51fb22e0>]}
2021-10-07 19:40:38.810753 (Thread-1): 19:40:38 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:40:38.811418 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:40:38.813987 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:40:38.814569 (MainThread): Using postgres connection "master".
2021-10-07 19:40:38.815042 (MainThread): On master: BEGIN
2021-10-07 19:40:38.815590 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:40:38.819684 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:40:38.820534 (MainThread): On master: COMMIT
2021-10-07 19:40:38.821161 (MainThread): Using postgres connection "master".
2021-10-07 19:40:38.821861 (MainThread): On master: COMMIT
2021-10-07 19:40:38.822763 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:40:38.823852 (MainThread): On master: Close
2021-10-07 19:40:38.824872 (MainThread): 19:40:38 | 
2021-10-07 19:40:38.825566 (MainThread): 19:40:38 | Finished running 1 table model in 0.24s.
2021-10-07 19:40:38.826544 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:40:38.827439 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:40:38.883362 (MainThread): 
2021-10-07 19:40:38.884065 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:40:38.884713 (MainThread): 
2021-10-07 19:40:38.885202 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:40:38.885720 (MainThread):   syntax error at or near "AS"
2021-10-07 19:40:38.886719 (MainThread):   LINE 21:     valid AS (
2021-10-07 19:40:38.887305 (MainThread):                      ^
2021-10-07 19:40:38.888504 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:40:38.889276 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:40:38.891411 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e51ebbf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e51fc9730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7e51ed8b80>]}
2021-10-07 19:40:38.892490 (MainThread): Flushing usage events
2021-10-07 19:41:08.021218 (MainThread): Running with dbt=0.19.0
2021-10-07 19:41:08.160808 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:41:08.166804 (MainThread): Tracking: tracking
2021-10-07 19:41:08.168988 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db17a8940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db4daf460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db17ba130>]}
2021-10-07 19:41:08.214609 (MainThread): Partial parsing not enabled
2021-10-07 19:41:08.223122 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:41:08.224789 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:41:08.252565 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:41:08.257235 (MainThread): Parsing macros/relations.sql
2021-10-07 19:41:08.259878 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:41:08.263539 (MainThread): Parsing macros/core.sql
2021-10-07 19:41:08.268763 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:41:08.329377 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:41:08.332952 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:41:08.335603 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:41:08.347443 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:41:08.350603 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:41:08.352432 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:41:08.354052 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:41:08.366526 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:41:08.395389 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:41:08.398147 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:41:08.438673 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:41:08.462731 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:41:08.470868 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:41:08.473934 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:41:08.493760 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:41:08.501138 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:41:08.509963 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:41:08.519006 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:41:08.521749 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:41:08.524164 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:41:08.526916 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:41:08.543690 (MainThread): Partial parsing not enabled
2021-10-07 19:41:08.598874 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:41:08.636680 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:41:08.641404 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db175af40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db15d3f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0db15ca6d0>]}
2021-10-07 19:41:08.642154 (MainThread): Flushing usage events
2021-10-07 19:41:09.198082 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:41:09.199419 (MainThread): Encountered an error:
2021-10-07 19:41:09.200183 (MainThread): Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify3(creditcard::int8) }}= FALSE
2021-10-07 19:41:09.203180 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 16, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 16
    WHERE {{ luhn_verify3(creditcard::int8) }}= FALSE

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify3(creditcard::int8) }}= FALSE

2021-10-07 19:41:28.935126 (MainThread): Running with dbt=0.19.0
2021-10-07 19:41:29.065858 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:41:29.071857 (MainThread): Tracking: tracking
2021-10-07 19:41:29.074202 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0d464d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b10a6b400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0d4760d0>]}
2021-10-07 19:41:29.121350 (MainThread): Partial parsing not enabled
2021-10-07 19:41:29.227306 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:41:29.230090 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:41:29.255331 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:41:29.259751 (MainThread): Parsing macros/relations.sql
2021-10-07 19:41:29.263313 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:41:29.266958 (MainThread): Parsing macros/core.sql
2021-10-07 19:41:29.272572 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:41:29.328017 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:41:29.331235 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:41:29.333860 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:41:29.344969 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:41:29.348517 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:41:29.350680 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:41:29.352239 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:41:29.364755 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:41:29.394327 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:41:29.397516 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:41:29.435428 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:41:29.458279 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:41:29.467467 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:41:29.470412 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:41:29.490475 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:41:29.497155 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:41:29.505778 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:41:29.514508 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:41:29.517091 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:41:29.519607 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:41:29.522638 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:41:29.541229 (MainThread): Partial parsing not enabled
2021-10-07 19:41:29.594775 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:41:29.632058 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:41:29.636619 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0d3c8d30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0d291ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4b0d288670>]}
2021-10-07 19:41:29.637610 (MainThread): Flushing usage events
2021-10-07 19:41:30.231236 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:41:30.232302 (MainThread): Encountered an error:
2021-10-07 19:41:30.233013 (MainThread): Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify3(creditcard::int) }}= FALSE
2021-10-07 19:41:30.235703 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 16, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 16
    WHERE {{ luhn_verify3(creditcard::int) }}= FALSE

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify3(creditcard::int) }}= FALSE

2021-10-07 19:41:39.660853 (MainThread): Running with dbt=0.19.0
2021-10-07 19:41:39.794591 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:41:39.799994 (MainThread): Tracking: tracking
2021-10-07 19:41:39.802138 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e28940910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e2bf46430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e28952100>]}
2021-10-07 19:41:39.847191 (MainThread): Partial parsing not enabled
2021-10-07 19:41:39.855495 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:41:39.857269 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:41:39.884482 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:41:39.887755 (MainThread): Parsing macros/relations.sql
2021-10-07 19:41:39.890005 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:41:39.893535 (MainThread): Parsing macros/core.sql
2021-10-07 19:41:39.898795 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:41:39.958897 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:41:39.962130 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:41:39.965007 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:41:39.977594 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:41:39.980779 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:41:39.982693 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:41:39.984291 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:41:39.995856 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:41:40.021488 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:41:40.024316 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:41:40.060712 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:41:40.084199 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:41:40.092544 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:41:40.095346 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:41:40.112402 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:41:40.119129 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:41:40.128148 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:41:40.137609 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:41:40.140504 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:41:40.142823 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:41:40.145524 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:41:40.166328 (MainThread): Partial parsing not enabled
2021-10-07 19:41:40.220797 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:41:40.255849 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:41:40.260712 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e288a3610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e2876ef10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4e287636a0>]}
2021-10-07 19:41:40.261428 (MainThread): Flushing usage events
2021-10-07 19:41:40.829378 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:41:40.830879 (MainThread): Encountered an error:
2021-10-07 19:41:40.831552 (MainThread): Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify3(creditcard:int) }}= FALSE
2021-10-07 19:41:40.834179 (MainThread): Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 496, in catch_jinja
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 941, in from_string
    return cls.from_code(self, self.compile(source), globals, None)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 638, in compile
    self.handle_exception(source=source_hint)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<unknown>", line 16, in template
jinja2.exceptions.TemplateSyntaxError: expected token ',', got ':'
  line 16
    WHERE {{ luhn_verify3(creditcard:int) }}= FALSE

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 125, in main
    results, succeeded = handle_and_check(args)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 203, in handle_and_check
    task, res = run_from_args(parsed)
  File "/usr/local/lib/python3.8/site-packages/dbt/main.py", line 256, in run_from_args
    results = task.run()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 406, in run
    self._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 122, in _runtime_initialize
    super()._runtime_initialize()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 79, in _runtime_initialize
    self.load_manifest()
  File "/usr/local/lib/python3.8/site-packages/dbt/task/runnable.py", line 66, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "/usr/local/lib/python3.8/site-packages/dbt/perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 854, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 434, in load_all
    loader.load(macro_manifest=macro_manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 282, in load
    self.parse_project(project, macro_manifest, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 232, in parse_project
    self.parse_with_cache(path, parser, old_results)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/manifest.py", line 183, in parse_with_cache
    parser.parse_file(block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 424, in parse_file
    self.parse_node(file_block)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 397, in parse_node
    self.render_update(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 372, in render_update
    self.render_with_context(node, config)
  File "/usr/local/lib/python3.8/site-packages/dbt/parser/base.py", line 288, in render_with_context
    get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 570, in get_rendered
    template = get_template(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 523, in get_template
    return env.from_string(template_source, globals=ctx)
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 499, in catch_jinja
    raise CompilationException(str(e), node) from e
dbt.exceptions.CompilationException: Compilation Error in model task2 (models/task2.sql)
  expected token ',', got ':'
    line 16
      WHERE {{ luhn_verify3(creditcard:int) }}= FALSE

2021-10-07 19:41:50.865647 (MainThread): Running with dbt=0.19.0
2021-10-07 19:41:50.989189 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:41:50.995566 (MainThread): Tracking: tracking
2021-10-07 19:41:50.997773 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c716b9910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c74cc0430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c716ca100>]}
2021-10-07 19:41:51.043883 (MainThread): Partial parsing not enabled
2021-10-07 19:41:51.051266 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:41:51.052747 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:41:51.080205 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:41:51.084070 (MainThread): Parsing macros/relations.sql
2021-10-07 19:41:51.086326 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:41:51.090179 (MainThread): Parsing macros/core.sql
2021-10-07 19:41:51.095751 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:41:51.154386 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:41:51.157276 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:41:51.160244 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:41:51.175346 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:41:51.177859 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:41:51.179774 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:41:51.181343 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:41:51.192418 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:41:51.218887 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:41:51.221766 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:41:51.263390 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:41:51.287927 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:41:51.298517 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:41:51.301616 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:41:51.318371 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:41:51.325463 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:41:51.334506 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:41:51.343480 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:41:51.346023 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:41:51.348344 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:41:51.351073 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:41:51.368975 (MainThread): Partial parsing not enabled
2021-10-07 19:41:51.425247 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:41:51.457322 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:41:51.492046 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:41:51.747731 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:41:51.755074 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ecc7b96f-0314-4a41-b7bf-53f378df5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c7150dd90>]}
2021-10-07 19:41:51.816153 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:41:51.818282 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:41:51.819944 (MainThread): 
2021-10-07 19:41:51.821893 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:41:51.825319 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:41:51.841886 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:41:51.842541 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:41:51.843020 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:41:51.848804 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:41:51.852259 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:41:51.859572 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:41:51.867556 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:41:51.868091 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:41:51.868596 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:41:51.872713 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:41:51.873468 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:41:51.873958 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:41:51.877495 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:41:51.888728 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:41:51.889562 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:41:51.899468 (MainThread): Using postgres connection "master".
2021-10-07 19:41:51.900125 (MainThread): On master: BEGIN
2021-10-07 19:41:51.900747 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:41:51.905561 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:41:51.906273 (MainThread): Using postgres connection "master".
2021-10-07 19:41:51.906752 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:41:51.912072 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:41:51.912952 (MainThread): On master: ROLLBACK
2021-10-07 19:41:51.913608 (MainThread): Using postgres connection "master".
2021-10-07 19:41:51.914030 (MainThread): On master: BEGIN
2021-10-07 19:41:51.915022 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:41:51.915572 (MainThread): On master: COMMIT
2021-10-07 19:41:51.916005 (MainThread): Using postgres connection "master".
2021-10-07 19:41:51.916478 (MainThread): On master: COMMIT
2021-10-07 19:41:51.917211 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:41:51.917689 (MainThread): On master: Close
2021-10-07 19:41:51.918429 (MainThread): 19:41:51 | Concurrency: 2 threads (target='dev')
2021-10-07 19:41:51.918966 (MainThread): 19:41:51 | 
2021-10-07 19:41:51.924114 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:41:51.926145 (Thread-1): 19:41:51 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:41:51.927136 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:41:51.927815 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:41:51.949457 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:41:51.963621 (Thread-1): finished collecting timing info
2021-10-07 19:41:51.992538 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:41:51.993324 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:41:51.993954 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:41:51.998475 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:41:52.002322 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:41:52.003039 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:41:52.004140 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:41:52.017331 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:41:52.029444 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:41:52.029914 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:41:52.030701 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:41:52.031106 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:41:52.031449 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

    valid AS (
        SELECT
                MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
        FROM
        (SELECT
                MOD( ( $1::cc / (10^n)::cc ), 10::cc)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
    )

    SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:41:52.032120 (Thread-1): Postgres error: syntax error at or near "AS"
LINE 21:     valid AS (
                   ^

2021-10-07 19:41:52.032519 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:41:52.033184 (Thread-1): finished collecting timing info
2021-10-07 19:41:52.033764 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:41:52.034443 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21:     valid AS (
                     ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "AS"
LINE 21:     valid AS (
                   ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21:     valid AS (
                     ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:41:52.036508 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ecc7b96f-0314-4a41-b7bf-53f378df5ab6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c71583ee0>]}
2021-10-07 19:41:52.038163 (Thread-1): 19:41:52 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:41:52.038697 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:41:52.041305 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:41:52.041887 (MainThread): Using postgres connection "master".
2021-10-07 19:41:52.042311 (MainThread): On master: BEGIN
2021-10-07 19:41:52.042742 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:41:52.047051 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:41:52.047669 (MainThread): On master: COMMIT
2021-10-07 19:41:52.048142 (MainThread): Using postgres connection "master".
2021-10-07 19:41:52.049264 (MainThread): On master: COMMIT
2021-10-07 19:41:52.050392 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:41:52.050994 (MainThread): On master: Close
2021-10-07 19:41:52.052010 (MainThread): 19:41:52 | 
2021-10-07 19:41:52.053025 (MainThread): 19:41:52 | Finished running 1 table model in 0.23s.
2021-10-07 19:41:52.053760 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:41:52.054229 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:41:52.112682 (MainThread): 
2021-10-07 19:41:52.113505 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:41:52.114307 (MainThread): 
2021-10-07 19:41:52.115051 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:41:52.115757 (MainThread):   syntax error at or near "AS"
2021-10-07 19:41:52.116577 (MainThread):   LINE 21:     valid AS (
2021-10-07 19:41:52.118061 (MainThread):                      ^
2021-10-07 19:41:52.118945 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:41:52.120105 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:41:52.121378 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c703a4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c70c08ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6c71583070>]}
2021-10-07 19:41:52.122133 (MainThread): Flushing usage events
2021-10-07 19:42:46.252870 (MainThread): Running with dbt=0.19.0
2021-10-07 19:42:46.387318 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:42:46.391935 (MainThread): Tracking: tracking
2021-10-07 19:42:46.393990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4ded9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d68192b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4dfe190>]}
2021-10-07 19:42:46.435305 (MainThread): Partial parsing not enabled
2021-10-07 19:42:46.444335 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:42:46.446060 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:42:46.472005 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:42:46.475546 (MainThread): Parsing macros/relations.sql
2021-10-07 19:42:46.477673 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:42:46.481333 (MainThread): Parsing macros/core.sql
2021-10-07 19:42:46.486691 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:42:46.547893 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:42:46.550894 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:42:46.553425 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:42:46.566337 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:42:46.569061 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:42:46.570996 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:42:46.572689 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:42:46.585078 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:42:46.615337 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:42:46.618038 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:42:46.656259 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:42:46.678859 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:42:46.687165 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:42:46.690100 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:42:46.707333 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:42:46.714311 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:42:46.723030 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:42:46.733291 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:42:46.735995 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:42:46.738296 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:42:46.741310 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:42:46.759066 (MainThread): Partial parsing not enabled
2021-10-07 19:42:46.813994 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:42:46.848259 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:42:46.884152 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:42:47.150839 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:42:47.157619 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cde10fe3-2737-4292-afb3-e9df4f491715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4c43e50>]}
2021-10-07 19:42:47.218177 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:42:47.220257 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:42:47.221983 (MainThread): 
2021-10-07 19:42:47.222903 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:42:47.225917 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:42:47.239948 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:42:47.240636 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:42:47.241142 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:42:47.247102 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:42:47.251420 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:42:47.257498 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:42:47.266795 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:42:47.267381 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:42:47.267873 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:42:47.271915 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:42:47.272374 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:42:47.272731 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:42:47.276146 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:42:47.288173 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:42:47.289045 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:42:47.300112 (MainThread): Using postgres connection "master".
2021-10-07 19:42:47.300656 (MainThread): On master: BEGIN
2021-10-07 19:42:47.301108 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:42:47.305034 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:42:47.305529 (MainThread): Using postgres connection "master".
2021-10-07 19:42:47.305963 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:42:47.311859 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:42:47.312633 (MainThread): On master: ROLLBACK
2021-10-07 19:42:47.313367 (MainThread): Using postgres connection "master".
2021-10-07 19:42:47.313768 (MainThread): On master: BEGIN
2021-10-07 19:42:47.314963 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:42:47.315529 (MainThread): On master: COMMIT
2021-10-07 19:42:47.316009 (MainThread): Using postgres connection "master".
2021-10-07 19:42:47.316414 (MainThread): On master: COMMIT
2021-10-07 19:42:47.317032 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:42:47.317595 (MainThread): On master: Close
2021-10-07 19:42:47.318548 (MainThread): 19:42:47 | Concurrency: 2 threads (target='dev')
2021-10-07 19:42:47.319123 (MainThread): 19:42:47 | 
2021-10-07 19:42:47.324291 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:42:47.326248 (Thread-1): 19:42:47 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:42:47.326991 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:42:47.327471 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:42:47.351470 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:42:47.364838 (Thread-1): finished collecting timing info
2021-10-07 19:42:47.395167 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:42:47.395899 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:42:47.396621 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:42:47.400721 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:42:47.403936 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:42:47.404414 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:42:47.405140 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:42:47.419464 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:42:47.493046 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:42:47.493653 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:42:47.494586 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:42:47.495281 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:42:47.495786 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

    with valid AS (
        SELECT
                MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
        FROM
        (SELECT
                MOD( ( $1::cc / (10^n)::cc ), 10::cc)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
    )

    SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:42:47.496954 (Thread-1): Postgres error: syntax error at or near "with"
LINE 21:     with valid AS (
             ^

2021-10-07 19:42:47.497530 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:42:47.498583 (Thread-1): finished collecting timing info
2021-10-07 19:42:47.499514 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:42:47.500376 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "with"
  LINE 21:     with valid AS (
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "with"
LINE 21:     with valid AS (
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "with"
  LINE 21:     with valid AS (
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:42:47.502534 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'cde10fe3-2737-4292-afb3-e9df4f491715', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4bbe670>]}
2021-10-07 19:42:47.504446 (Thread-1): 19:42:47 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.18s]
2021-10-07 19:42:47.505138 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:42:47.508027 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:42:47.508742 (MainThread): Using postgres connection "master".
2021-10-07 19:42:47.509259 (MainThread): On master: BEGIN
2021-10-07 19:42:47.509813 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:42:47.514396 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:42:47.515123 (MainThread): On master: COMMIT
2021-10-07 19:42:47.515761 (MainThread): Using postgres connection "master".
2021-10-07 19:42:47.516321 (MainThread): On master: COMMIT
2021-10-07 19:42:47.517224 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:42:47.517769 (MainThread): On master: Close
2021-10-07 19:42:47.518874 (MainThread): 19:42:47 | 
2021-10-07 19:42:47.519697 (MainThread): 19:42:47 | Finished running 1 table model in 0.30s.
2021-10-07 19:42:47.520280 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:42:47.520926 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:42:47.575947 (MainThread): 
2021-10-07 19:42:47.576596 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:42:47.577869 (MainThread): 
2021-10-07 19:42:47.579010 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:42:47.579848 (MainThread):   syntax error at or near "with"
2021-10-07 19:42:47.580857 (MainThread):   LINE 21:     with valid AS (
2021-10-07 19:42:47.581499 (MainThread):                ^
2021-10-07 19:42:47.582174 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:42:47.583143 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:42:47.584121 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4cf9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4bbe1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50d4cda850>]}
2021-10-07 19:42:47.584898 (MainThread): Flushing usage events
2021-10-07 19:43:27.513021 (MainThread): Running with dbt=0.19.0
2021-10-07 19:43:27.665539 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:43:27.671394 (MainThread): Tracking: tracking
2021-10-07 19:43:27.673731 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f420173ba00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42031e5370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f420174c1f0>]}
2021-10-07 19:43:27.722797 (MainThread): Partial parsing not enabled
2021-10-07 19:43:27.737590 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:43:27.739293 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:43:27.769131 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:43:27.773150 (MainThread): Parsing macros/relations.sql
2021-10-07 19:43:27.775604 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:43:27.779325 (MainThread): Parsing macros/core.sql
2021-10-07 19:43:27.785024 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:43:27.838096 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:43:27.841247 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:43:27.843813 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:43:27.855174 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:43:27.857659 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:43:27.859273 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:43:27.860699 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:43:27.871725 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:43:27.897652 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:43:27.900273 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:43:27.950947 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:43:27.978082 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:43:27.990919 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:43:27.994057 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:43:28.013686 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:43:28.021106 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:43:28.030508 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:43:28.039857 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:43:28.042765 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:43:28.045241 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:43:28.048322 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:43:28.066047 (MainThread): Partial parsing not enabled
2021-10-07 19:43:28.121058 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:43:28.155302 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:43:28.195538 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:43:28.449360 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:43:28.456669 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a4226c77-2d49-437b-9aa1-7cafc2f159c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f420158ee20>]}
2021-10-07 19:43:28.519567 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:43:28.521529 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:43:28.523497 (MainThread): 
2021-10-07 19:43:28.524863 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:43:28.528750 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:43:28.543370 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:43:28.544107 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:43:28.544770 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:43:28.551769 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:43:28.555007 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:43:28.561900 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:43:28.569769 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:43:28.570315 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:43:28.570762 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:43:28.575359 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:43:28.576128 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:43:28.576790 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:43:28.580407 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:43:28.591389 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:43:28.592398 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:43:28.602651 (MainThread): Using postgres connection "master".
2021-10-07 19:43:28.603357 (MainThread): On master: BEGIN
2021-10-07 19:43:28.603892 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:43:28.608244 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:43:28.609179 (MainThread): Using postgres connection "master".
2021-10-07 19:43:28.609647 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:43:28.615357 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:43:28.616178 (MainThread): On master: ROLLBACK
2021-10-07 19:43:28.616893 (MainThread): Using postgres connection "master".
2021-10-07 19:43:28.617323 (MainThread): On master: BEGIN
2021-10-07 19:43:28.618266 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:43:28.618758 (MainThread): On master: COMMIT
2021-10-07 19:43:28.619208 (MainThread): Using postgres connection "master".
2021-10-07 19:43:28.619649 (MainThread): On master: COMMIT
2021-10-07 19:43:28.620244 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:43:28.620664 (MainThread): On master: Close
2021-10-07 19:43:28.621302 (MainThread): 19:43:28 | Concurrency: 2 threads (target='dev')
2021-10-07 19:43:28.621731 (MainThread): 19:43:28 | 
2021-10-07 19:43:28.626696 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:43:28.628905 (Thread-1): 19:43:28 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:43:28.631189 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:43:28.631918 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:43:28.654100 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:43:28.667654 (Thread-1): finished collecting timing info
2021-10-07 19:43:28.701106 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:43:28.701712 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:43:28.702265 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:43:28.707249 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:43:28.711303 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:43:28.711959 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:43:28.712894 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:43:28.726836 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:43:28.741818 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:43:28.742223 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:43:28.742941 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:43:28.743492 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:43:28.744056 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

with valid AS (
    SELECT
        MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
        (SELECT
                MOD( ( $1::cc / (10^n)::cc ), 10::cc)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
)

    SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:43:28.745022 (Thread-1): Postgres error: syntax error at or near "with"
LINE 21: with valid AS (
         ^

2021-10-07 19:43:28.745523 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:43:28.746630 (Thread-1): finished collecting timing info
2021-10-07 19:43:28.747432 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:43:28.748369 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "with"
  LINE 21: with valid AS (
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "with"
LINE 21: with valid AS (
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "with"
  LINE 21: with valid AS (
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:43:28.750797 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a4226c77-2d49-437b-9aa1-7cafc2f159c4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f42014f00a0>]}
2021-10-07 19:43:28.752596 (Thread-1): 19:43:28 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.12s]
2021-10-07 19:43:28.753294 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:43:28.756284 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:43:28.756915 (MainThread): Using postgres connection "master".
2021-10-07 19:43:28.757322 (MainThread): On master: BEGIN
2021-10-07 19:43:28.757690 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:43:28.762347 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:43:28.762939 (MainThread): On master: COMMIT
2021-10-07 19:43:28.763529 (MainThread): Using postgres connection "master".
2021-10-07 19:43:28.764032 (MainThread): On master: COMMIT
2021-10-07 19:43:28.764911 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:43:28.765492 (MainThread): On master: Close
2021-10-07 19:43:28.766723 (MainThread): 19:43:28 | 
2021-10-07 19:43:28.767360 (MainThread): 19:43:28 | Finished running 1 table model in 0.24s.
2021-10-07 19:43:28.768019 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:43:28.768436 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:43:28.825266 (MainThread): 
2021-10-07 19:43:28.825863 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:43:28.827157 (MainThread): 
2021-10-07 19:43:28.828335 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:43:28.829631 (MainThread):   syntax error at or near "with"
2021-10-07 19:43:28.830454 (MainThread):   LINE 21: with valid AS (
2021-10-07 19:43:28.831469 (MainThread):            ^
2021-10-07 19:43:28.832203 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:43:28.833134 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:43:28.833929 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4200426cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4200c8afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4200c7fc70>]}
2021-10-07 19:43:28.834619 (MainThread): Flushing usage events
2021-10-07 19:45:27.638783 (MainThread): Running with dbt=0.19.0
2021-10-07 19:45:27.768160 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:45:27.773843 (MainThread): Tracking: tracking
2021-10-07 19:45:27.775990 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376d38d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3770994430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376d39f100>]}
2021-10-07 19:45:27.820967 (MainThread): Partial parsing not enabled
2021-10-07 19:45:27.830761 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:45:27.832317 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:45:27.858843 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:45:27.862293 (MainThread): Parsing macros/relations.sql
2021-10-07 19:45:27.864803 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:45:27.868305 (MainThread): Parsing macros/core.sql
2021-10-07 19:45:27.873698 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:45:27.930990 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:45:27.934352 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:45:27.936971 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:45:27.950413 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:45:27.953067 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:45:27.954791 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:45:27.956835 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:45:27.968954 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:45:27.994806 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:45:27.997652 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:45:28.034526 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:45:28.056751 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:45:28.064732 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:45:28.067747 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:45:28.086067 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:45:28.092886 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:45:28.101407 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:45:28.113586 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:45:28.116708 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:45:28.119834 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:45:28.122863 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:45:28.140811 (MainThread): Partial parsing not enabled
2021-10-07 19:45:28.198053 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:45:28.228802 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:45:28.455144 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:45:28.713044 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:45:28.719267 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21be4fd9-e7da-4ede-b5e2-3ada49c8c8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376d1e4df0>]}
2021-10-07 19:45:28.778774 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:45:28.780413 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:45:28.783485 (MainThread): 
2021-10-07 19:45:28.785389 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:45:28.788467 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:45:28.808592 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:45:28.809208 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:45:28.809723 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:45:28.817006 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:45:28.820816 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:45:28.827960 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:45:28.835899 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:45:28.836390 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:45:28.836761 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:45:28.840383 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:28.841008 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:45:28.841518 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:45:28.845281 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:45:28.856607 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:45:28.857523 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:45:28.867756 (MainThread): Using postgres connection "master".
2021-10-07 19:45:28.868447 (MainThread): On master: BEGIN
2021-10-07 19:45:28.868979 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:45:28.873024 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:28.873752 (MainThread): Using postgres connection "master".
2021-10-07 19:45:28.874447 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:45:28.880303 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:45:28.881157 (MainThread): On master: ROLLBACK
2021-10-07 19:45:28.881905 (MainThread): Using postgres connection "master".
2021-10-07 19:45:28.882369 (MainThread): On master: BEGIN
2021-10-07 19:45:28.883375 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:28.883921 (MainThread): On master: COMMIT
2021-10-07 19:45:28.884385 (MainThread): Using postgres connection "master".
2021-10-07 19:45:28.884809 (MainThread): On master: COMMIT
2021-10-07 19:45:28.885503 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:45:28.885966 (MainThread): On master: Close
2021-10-07 19:45:28.886735 (MainThread): 19:45:28 | Concurrency: 2 threads (target='dev')
2021-10-07 19:45:28.887366 (MainThread): 19:45:28 | 
2021-10-07 19:45:28.892907 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:45:28.894839 (Thread-1): 19:45:28 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:45:28.895753 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:45:28.896324 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:45:28.919498 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:45:28.932172 (Thread-1): finished collecting timing info
2021-10-07 19:45:28.962769 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:28.963333 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:45:28.963725 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:45:28.967945 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:45:28.970929 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:28.971352 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:45:28.972036 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:45:28.984689 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:45:28.994125 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:28.994542 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:45:28.995328 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:28.995903 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:28.996462 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

with valid AS (
    SELECT
        MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
        (SELECT
                MOD( ( $1::cc / (10^n)::cc ), 10::cc)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
),

SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:45:28.997640 (Thread-1): Postgres error: syntax error at or near "with"
LINE 21: with valid AS (
         ^

2021-10-07 19:45:28.998162 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:45:28.998992 (Thread-1): finished collecting timing info
2021-10-07 19:45:28.999679 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:45:29.000490 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "with"
  LINE 21: with valid AS (
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "with"
LINE 21: with valid AS (
         ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "with"
  LINE 21: with valid AS (
           ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:45:29.002693 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '21be4fd9-e7da-4ede-b5e2-3ada49c8c8e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376c8dcee0>]}
2021-10-07 19:45:29.004385 (Thread-1): 19:45:28 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:45:29.004960 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:45:29.007563 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:45:29.008183 (MainThread): Using postgres connection "master".
2021-10-07 19:45:29.008693 (MainThread): On master: BEGIN
2021-10-07 19:45:29.009158 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:45:29.013689 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:29.014322 (MainThread): On master: COMMIT
2021-10-07 19:45:29.014820 (MainThread): Using postgres connection "master".
2021-10-07 19:45:29.015327 (MainThread): On master: COMMIT
2021-10-07 19:45:29.016327 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:45:29.017059 (MainThread): On master: Close
2021-10-07 19:45:29.017966 (MainThread): 19:45:29 | 
2021-10-07 19:45:29.018759 (MainThread): 19:45:29 | Finished running 1 table model in 0.23s.
2021-10-07 19:45:29.019527 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:45:29.019933 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:45:29.075437 (MainThread): 
2021-10-07 19:45:29.075930 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:45:29.077147 (MainThread): 
2021-10-07 19:45:29.078176 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:45:29.079373 (MainThread):   syntax error at or near "with"
2021-10-07 19:45:29.080332 (MainThread):   LINE 21: with valid AS (
2021-10-07 19:45:29.081544 (MainThread):            ^
2021-10-07 19:45:29.082247 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:45:29.083176 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:45:29.084156 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376c079c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376d257bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f376c8ea700>]}
2021-10-07 19:45:29.084854 (MainThread): Flushing usage events
2021-10-07 19:45:37.038996 (MainThread): Running with dbt=0.19.0
2021-10-07 19:45:37.179303 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:45:37.185628 (MainThread): Tracking: tracking
2021-10-07 19:45:37.188178 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0216d3940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb024cda460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb0216e5130>]}
2021-10-07 19:45:37.231617 (MainThread): Partial parsing not enabled
2021-10-07 19:45:37.243231 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:45:37.244840 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:45:37.275834 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:45:37.280427 (MainThread): Parsing macros/relations.sql
2021-10-07 19:45:37.283272 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:45:37.287580 (MainThread): Parsing macros/core.sql
2021-10-07 19:45:37.293649 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:45:37.349232 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:45:37.352071 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:45:37.354564 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:45:37.365715 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:45:37.369045 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:45:37.370882 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:45:37.372382 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:45:37.384941 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:45:37.412356 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:45:37.415691 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:45:37.451608 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:45:37.473787 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:45:37.481581 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:45:37.484360 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:45:37.503091 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:45:37.510084 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:45:37.518133 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:45:37.526586 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:45:37.529391 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:45:37.532158 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:45:37.534895 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:45:37.553094 (MainThread): Partial parsing not enabled
2021-10-07 19:45:37.607692 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:45:37.643812 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:45:37.679930 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:45:37.924889 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:45:37.931363 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '74832938-7e7a-4827-99a0-1653e1d4992d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02152adc0>]}
2021-10-07 19:45:37.991282 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:45:37.993160 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:45:37.994908 (MainThread): 
2021-10-07 19:45:37.995911 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:45:37.998842 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:45:38.014689 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:45:38.015360 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:45:38.015880 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:45:38.020448 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-07 19:45:38.023681 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:45:38.030353 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:45:38.037655 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:45:38.038236 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:45:38.038751 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:45:38.043528 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:38.044239 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:45:38.044953 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:45:38.048133 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:45:38.059043 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:45:38.059966 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:45:38.069663 (MainThread): Using postgres connection "master".
2021-10-07 19:45:38.070281 (MainThread): On master: BEGIN
2021-10-07 19:45:38.070914 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:45:38.075951 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:45:38.076684 (MainThread): Using postgres connection "master".
2021-10-07 19:45:38.077255 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:45:38.082468 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:45:38.083382 (MainThread): On master: ROLLBACK
2021-10-07 19:45:38.084247 (MainThread): Using postgres connection "master".
2021-10-07 19:45:38.085006 (MainThread): On master: BEGIN
2021-10-07 19:45:38.086092 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:38.086938 (MainThread): On master: COMMIT
2021-10-07 19:45:38.087617 (MainThread): Using postgres connection "master".
2021-10-07 19:45:38.088273 (MainThread): On master: COMMIT
2021-10-07 19:45:38.089157 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:45:38.089688 (MainThread): On master: Close
2021-10-07 19:45:38.090497 (MainThread): 19:45:38 | Concurrency: 2 threads (target='dev')
2021-10-07 19:45:38.091119 (MainThread): 19:45:38 | 
2021-10-07 19:45:38.095914 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:45:38.098222 (Thread-1): 19:45:38 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:45:38.099355 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:45:38.100087 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:45:38.123149 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:45:38.136222 (Thread-1): finished collecting timing info
2021-10-07 19:45:38.171403 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:38.172322 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:45:38.173872 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:45:38.178673 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 19:45:38.182106 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:38.182614 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:45:38.183374 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:45:38.197964 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:45:38.208418 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:38.208781 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:45:38.209435 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:38.209806 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:38.210166 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

valid AS (
    SELECT
        MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
        (SELECT
                MOD( ( $1::cc / (10^n)::cc ), 10::cc)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
),

SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:45:38.210899 (Thread-1): Postgres error: syntax error at or near "AS"
LINE 21: valid AS (
               ^

2021-10-07 19:45:38.211295 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:45:38.211935 (Thread-1): finished collecting timing info
2021-10-07 19:45:38.212512 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:45:38.213283 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21: valid AS (
                 ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "AS"
LINE 21: valid AS (
               ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "AS"
  LINE 21: valid AS (
                 ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:45:38.215542 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '74832938-7e7a-4827-99a0-1653e1d4992d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb020c22f10>]}
2021-10-07 19:45:38.217346 (Thread-1): 19:45:38 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.12s]
2021-10-07 19:45:38.217911 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:45:38.227297 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:45:38.228049 (MainThread): Using postgres connection "master".
2021-10-07 19:45:38.228794 (MainThread): On master: BEGIN
2021-10-07 19:45:38.229348 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:45:38.233288 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:38.233776 (MainThread): On master: COMMIT
2021-10-07 19:45:38.234310 (MainThread): Using postgres connection "master".
2021-10-07 19:45:38.234746 (MainThread): On master: COMMIT
2021-10-07 19:45:38.235503 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:45:38.235919 (MainThread): On master: Close
2021-10-07 19:45:38.236805 (MainThread): 19:45:38 | 
2021-10-07 19:45:38.237276 (MainThread): 19:45:38 | Finished running 1 table model in 0.24s.
2021-10-07 19:45:38.237724 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:45:38.238338 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:45:38.299091 (MainThread): 
2021-10-07 19:45:38.299557 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:45:38.300085 (MainThread): 
2021-10-07 19:45:38.300700 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:45:38.302070 (MainThread):   syntax error at or near "AS"
2021-10-07 19:45:38.302933 (MainThread):   LINE 21: valid AS (
2021-10-07 19:45:38.303906 (MainThread):                  ^
2021-10-07 19:45:38.304687 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:45:38.305267 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:45:38.306208 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb021484f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02157d160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb02158efa0>]}
2021-10-07 19:45:38.306876 (MainThread): Flushing usage events
2021-10-07 19:45:47.853919 (MainThread): Running with dbt=0.19.0
2021-10-07 19:45:48.180447 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:45:49.510764 (MainThread): Tracking: tracking
2021-10-07 19:45:49.512950 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f6e2c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9162ce8400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f6f20d0>]}
2021-10-07 19:45:49.552041 (MainThread): Partial parsing not enabled
2021-10-07 19:45:49.566960 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:45:49.568756 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:45:49.595743 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:45:49.600186 (MainThread): Parsing macros/relations.sql
2021-10-07 19:45:49.602679 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:45:49.606648 (MainThread): Parsing macros/core.sql
2021-10-07 19:45:49.612322 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:45:49.664202 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:45:49.667682 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:45:49.670405 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:45:49.682599 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:45:49.685124 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:45:49.687039 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:45:49.688675 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:45:49.700807 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:45:49.726432 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:45:49.729324 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:45:49.768631 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:45:49.793964 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:45:49.802638 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:45:49.805645 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:45:49.823570 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:45:49.831355 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:45:49.839813 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:45:49.848569 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:45:49.851244 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:45:49.853831 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:45:49.856710 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:45:49.875370 (MainThread): Partial parsing not enabled
2021-10-07 19:45:49.929094 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:45:49.963066 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:45:49.996855 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:45:50.255523 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:45:50.261873 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd53b54a2-1a59-4aa4-9edc-4d9bd8621269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f538e50>]}
2021-10-07 19:45:50.323818 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:45:50.325955 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:45:50.327565 (MainThread): 
2021-10-07 19:45:50.328533 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:45:50.331276 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:45:50.346660 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:45:50.347428 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:45:50.348070 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:45:50.353770 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:45:50.356797 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:45:50.363562 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:45:50.371902 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:45:50.372462 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:45:50.372959 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:45:50.377670 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:50.378542 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:45:50.379251 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:45:50.382196 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:45:50.394803 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:45:50.395968 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:45:50.405958 (MainThread): Using postgres connection "master".
2021-10-07 19:45:50.406511 (MainThread): On master: BEGIN
2021-10-07 19:45:50.406951 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:45:50.411717 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:50.412372 (MainThread): Using postgres connection "master".
2021-10-07 19:45:50.413119 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:45:50.418581 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:45:50.419403 (MainThread): On master: ROLLBACK
2021-10-07 19:45:50.420152 (MainThread): Using postgres connection "master".
2021-10-07 19:45:50.420637 (MainThread): On master: BEGIN
2021-10-07 19:45:50.421706 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:50.422272 (MainThread): On master: COMMIT
2021-10-07 19:45:50.422741 (MainThread): Using postgres connection "master".
2021-10-07 19:45:50.423413 (MainThread): On master: COMMIT
2021-10-07 19:45:50.424232 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:45:50.424845 (MainThread): On master: Close
2021-10-07 19:45:50.425678 (MainThread): 19:45:50 | Concurrency: 2 threads (target='dev')
2021-10-07 19:45:50.426283 (MainThread): 19:45:50 | 
2021-10-07 19:45:50.431829 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:45:50.434035 (Thread-1): 19:45:50 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:45:50.434986 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:45:50.435529 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:45:50.459542 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 19:45:50.471415 (Thread-1): finished collecting timing info
2021-10-07 19:45:50.502991 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:50.503623 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 19:45:50.504146 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:45:50.509347 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 19:45:50.512750 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:50.513520 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 19:45:50.514390 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 19:45:50.528559 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 19:45:50.541220 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:50.541646 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 19:45:50.542393 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:50.542756 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:45:50.543231 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE 

valid (
    SELECT
        MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
        (SELECT
                MOD( ( $1::cc / (10^n)::cc ), 10::cc)
                * (MOD(n,2) + 1)
                AS doubled_digit
                FROM generate_series(0, floor(log( $1 ))::integer) AS n
        ) AS doubled_digits $$
),

SELECT * FROM valid

= FALSE
GROUP BY orderdate
  );
2021-10-07 19:45:50.544047 (Thread-1): Postgres error: syntax error at or near "SELECT"
LINE 22:     SELECT
             ^

2021-10-07 19:45:50.544448 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 19:45:50.545160 (Thread-1): finished collecting timing info
2021-10-07 19:45:50.545759 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:45:50.546475 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 22:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "SELECT"
LINE 22:     SELECT
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "SELECT"
  LINE 22:     SELECT
               ^
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:45:50.548728 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd53b54a2-1a59-4aa4-9edc-4d9bd8621269', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f5883d0>]}
2021-10-07 19:45:50.550416 (Thread-1): 19:45:50 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 19:45:50.550930 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:45:50.553587 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:45:50.554189 (MainThread): Using postgres connection "master".
2021-10-07 19:45:50.554620 (MainThread): On master: BEGIN
2021-10-07 19:45:50.555111 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:45:50.559568 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:45:50.560244 (MainThread): On master: COMMIT
2021-10-07 19:45:50.560799 (MainThread): Using postgres connection "master".
2021-10-07 19:45:50.561379 (MainThread): On master: COMMIT
2021-10-07 19:45:50.562257 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:45:50.563024 (MainThread): On master: Close
2021-10-07 19:45:50.564388 (MainThread): 19:45:50 | 
2021-10-07 19:45:50.565154 (MainThread): 19:45:50 | Finished running 1 table model in 0.24s.
2021-10-07 19:45:50.565749 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:45:50.566079 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:45:50.623897 (MainThread): 
2021-10-07 19:45:50.624500 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:45:50.625614 (MainThread): 
2021-10-07 19:45:50.626747 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:45:50.627784 (MainThread):   syntax error at or near "SELECT"
2021-10-07 19:45:50.628727 (MainThread):   LINE 22:     SELECT
2021-10-07 19:45:50.629453 (MainThread):                ^
2021-10-07 19:45:50.630454 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 19:45:50.631285 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:45:50.632422 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915ec27bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915f5a0700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f915cbdd0d0>]}
2021-10-07 19:45:50.633181 (MainThread): Flushing usage events
2021-10-07 19:52:38.528421 (MainThread): Running with dbt=0.19.0
2021-10-07 19:52:38.805375 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:52:38.810266 (MainThread): Tracking: tracking
2021-10-07 19:52:38.812299 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aaaeafd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1ae0f13d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aaafc0a0>]}
2021-10-07 19:52:38.853455 (MainThread): Partial parsing not enabled
2021-10-07 19:52:38.866225 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:52:38.868766 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:52:38.894394 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:52:38.897990 (MainThread): Parsing macros/relations.sql
2021-10-07 19:52:38.900285 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:52:38.904050 (MainThread): Parsing macros/core.sql
2021-10-07 19:52:38.909839 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:52:38.963315 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:52:38.966301 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:52:38.970430 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:52:38.982897 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:52:38.985438 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:52:38.987183 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:52:38.988824 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:52:39.000832 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:52:39.027596 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:52:39.030395 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:52:39.067984 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:52:39.092590 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:52:39.101122 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:52:39.104904 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:52:39.122462 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:52:39.129588 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:52:39.139737 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:52:39.148959 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:52:39.151748 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:52:39.154038 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:52:39.157135 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:52:39.176977 (MainThread): Partial parsing not enabled
2021-10-07 19:52:39.298738 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:52:39.332962 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:52:39.381150 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:52:39.646815 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:52:39.652653 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '786b3186-2f9f-4962-91ac-2e1049230cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa9f3a90>]}
2021-10-07 19:52:39.713620 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:52:39.715795 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:52:39.717820 (MainThread): 
2021-10-07 19:52:39.718875 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:52:39.721982 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:52:39.732119 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:52:39.732816 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:52:39.733321 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:52:39.738150 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-07 19:52:39.741049 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:52:39.748552 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:52:39.755689 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:52:39.756261 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:52:39.756816 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:52:39.762715 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:52:39.763633 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:52:39.764134 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:52:39.766766 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:52:39.779438 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:52:39.780374 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:52:39.790401 (MainThread): Using postgres connection "master".
2021-10-07 19:52:39.791225 (MainThread): On master: BEGIN
2021-10-07 19:52:39.791822 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:52:39.796956 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:52:39.797743 (MainThread): Using postgres connection "master".
2021-10-07 19:52:39.798321 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:52:39.803629 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:52:39.804492 (MainThread): On master: ROLLBACK
2021-10-07 19:52:39.805301 (MainThread): Using postgres connection "master".
2021-10-07 19:52:39.805820 (MainThread): On master: BEGIN
2021-10-07 19:52:39.806867 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:52:39.807452 (MainThread): On master: COMMIT
2021-10-07 19:52:39.807959 (MainThread): Using postgres connection "master".
2021-10-07 19:52:39.808455 (MainThread): On master: COMMIT
2021-10-07 19:52:39.809331 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:52:39.809958 (MainThread): On master: Close
2021-10-07 19:52:39.810778 (MainThread): 19:52:39 | Concurrency: 2 threads (target='dev')
2021-10-07 19:52:39.811415 (MainThread): 19:52:39 | 
2021-10-07 19:52:39.816174 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:52:39.818446 (Thread-1): 19:52:39 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:52:39.819385 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:52:39.819806 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:52:39.841841 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:52:39.843006 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$ LANGUAGE SQL

  
2021-10-07 19:52:39.843794 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:52:39.849530 (Thread-1): Postgres error: unterminated dollar-quoted string at or near "$$ LANGUAGE SQL

  "
LINE 12:     ) AS doubled_digits $$ LANGUAGE SQL
                                 ^

2021-10-07 19:52:39.851387 (Thread-1): finished collecting timing info
2021-10-07 19:52:39.852252 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:52:39.853164 (Thread-1): Database Error in model task2 (models/task2.sql)
  unterminated dollar-quoted string at or near "$$ LANGUAGE SQL
  
    "
  LINE 12:     ) AS doubled_digits $$ LANGUAGE SQL
                                   ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: unterminated dollar-quoted string at or near "$$ LANGUAGE SQL

  "
LINE 12:     ) AS doubled_digits $$ LANGUAGE SQL
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 15, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  unterminated dollar-quoted string at or near "$$ LANGUAGE SQL
  
    "
  LINE 12:     ) AS doubled_digits $$ LANGUAGE SQL
                                   ^
2021-10-07 19:52:39.856136 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '786b3186-2f9f-4962-91ac-2e1049230cc8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa8b6190>]}
2021-10-07 19:52:39.857800 (Thread-1): 19:52:39 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.04s]
2021-10-07 19:52:39.858383 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:52:39.862941 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:52:39.863745 (MainThread): Using postgres connection "master".
2021-10-07 19:52:39.864320 (MainThread): On master: BEGIN
2021-10-07 19:52:39.864726 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:52:39.869379 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:52:39.870036 (MainThread): On master: COMMIT
2021-10-07 19:52:39.870482 (MainThread): Using postgres connection "master".
2021-10-07 19:52:39.870964 (MainThread): On master: COMMIT
2021-10-07 19:52:39.871573 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:52:39.872076 (MainThread): On master: Close
2021-10-07 19:52:39.872815 (MainThread): 19:52:39 | 
2021-10-07 19:52:39.873369 (MainThread): 19:52:39 | Finished running 1 table model in 0.15s.
2021-10-07 19:52:39.874397 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:52:39.875485 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:52:39.929580 (MainThread): 
2021-10-07 19:52:39.930167 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:52:39.930752 (MainThread): 
2021-10-07 19:52:39.931376 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:52:39.931976 (MainThread):   unterminated dollar-quoted string at or near "$$ LANGUAGE SQL
2021-10-07 19:52:39.932939 (MainThread):   
2021-10-07 19:52:39.933604 (MainThread):     "
2021-10-07 19:52:39.934690 (MainThread):   LINE 12:     ) AS doubled_digits $$ LANGUAGE SQL
2021-10-07 19:52:39.935402 (MainThread):                                    ^
2021-10-07 19:52:39.936203 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:52:39.937043 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa9e9670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aaa3eca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1aa956970>]}
2021-10-07 19:52:39.937823 (MainThread): Flushing usage events
2021-10-07 19:52:56.858238 (MainThread): Running with dbt=0.19.0
2021-10-07 19:52:56.985703 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:52:56.991455 (MainThread): Tracking: tracking
2021-10-07 19:52:56.993902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c22b4a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c26151460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c22b5c130>]}
2021-10-07 19:52:57.035779 (MainThread): Partial parsing not enabled
2021-10-07 19:52:57.044158 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:52:57.046552 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:52:57.072514 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:52:57.077905 (MainThread): Parsing macros/relations.sql
2021-10-07 19:52:57.080486 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:52:57.085741 (MainThread): Parsing macros/core.sql
2021-10-07 19:52:57.094281 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:52:57.150094 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:52:57.153531 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:52:57.156880 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:52:57.171271 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:52:57.174080 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:52:57.175896 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:52:57.177504 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:52:57.189453 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:52:57.215217 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:52:57.218302 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:52:57.257289 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:52:57.281066 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:52:57.289707 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:52:57.292535 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:52:57.312426 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:52:57.319849 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:52:57.329538 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:52:57.338679 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:52:57.341402 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:52:57.343762 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:52:57.346469 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:52:57.363061 (MainThread): Partial parsing not enabled
2021-10-07 19:52:57.418851 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:52:57.452073 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:52:57.499533 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:52:57.748221 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:52:57.755401 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ece0c49c-0d93-4a0a-bc1f-a6ab10489347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c229fcc70>]}
2021-10-07 19:52:57.816063 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:52:57.817986 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:52:57.819818 (MainThread): 
2021-10-07 19:52:57.820687 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:52:57.823624 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:52:57.833331 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:52:57.834069 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:52:57.834739 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:52:57.839748 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:52:57.843629 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:52:57.850950 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:52:57.858386 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:52:57.859207 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:52:57.860112 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:52:57.865208 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:52:57.865867 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:52:57.866338 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:52:57.868903 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:52:57.881119 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:52:57.882034 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:52:57.892274 (MainThread): Using postgres connection "master".
2021-10-07 19:52:57.892924 (MainThread): On master: BEGIN
2021-10-07 19:52:57.893663 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:52:57.897837 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:52:57.898477 (MainThread): Using postgres connection "master".
2021-10-07 19:52:57.899029 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:52:57.904954 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:52:57.905768 (MainThread): On master: ROLLBACK
2021-10-07 19:52:57.906489 (MainThread): Using postgres connection "master".
2021-10-07 19:52:57.907033 (MainThread): On master: BEGIN
2021-10-07 19:52:57.908277 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:52:57.908903 (MainThread): On master: COMMIT
2021-10-07 19:52:57.909446 (MainThread): Using postgres connection "master".
2021-10-07 19:52:57.909985 (MainThread): On master: COMMIT
2021-10-07 19:52:57.910813 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:52:57.911396 (MainThread): On master: Close
2021-10-07 19:52:57.912165 (MainThread): 19:52:57 | Concurrency: 2 threads (target='dev')
2021-10-07 19:52:57.912840 (MainThread): 19:52:57 | 
2021-10-07 19:52:57.918220 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:52:57.920446 (Thread-1): 19:52:57 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:52:57.921493 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:52:57.922073 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:52:57.943478 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:52:57.944209 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits $$

  
2021-10-07 19:52:57.944793 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:52:57.949864 (Thread-1): Postgres error: unterminated dollar-quoted string at or near "$$

  "
LINE 12:     ) AS doubled_digits $$
                                 ^

2021-10-07 19:52:57.951841 (Thread-1): finished collecting timing info
2021-10-07 19:52:57.952645 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:52:57.953548 (Thread-1): Database Error in model task2 (models/task2.sql)
  unterminated dollar-quoted string at or near "$$
  
    "
  LINE 12:     ) AS doubled_digits $$
                                   ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: unterminated dollar-quoted string at or near "$$

  "
LINE 12:     ) AS doubled_digits $$
                                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 15, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  unterminated dollar-quoted string at or near "$$
  
    "
  LINE 12:     ) AS doubled_digits $$
                                   ^
2021-10-07 19:52:57.956086 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ece0c49c-0d93-4a0a-bc1f-a6ab10489347', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c22915220>]}
2021-10-07 19:52:57.957822 (Thread-1): 19:52:57 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.03s]
2021-10-07 19:52:57.958491 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:52:57.961604 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:52:57.962255 (MainThread): Using postgres connection "master".
2021-10-07 19:52:57.962935 (MainThread): On master: BEGIN
2021-10-07 19:52:57.963775 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:52:57.968403 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:52:57.969050 (MainThread): On master: COMMIT
2021-10-07 19:52:57.969598 (MainThread): Using postgres connection "master".
2021-10-07 19:52:57.970115 (MainThread): On master: COMMIT
2021-10-07 19:52:57.971055 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:52:57.971646 (MainThread): On master: Close
2021-10-07 19:52:57.972486 (MainThread): 19:52:57 | 
2021-10-07 19:52:57.973026 (MainThread): 19:52:57 | Finished running 1 table model in 0.15s.
2021-10-07 19:52:57.973623 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:52:57.974023 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:52:58.029843 (MainThread): 
2021-10-07 19:52:58.030688 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:52:58.031288 (MainThread): 
2021-10-07 19:52:58.032007 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:52:58.033109 (MainThread):   unterminated dollar-quoted string at or near "$$
2021-10-07 19:52:58.033708 (MainThread):   
2021-10-07 19:52:58.034872 (MainThread):     "
2021-10-07 19:52:58.035623 (MainThread):   LINE 12:     ) AS doubled_digits $$
2021-10-07 19:52:58.036417 (MainThread):                                    ^
2021-10-07 19:52:58.037374 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:52:58.038550 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c22a07d00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c229a2820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1c22aa4b80>]}
2021-10-07 19:52:58.039268 (MainThread): Flushing usage events
2021-10-07 19:53:08.369255 (MainThread): Running with dbt=0.19.0
2021-10-07 19:53:08.496841 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:53:08.502627 (MainThread): Tracking: tracking
2021-10-07 19:53:08.504992 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323bcbc9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323d767310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323bcce1c0>]}
2021-10-07 19:53:08.548217 (MainThread): Partial parsing not enabled
2021-10-07 19:53:08.560555 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:53:08.563092 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:53:08.589356 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:53:08.592535 (MainThread): Parsing macros/relations.sql
2021-10-07 19:53:08.594618 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:53:08.598752 (MainThread): Parsing macros/core.sql
2021-10-07 19:53:08.604525 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:53:08.662226 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:53:08.665380 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:53:08.668025 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:53:08.680052 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:53:08.683026 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:53:08.684857 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:53:08.686354 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:53:08.699056 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:53:08.730690 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:53:08.734523 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:53:08.771629 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:53:08.795056 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:53:08.803745 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:53:08.806952 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:53:08.824937 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:53:08.831805 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:53:08.840701 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:53:08.849443 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:53:08.852796 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:53:08.855080 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:53:08.857977 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:53:08.874091 (MainThread): Partial parsing not enabled
2021-10-07 19:53:08.929907 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:53:08.963368 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:53:09.005955 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:53:09.256007 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:53:09.261709 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad287e05-bed7-4c1a-b643-ac08f4222053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323bba9d30>]}
2021-10-07 19:53:09.327181 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:53:09.329530 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:53:09.331356 (MainThread): 
2021-10-07 19:53:09.332314 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:53:09.335028 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:53:09.344676 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:53:09.345511 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:53:09.346316 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:53:09.351585 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:53:09.354609 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:53:09.361402 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:53:09.370025 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:53:09.370765 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:53:09.371230 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:53:09.375203 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:09.376023 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:53:09.376988 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:53:09.380491 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:53:09.392009 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:53:09.393504 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:53:09.405330 (MainThread): Using postgres connection "master".
2021-10-07 19:53:09.405946 (MainThread): On master: BEGIN
2021-10-07 19:53:09.406362 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:53:09.410789 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:09.411434 (MainThread): Using postgres connection "master".
2021-10-07 19:53:09.411959 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:53:09.417257 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:53:09.418109 (MainThread): On master: ROLLBACK
2021-10-07 19:53:09.418806 (MainThread): Using postgres connection "master".
2021-10-07 19:53:09.419343 (MainThread): On master: BEGIN
2021-10-07 19:53:09.420382 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:09.421130 (MainThread): On master: COMMIT
2021-10-07 19:53:09.421580 (MainThread): Using postgres connection "master".
2021-10-07 19:53:09.422101 (MainThread): On master: COMMIT
2021-10-07 19:53:09.422905 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:53:09.423441 (MainThread): On master: Close
2021-10-07 19:53:09.424209 (MainThread): 19:53:09 | Concurrency: 2 threads (target='dev')
2021-10-07 19:53:09.424852 (MainThread): 19:53:09 | 
2021-10-07 19:53:09.430621 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:53:09.432694 (Thread-1): 19:53:09 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:53:09.433445 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:53:09.434238 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:53:09.454517 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:53:09.455166 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits

  
2021-10-07 19:53:09.455665 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:53:09.460627 (Thread-1): Postgres error: there is no parameter $1
LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                        ^

2021-10-07 19:53:09.462250 (Thread-1): finished collecting timing info
2021-10-07 19:53:09.463077 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:53:09.464128 (Thread-1): Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                          ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedParameter: there is no parameter $1
LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 15, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                          ^
2021-10-07 19:53:09.467562 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ad287e05-bed7-4c1a-b643-ac08f4222053', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323ba89190>]}
2021-10-07 19:53:09.469617 (Thread-1): 19:53:09 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.03s]
2021-10-07 19:53:09.470324 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:53:09.473316 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:53:09.474022 (MainThread): Using postgres connection "master".
2021-10-07 19:53:09.474454 (MainThread): On master: BEGIN
2021-10-07 19:53:09.474955 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:53:09.479533 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:09.480176 (MainThread): On master: COMMIT
2021-10-07 19:53:09.480822 (MainThread): Using postgres connection "master".
2021-10-07 19:53:09.481457 (MainThread): On master: COMMIT
2021-10-07 19:53:09.482440 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:53:09.483010 (MainThread): On master: Close
2021-10-07 19:53:09.483871 (MainThread): 19:53:09 | 
2021-10-07 19:53:09.484725 (MainThread): 19:53:09 | Finished running 1 table model in 0.15s.
2021-10-07 19:53:09.485588 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:53:09.485979 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:53:09.542198 (MainThread): 
2021-10-07 19:53:09.542756 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:53:09.543697 (MainThread): 
2021-10-07 19:53:09.544309 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:53:09.545266 (MainThread):   there is no parameter $1
2021-10-07 19:53:09.545954 (MainThread):   LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
2021-10-07 19:53:09.546793 (MainThread):                                                           ^
2021-10-07 19:53:09.547947 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:53:09.549212 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323bb82b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323bb8b640>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f323ba84370>]}
2021-10-07 19:53:09.550062 (MainThread): Flushing usage events
2021-10-07 19:53:48.125120 (MainThread): Running with dbt=0.19.0
2021-10-07 19:53:48.261919 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:53:48.268183 (MainThread): Tracking: tracking
2021-10-07 19:53:48.270878 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab1074fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab467c3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab10850a0>]}
2021-10-07 19:53:48.315877 (MainThread): Partial parsing not enabled
2021-10-07 19:53:48.324354 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:53:48.327135 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:53:48.354959 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:53:48.358452 (MainThread): Parsing macros/relations.sql
2021-10-07 19:53:48.360521 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:53:48.364245 (MainThread): Parsing macros/core.sql
2021-10-07 19:53:48.369958 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:53:48.432979 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:53:48.435998 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:53:48.438657 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:53:48.450427 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:53:48.453470 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:53:48.455382 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:53:48.457053 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:53:48.468510 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:53:48.497775 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:53:48.500552 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:53:48.536393 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:53:48.560271 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:53:48.568543 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:53:48.571395 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:53:48.589036 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:53:48.598818 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:53:48.608188 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:53:48.617554 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:53:48.620264 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:53:48.622823 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:53:48.625906 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:53:48.643637 (MainThread): Partial parsing not enabled
2021-10-07 19:53:48.698909 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:53:48.732901 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:53:48.776585 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:53:49.024260 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:53:49.031692 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa5548fa-f856-4eff-a102-f2b027dcb71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0f7fd30>]}
2021-10-07 19:53:49.091768 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:53:49.093664 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:53:49.095252 (MainThread): 
2021-10-07 19:53:49.096167 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:53:49.098925 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:53:49.107544 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:53:49.108077 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:53:49.108535 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:53:49.113774 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:53:49.117298 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:53:49.123487 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:53:49.131953 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:53:49.132701 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:53:49.133336 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:53:49.138191 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:49.138905 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:53:49.139366 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:53:49.141915 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:53:49.154620 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:53:49.155457 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:53:49.168745 (MainThread): Using postgres connection "master".
2021-10-07 19:53:49.169341 (MainThread): On master: BEGIN
2021-10-07 19:53:49.169757 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:53:49.173999 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:49.174503 (MainThread): Using postgres connection "master".
2021-10-07 19:53:49.174954 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:53:49.180606 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:53:49.181389 (MainThread): On master: ROLLBACK
2021-10-07 19:53:49.182198 (MainThread): Using postgres connection "master".
2021-10-07 19:53:49.182659 (MainThread): On master: BEGIN
2021-10-07 19:53:49.183688 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:53:49.184197 (MainThread): On master: COMMIT
2021-10-07 19:53:49.184676 (MainThread): Using postgres connection "master".
2021-10-07 19:53:49.185111 (MainThread): On master: COMMIT
2021-10-07 19:53:49.185843 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:53:49.186354 (MainThread): On master: Close
2021-10-07 19:53:49.187240 (MainThread): 19:53:49 | Concurrency: 2 threads (target='dev')
2021-10-07 19:53:49.187856 (MainThread): 19:53:49 | 
2021-10-07 19:53:49.194974 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:53:49.198536 (Thread-1): 19:53:49 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:53:49.200006 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:53:49.201188 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:53:49.221075 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:53:49.221722 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::cc / (10^n)::cc ), 10::cc)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits

  
2021-10-07 19:53:49.222266 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:53:49.226719 (Thread-1): Postgres error: there is no parameter $1
LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                        ^

2021-10-07 19:53:49.228750 (Thread-1): finished collecting timing info
2021-10-07 19:53:49.229837 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:53:49.230847 (Thread-1): Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                          ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedParameter: there is no parameter $1
LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 15, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                          ^
2021-10-07 19:53:49.233676 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa5548fa-f856-4eff-a102-f2b027dcb71e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0e430d0>]}
2021-10-07 19:53:49.235410 (Thread-1): 19:53:49 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.03s]
2021-10-07 19:53:49.235961 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:53:49.238370 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:53:49.239088 (MainThread): Using postgres connection "master".
2021-10-07 19:53:49.239531 (MainThread): On master: BEGIN
2021-10-07 19:53:49.240043 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:53:49.245332 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:53:49.245963 (MainThread): On master: COMMIT
2021-10-07 19:53:49.246775 (MainThread): Using postgres connection "master".
2021-10-07 19:53:49.247327 (MainThread): On master: COMMIT
2021-10-07 19:53:49.248073 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:53:49.248663 (MainThread): On master: Close
2021-10-07 19:53:49.249669 (MainThread): 19:53:49 | 
2021-10-07 19:53:49.250226 (MainThread): 19:53:49 | Finished running 1 table model in 0.15s.
2021-10-07 19:53:49.250815 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:53:49.251272 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:53:49.308083 (MainThread): 
2021-10-07 19:53:49.308648 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:53:49.310160 (MainThread): 
2021-10-07 19:53:49.311435 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:53:49.312912 (MainThread):   there is no parameter $1
2021-10-07 19:53:49.313733 (MainThread):   LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
2021-10-07 19:53:49.314867 (MainThread):                                                           ^
2021-10-07 19:53:49.315765 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:53:49.316570 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0f59760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0f3d910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ab0f51c10>]}
2021-10-07 19:53:49.317278 (MainThread): Flushing usage events
2021-10-07 19:54:02.336909 (MainThread): Running with dbt=0.19.0
2021-10-07 19:54:02.557945 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:54:02.563445 (MainThread): Tracking: tracking
2021-10-07 19:54:02.565679 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556d1e940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb55a325460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556d2f130>]}
2021-10-07 19:54:02.612182 (MainThread): Partial parsing not enabled
2021-10-07 19:54:02.629925 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:54:02.632367 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:54:02.659193 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:54:02.662472 (MainThread): Parsing macros/relations.sql
2021-10-07 19:54:02.664708 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:54:02.668851 (MainThread): Parsing macros/core.sql
2021-10-07 19:54:02.674908 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:54:02.730934 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:54:02.734366 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:54:02.736941 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:54:02.748960 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:54:02.751404 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:54:02.754203 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:54:02.756019 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:54:02.768405 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:54:02.795061 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:54:02.797904 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:54:02.834492 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:54:02.856805 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:54:02.864904 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:54:02.867893 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:54:02.884994 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:54:02.891694 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:54:02.899764 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:54:02.908670 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:54:02.911284 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:54:02.913685 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:54:02.916539 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:54:02.935086 (MainThread): Partial parsing not enabled
2021-10-07 19:54:02.991117 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:54:03.022517 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:54:03.064138 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:54:03.315286 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:54:03.321675 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a40ebbdd-5c76-4f6b-a256-e7d81eb9188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556bd1310>]}
2021-10-07 19:54:03.381162 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:54:03.382837 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:54:03.384375 (MainThread): 
2021-10-07 19:54:03.385446 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:54:03.388069 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:54:03.397052 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:54:03.398090 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:54:03.398721 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:54:03.404582 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:54:03.407770 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:54:03.415739 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:54:03.423998 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:54:03.424566 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:54:03.425063 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:54:03.430819 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:54:03.431500 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:54:03.431990 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:54:03.434600 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:54:03.447303 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:54:03.448512 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:54:03.459224 (MainThread): Using postgres connection "master".
2021-10-07 19:54:03.460018 (MainThread): On master: BEGIN
2021-10-07 19:54:03.460716 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:54:03.464804 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:54:03.465290 (MainThread): Using postgres connection "master".
2021-10-07 19:54:03.465704 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:54:03.470920 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:54:03.471643 (MainThread): On master: ROLLBACK
2021-10-07 19:54:03.472325 (MainThread): Using postgres connection "master".
2021-10-07 19:54:03.472731 (MainThread): On master: BEGIN
2021-10-07 19:54:03.473722 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:54:03.474139 (MainThread): On master: COMMIT
2021-10-07 19:54:03.474539 (MainThread): Using postgres connection "master".
2021-10-07 19:54:03.474924 (MainThread): On master: COMMIT
2021-10-07 19:54:03.475696 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:54:03.476272 (MainThread): On master: Close
2021-10-07 19:54:03.476988 (MainThread): 19:54:03 | Concurrency: 2 threads (target='dev')
2021-10-07 19:54:03.477623 (MainThread): 19:54:03 | 
2021-10-07 19:54:03.481900 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:54:03.483893 (Thread-1): 19:54:03 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:54:03.484814 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:54:03.485384 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:54:03.507650 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:54:03.508185 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::cc / (10^n)::cc ), 10::cc)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1::cc ))::integer) AS n
    ) AS doubled_digits

  
2021-10-07 19:54:03.508621 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:54:03.513752 (Thread-1): Postgres error: type "cc" does not exist
LINE 11: ...           FROM generate_series(0, floor(log( $1::cc ))::int...
                                                              ^

2021-10-07 19:54:03.515809 (Thread-1): finished collecting timing info
2021-10-07 19:54:03.516778 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:54:03.517735 (Thread-1): Database Error in model task2 (models/task2.sql)
  type "cc" does not exist
  LINE 11: ...           FROM generate_series(0, floor(log( $1::cc ))::int...
                                                                ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedObject: type "cc" does not exist
LINE 11: ...           FROM generate_series(0, floor(log( $1::cc ))::int...
                                                              ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 15, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  type "cc" does not exist
  LINE 11: ...           FROM generate_series(0, floor(log( $1::cc ))::int...
                                                                ^
2021-10-07 19:54:03.520706 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a40ebbdd-5c76-4f6b-a256-e7d81eb9188a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556aea220>]}
2021-10-07 19:54:03.522357 (Thread-1): 19:54:03 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.04s]
2021-10-07 19:54:03.522965 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:54:03.525992 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:54:03.527024 (MainThread): Using postgres connection "master".
2021-10-07 19:54:03.527569 (MainThread): On master: BEGIN
2021-10-07 19:54:03.528019 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:54:03.533294 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:54:03.533957 (MainThread): On master: COMMIT
2021-10-07 19:54:03.534350 (MainThread): Using postgres connection "master".
2021-10-07 19:54:03.534795 (MainThread): On master: COMMIT
2021-10-07 19:54:03.535674 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:54:03.536195 (MainThread): On master: Close
2021-10-07 19:54:03.537175 (MainThread): 19:54:03 | 
2021-10-07 19:54:03.538004 (MainThread): 19:54:03 | Finished running 1 table model in 0.15s.
2021-10-07 19:54:03.538618 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:54:03.538990 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:54:03.597421 (MainThread): 
2021-10-07 19:54:03.598003 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:54:03.598764 (MainThread): 
2021-10-07 19:54:03.599406 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:54:03.600391 (MainThread):   type "cc" does not exist
2021-10-07 19:54:03.601010 (MainThread):   LINE 11: ...           FROM generate_series(0, floor(log( $1::cc ))::int...
2021-10-07 19:54:03.602112 (MainThread):                                                                 ^
2021-10-07 19:54:03.602932 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:54:03.604095 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556bc7b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556b5d4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb556c4a220>]}
2021-10-07 19:54:03.605363 (MainThread): Flushing usage events
2021-10-07 19:55:02.378260 (MainThread): Running with dbt=0.19.0
2021-10-07 19:55:02.510774 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:55:02.516061 (MainThread): Tracking: tracking
2021-10-07 19:55:02.518364 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbe5b970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bd887280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbe6c160>]}
2021-10-07 19:55:02.564366 (MainThread): Partial parsing not enabled
2021-10-07 19:55:02.575478 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:55:02.578473 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:55:02.605300 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:55:02.609654 (MainThread): Parsing macros/relations.sql
2021-10-07 19:55:02.612011 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:55:02.615565 (MainThread): Parsing macros/core.sql
2021-10-07 19:55:02.622596 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:55:02.680638 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:55:02.683552 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:55:02.685971 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:55:02.697407 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:55:02.699991 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:55:02.701931 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:55:02.703529 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:55:02.717583 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:55:02.744648 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:55:02.747383 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:55:02.785353 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:55:02.808146 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:55:02.816203 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:55:02.819602 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:55:02.836923 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:55:02.843751 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:55:02.851938 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:55:02.861189 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:55:02.863741 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:55:02.866026 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:55:02.868872 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:55:02.884982 (MainThread): Partial parsing not enabled
2021-10-07 19:55:02.940799 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:55:02.972952 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:55:03.016674 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:55:03.277110 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:55:03.283629 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '76d3489f-ccfe-4918-884a-9b66f59bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbd45d90>]}
2021-10-07 19:55:03.367192 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:55:03.369677 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:55:03.371595 (MainThread): 
2021-10-07 19:55:03.372633 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:55:03.375575 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:55:03.385867 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:55:03.386551 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:55:03.387095 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:55:03.393220 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:55:03.397349 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:55:03.403656 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:55:03.411716 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:55:03.412723 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:55:03.413671 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:55:03.417857 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:55:03.418515 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:55:03.418999 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:55:03.421831 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:55:03.434678 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:55:03.435550 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:55:03.446605 (MainThread): Using postgres connection "master".
2021-10-07 19:55:03.447188 (MainThread): On master: BEGIN
2021-10-07 19:55:03.447612 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:55:03.451714 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:55:03.452337 (MainThread): Using postgres connection "master".
2021-10-07 19:55:03.452768 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:55:03.458095 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 19:55:03.458840 (MainThread): On master: ROLLBACK
2021-10-07 19:55:03.459880 (MainThread): Using postgres connection "master".
2021-10-07 19:55:03.460766 (MainThread): On master: BEGIN
2021-10-07 19:55:03.461822 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:55:03.462435 (MainThread): On master: COMMIT
2021-10-07 19:55:03.462930 (MainThread): Using postgres connection "master".
2021-10-07 19:55:03.463390 (MainThread): On master: COMMIT
2021-10-07 19:55:03.464112 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:55:03.464605 (MainThread): On master: Close
2021-10-07 19:55:03.465363 (MainThread): 19:55:03 | Concurrency: 2 threads (target='dev')
2021-10-07 19:55:03.465935 (MainThread): 19:55:03 | 
2021-10-07 19:55:03.471453 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:55:03.473700 (Thread-1): 19:55:03 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:55:03.474731 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:55:03.475505 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:55:03.499137 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:55:03.499922 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits

  
2021-10-07 19:55:03.500847 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:55:03.505689 (Thread-1): Postgres error: there is no parameter $1
LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                        ^

2021-10-07 19:55:03.507310 (Thread-1): finished collecting timing info
2021-10-07 19:55:03.508094 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:55:03.508847 (Thread-1): Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                          ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedParameter: there is no parameter $1
LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 15, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  there is no parameter $1
  LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
                                                          ^
2021-10-07 19:55:03.512064 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '76d3489f-ccfe-4918-884a-9b66f59bff5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbc280d0>]}
2021-10-07 19:55:03.514382 (Thread-1): 19:55:03 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.04s]
2021-10-07 19:55:03.515095 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:55:03.517993 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:55:03.518587 (MainThread): Using postgres connection "master".
2021-10-07 19:55:03.519004 (MainThread): On master: BEGIN
2021-10-07 19:55:03.519510 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:55:03.523783 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:55:03.524343 (MainThread): On master: COMMIT
2021-10-07 19:55:03.524772 (MainThread): Using postgres connection "master".
2021-10-07 19:55:03.525185 (MainThread): On master: COMMIT
2021-10-07 19:55:03.526015 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:55:03.526559 (MainThread): On master: Close
2021-10-07 19:55:03.527960 (MainThread): 19:55:03 | 
2021-10-07 19:55:03.528789 (MainThread): 19:55:03 | Finished running 1 table model in 0.16s.
2021-10-07 19:55:03.529475 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:55:03.530161 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:55:03.586161 (MainThread): 
2021-10-07 19:55:03.587530 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:55:03.588170 (MainThread): 
2021-10-07 19:55:03.588680 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:55:03.589523 (MainThread):   there is no parameter $1
2021-10-07 19:55:03.590371 (MainThread):   LINE 11:             FROM generate_series(0, floor(log( $1 ))::intege...
2021-10-07 19:55:03.591297 (MainThread):                                                           ^
2021-10-07 19:55:03.592194 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:55:03.594128 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbd71fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbd96b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f65bbc35280>]}
2021-10-07 19:55:03.595174 (MainThread): Flushing usage events
2021-10-07 19:59:10.462480 (MainThread): Running with dbt=0.19.0
2021-10-07 19:59:10.583250 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:59:10.589040 (MainThread): Tracking: tracking
2021-10-07 19:59:10.591233 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1928180970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1929c2a280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1928190160>]}
2021-10-07 19:59:10.634247 (MainThread): Partial parsing not enabled
2021-10-07 19:59:10.643162 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:59:10.646710 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:59:10.674637 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:59:10.678532 (MainThread): Parsing macros/relations.sql
2021-10-07 19:59:10.680914 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:59:10.684691 (MainThread): Parsing macros/core.sql
2021-10-07 19:59:10.690680 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:59:10.754993 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:59:10.758010 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:59:10.760671 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:59:10.773194 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:59:10.775867 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:59:10.777678 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:59:10.779364 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:59:10.790926 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:59:10.817560 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:59:10.820780 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:59:10.857840 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:59:10.882289 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:59:10.890883 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:59:10.893948 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:59:10.911554 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:59:10.918368 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:59:10.926675 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:59:10.935430 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:59:10.938599 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:59:10.941252 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:59:10.945142 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:59:10.964076 (MainThread): Partial parsing not enabled
2021-10-07 19:59:11.016575 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:59:11.049210 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:59:11.094518 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:59:11.342884 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:59:11.349792 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a60787bd-f654-4561-b63d-7bcc05aa327c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1928074640>]}
2021-10-07 19:59:11.408502 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:59:11.410101 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:59:11.411934 (MainThread): 
2021-10-07 19:59:11.414211 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:59:11.417228 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:59:11.425476 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:59:11.426048 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:59:11.426679 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:59:11.431994 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:59:11.435169 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:59:11.442063 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:59:11.451279 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:59:11.451802 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:59:11.452224 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:59:11.456336 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:11.456851 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:59:11.457261 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:59:11.459790 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:59:11.471861 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:59:11.472948 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:59:11.483514 (MainThread): Using postgres connection "master".
2021-10-07 19:59:11.484066 (MainThread): On master: BEGIN
2021-10-07 19:59:11.484797 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:59:11.489578 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:11.490120 (MainThread): Using postgres connection "master".
2021-10-07 19:59:11.490500 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:59:11.495983 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:59:11.496874 (MainThread): On master: ROLLBACK
2021-10-07 19:59:11.497594 (MainThread): Using postgres connection "master".
2021-10-07 19:59:11.497981 (MainThread): On master: BEGIN
2021-10-07 19:59:11.499114 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:11.499651 (MainThread): On master: COMMIT
2021-10-07 19:59:11.500063 (MainThread): Using postgres connection "master".
2021-10-07 19:59:11.500630 (MainThread): On master: COMMIT
2021-10-07 19:59:11.501347 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:59:11.501765 (MainThread): On master: Close
2021-10-07 19:59:11.502500 (MainThread): 19:59:11 | Concurrency: 2 threads (target='dev')
2021-10-07 19:59:11.503041 (MainThread): 19:59:11 | 
2021-10-07 19:59:11.507268 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:59:11.509808 (Thread-1): 19:59:11 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:59:11.510852 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:59:11.511427 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:59:11.534111 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:59:11.534833 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    /*SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits*/

    CASE
                WHEN    (
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 2, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 4, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 6, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 8, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 10, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 12, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 14, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 16, 1) AS TINYINT)
                ) % 10 = 0 THEN TRUE
                ELSE FALSE

  
2021-10-07 19:59:11.535695 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:59:11.540117 (Thread-1): Postgres error: syntax error at or near "CASE"
LINE 14:     CASE
             ^

2021-10-07 19:59:11.541671 (Thread-1): finished collecting timing info
2021-10-07 19:59:11.542381 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:59:11.543284 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 14:     CASE
               ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CASE"
LINE 14:     CASE
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 44, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 14:     CASE
               ^
2021-10-07 19:59:11.547471 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a60787bd-f654-4561-b63d-7bcc05aa327c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1927f4b0d0>]}
2021-10-07 19:59:11.549606 (Thread-1): 19:59:11 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.04s]
2021-10-07 19:59:11.550285 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:59:11.553061 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:59:11.553652 (MainThread): Using postgres connection "master".
2021-10-07 19:59:11.554126 (MainThread): On master: BEGIN
2021-10-07 19:59:11.554603 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:59:11.558684 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:11.559247 (MainThread): On master: COMMIT
2021-10-07 19:59:11.559716 (MainThread): Using postgres connection "master".
2021-10-07 19:59:11.560180 (MainThread): On master: COMMIT
2021-10-07 19:59:11.561068 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:59:11.561806 (MainThread): On master: Close
2021-10-07 19:59:11.562794 (MainThread): 19:59:11 | 
2021-10-07 19:59:11.563470 (MainThread): 19:59:11 | Finished running 1 table model in 0.15s.
2021-10-07 19:59:11.564144 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:59:11.564637 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:59:11.621817 (MainThread): 
2021-10-07 19:59:11.622451 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:59:11.622912 (MainThread): 
2021-10-07 19:59:11.623569 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:59:11.624946 (MainThread):   syntax error at or near "CASE"
2021-10-07 19:59:11.625710 (MainThread):   LINE 14:     CASE
2021-10-07 19:59:11.626660 (MainThread):                ^
2021-10-07 19:59:11.627779 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:59:11.629551 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1928082730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1927fe3fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1927f59040>]}
2021-10-07 19:59:11.630382 (MainThread): Flushing usage events
2021-10-07 19:59:43.029913 (MainThread): Running with dbt=0.19.0
2021-10-07 19:59:43.160045 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:59:43.165855 (MainThread): Tracking: tracking
2021-10-07 19:59:43.168151 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5078fd4910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f507c5db430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5078fe6100>]}
2021-10-07 19:59:43.211640 (MainThread): Partial parsing not enabled
2021-10-07 19:59:43.220156 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:59:43.223269 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:59:43.251993 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:59:43.255800 (MainThread): Parsing macros/relations.sql
2021-10-07 19:59:43.258126 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:59:43.262402 (MainThread): Parsing macros/core.sql
2021-10-07 19:59:43.268366 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:59:43.328766 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:59:43.331707 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:59:43.335568 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:59:43.347853 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:59:43.350515 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:59:43.352234 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:59:43.354080 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:59:43.366023 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 19:59:43.394046 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 19:59:43.396697 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 19:59:43.434891 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 19:59:43.458293 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 19:59:43.467536 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 19:59:43.470660 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 19:59:43.489948 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 19:59:43.496840 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 19:59:43.506593 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 19:59:43.515464 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 19:59:43.518213 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 19:59:43.520811 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 19:59:43.523637 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 19:59:43.543596 (MainThread): Partial parsing not enabled
2021-10-07 19:59:43.598800 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 19:59:43.631572 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:59:43.674807 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 19:59:43.921307 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 19:59:43.926798 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c53e99ed-ec9a-4326-be51-52d949cb9881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5078e87ee0>]}
2021-10-07 19:59:43.990056 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 19:59:43.992079 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 19:59:43.993703 (MainThread): 
2021-10-07 19:59:43.994683 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:59:43.997711 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 19:59:44.006258 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 19:59:44.006816 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 19:59:44.007319 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 19:59:44.012555 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 19:59:44.016045 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 19:59:44.022560 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 19:59:44.030440 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:59:44.031110 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 19:59:44.032356 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 19:59:44.037026 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:44.037762 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 19:59:44.038247 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 19:59:44.040740 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 19:59:44.053649 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 19:59:44.054516 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 19:59:44.065627 (MainThread): Using postgres connection "master".
2021-10-07 19:59:44.066271 (MainThread): On master: BEGIN
2021-10-07 19:59:44.066801 (MainThread): Opening a new connection, currently in state init
2021-10-07 19:59:44.071053 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:44.071675 (MainThread): Using postgres connection "master".
2021-10-07 19:59:44.072162 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 19:59:44.078076 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 19:59:44.079293 (MainThread): On master: ROLLBACK
2021-10-07 19:59:44.080231 (MainThread): Using postgres connection "master".
2021-10-07 19:59:44.080700 (MainThread): On master: BEGIN
2021-10-07 19:59:44.081754 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 19:59:44.082444 (MainThread): On master: COMMIT
2021-10-07 19:59:44.083114 (MainThread): Using postgres connection "master".
2021-10-07 19:59:44.083720 (MainThread): On master: COMMIT
2021-10-07 19:59:44.084537 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:59:44.085059 (MainThread): On master: Close
2021-10-07 19:59:44.085808 (MainThread): 19:59:44 | Concurrency: 2 threads (target='dev')
2021-10-07 19:59:44.086513 (MainThread): 19:59:44 | 
2021-10-07 19:59:44.092188 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 19:59:44.094646 (Thread-1): 19:59:44 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 19:59:44.095708 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 19:59:44.096367 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 19:59:44.118712 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 19:59:44.119298 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    /*SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits*/
    SELECt * FROM
    CASE
                WHEN    (
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 2, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 4, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 6, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 8, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 10, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 12, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 14, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 16, 1) AS TINYINT)
                ) % 10 = 0 THEN TRUE
                ELSE FALSE

  
2021-10-07 19:59:44.119813 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 19:59:44.123878 (Thread-1): Postgres error: syntax error at or near "CASE"
LINE 14:     CASE
             ^

2021-10-07 19:59:44.125381 (Thread-1): finished collecting timing info
2021-10-07 19:59:44.126005 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 19:59:44.126744 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 14:     CASE
               ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CASE"
LINE 14:     CASE
             ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 44, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 14:     CASE
               ^
2021-10-07 19:59:44.130206 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c53e99ed-ec9a-4326-be51-52d949cb9881', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5078d9b0d0>]}
2021-10-07 19:59:44.132390 (Thread-1): 19:59:44 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.03s]
2021-10-07 19:59:44.133366 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 19:59:44.136643 (MainThread): Acquiring new postgres connection "master".
2021-10-07 19:59:44.137497 (MainThread): Using postgres connection "master".
2021-10-07 19:59:44.138115 (MainThread): On master: BEGIN
2021-10-07 19:59:44.138660 (MainThread): Opening a new connection, currently in state closed
2021-10-07 19:59:44.143787 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 19:59:44.144776 (MainThread): On master: COMMIT
2021-10-07 19:59:44.145565 (MainThread): Using postgres connection "master".
2021-10-07 19:59:44.146309 (MainThread): On master: COMMIT
2021-10-07 19:59:44.147391 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 19:59:44.148333 (MainThread): On master: Close
2021-10-07 19:59:44.149340 (MainThread): 19:59:44 | 
2021-10-07 19:59:44.150126 (MainThread): 19:59:44 | Finished running 1 table model in 0.15s.
2021-10-07 19:59:44.150831 (MainThread): Connection 'master' was properly closed.
2021-10-07 19:59:44.151511 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 19:59:44.214923 (MainThread): 
2021-10-07 19:59:44.215593 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 19:59:44.216133 (MainThread): 
2021-10-07 19:59:44.216744 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 19:59:44.218121 (MainThread):   syntax error at or near "CASE"
2021-10-07 19:59:44.218963 (MainThread):   LINE 14:     CASE
2021-10-07 19:59:44.220215 (MainThread):                ^
2021-10-07 19:59:44.221144 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 19:59:44.222074 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5078e99370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5078ea0880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f50784ff850>]}
2021-10-07 19:59:44.222698 (MainThread): Flushing usage events
2021-10-07 19:59:59.650715 (MainThread): Running with dbt=0.19.0
2021-10-07 19:59:59.784719 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 19:59:59.790580 (MainThread): Tracking: tracking
2021-10-07 19:59:59.792807 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5735765fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5738d6d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5735777070>]}
2021-10-07 19:59:59.836662 (MainThread): Partial parsing not enabled
2021-10-07 19:59:59.850526 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 19:59:59.853813 (MainThread): Parsing macros/adapters.sql
2021-10-07 19:59:59.881753 (MainThread): Parsing macros/catalog.sql
2021-10-07 19:59:59.885415 (MainThread): Parsing macros/relations.sql
2021-10-07 19:59:59.887986 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 19:59:59.892458 (MainThread): Parsing macros/core.sql
2021-10-07 19:59:59.900365 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 19:59:59.959487 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 19:59:59.962657 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 19:59:59.965234 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 19:59:59.977146 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 19:59:59.979849 (MainThread): Parsing macros/etc/query.sql
2021-10-07 19:59:59.981711 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 19:59:59.983380 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 19:59:59.994947 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:00:00.022223 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:00:00.025634 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:00:00.064640 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:00:00.090105 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:00:00.100093 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:00:00.103140 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:00:00.122091 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:00:00.129078 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:00:00.137808 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:00:00.147093 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:00:00.150162 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:00:00.152928 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:00:00.155899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:00:00.177034 (MainThread): Partial parsing not enabled
2021-10-07 20:00:00.233476 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:00:00.267174 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:00:00.313995 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:00:00.560325 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:00:00.566804 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a8d6ecd6-6ac4-4bdb-8e1f-a6f5cdd6817e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573567a940>]}
2021-10-07 20:00:00.629248 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:00:00.631181 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:00:00.633483 (MainThread): 
2021-10-07 20:00:00.634508 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:00:00.637752 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:00:00.647764 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:00:00.648374 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:00:00.648878 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:00:00.653831 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-07 20:00:00.656607 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:00:00.664128 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:00:00.673149 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:00:00.673684 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:00:00.674250 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:00:00.678981 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:00:00.679670 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:00:00.680271 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:00:00.683279 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:00:00.695736 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:00:00.696963 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:00:00.707046 (MainThread): Using postgres connection "master".
2021-10-07 20:00:00.707834 (MainThread): On master: BEGIN
2021-10-07 20:00:00.708333 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:00:00.713300 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:00:00.713903 (MainThread): Using postgres connection "master".
2021-10-07 20:00:00.714419 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:00:00.719937 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 20:00:00.721267 (MainThread): On master: ROLLBACK
2021-10-07 20:00:00.722132 (MainThread): Using postgres connection "master".
2021-10-07 20:00:00.722703 (MainThread): On master: BEGIN
2021-10-07 20:00:00.723655 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:00:00.724155 (MainThread): On master: COMMIT
2021-10-07 20:00:00.724589 (MainThread): Using postgres connection "master".
2021-10-07 20:00:00.725000 (MainThread): On master: COMMIT
2021-10-07 20:00:00.725879 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:00:00.726325 (MainThread): On master: Close
2021-10-07 20:00:00.727108 (MainThread): 20:00:00 | Concurrency: 2 threads (target='dev')
2021-10-07 20:00:00.727917 (MainThread): 20:00:00 | 
2021-10-07 20:00:00.733587 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:00:00.735523 (Thread-1): 20:00:00 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:00:00.736515 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:00:00.737284 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:00:00.757475 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:00:00.758106 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    /*SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits*/
    SELECt * FROM (
        CASE
                WHEN    (
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 2, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 4, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 6, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 8, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 10, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 12, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 14, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 16, 1) AS TINYINT)
                ) % 10 = 0 THEN TRUE
                ELSE FALSE)

  
2021-10-07 20:00:00.758673 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:00:00.763897 (Thread-1): Postgres error: syntax error at or near "CASE"
LINE 14:         CASE
                 ^

2021-10-07 20:00:00.765853 (Thread-1): finished collecting timing info
2021-10-07 20:00:00.766651 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:00:00.767627 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 14:         CASE
                   ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CASE"
LINE 14:         CASE
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 44, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 14:         CASE
                   ^
2021-10-07 20:00:00.770217 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a8d6ecd6-6ac4-4bdb-8e1f-a6f5cdd6817e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57355310a0>]}
2021-10-07 20:00:00.772064 (Thread-1): 20:00:00 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.03s]
2021-10-07 20:00:00.772536 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:00:00.775026 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:00:00.775729 (MainThread): Using postgres connection "master".
2021-10-07 20:00:00.776331 (MainThread): On master: BEGIN
2021-10-07 20:00:00.776965 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:00:00.781994 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:00:00.782599 (MainThread): On master: COMMIT
2021-10-07 20:00:00.783362 (MainThread): Using postgres connection "master".
2021-10-07 20:00:00.783960 (MainThread): On master: COMMIT
2021-10-07 20:00:00.784879 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:00:00.785418 (MainThread): On master: Close
2021-10-07 20:00:00.786583 (MainThread): 20:00:00 | 
2021-10-07 20:00:00.787206 (MainThread): 20:00:00 | Finished running 1 table model in 0.15s.
2021-10-07 20:00:00.787861 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:00:00.788386 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:00:00.844793 (MainThread): 
2021-10-07 20:00:00.845305 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:00:00.846382 (MainThread): 
2021-10-07 20:00:00.847541 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 20:00:00.848702 (MainThread):   syntax error at or near "CASE"
2021-10-07 20:00:00.850014 (MainThread):   LINE 14:         CASE
2021-10-07 20:00:00.850643 (MainThread):                    ^
2021-10-07 20:00:00.851513 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:00:00.852468 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5735673b20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f573568ecd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f57356ae190>]}
2021-10-07 20:00:00.853204 (MainThread): Flushing usage events
2021-10-07 20:01:57.162155 (MainThread): Running with dbt=0.19.0
2021-10-07 20:01:57.301971 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:01:57.307552 (MainThread): Tracking: tracking
2021-10-07 20:01:57.309862 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb53799a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb6e232b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb5389190>]}
2021-10-07 20:01:57.353360 (MainThread): Partial parsing not enabled
2021-10-07 20:01:57.384956 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:01:57.388794 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:01:57.416095 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:01:57.419658 (MainThread): Parsing macros/relations.sql
2021-10-07 20:01:57.421799 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:01:57.425547 (MainThread): Parsing macros/core.sql
2021-10-07 20:01:57.431456 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:01:57.485198 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:01:57.488533 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:01:57.491480 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:01:57.504511 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:01:57.506951 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:01:57.509384 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:01:57.511364 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:01:57.523427 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:01:57.555313 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:01:57.558818 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:01:57.598478 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:01:57.622577 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:01:57.631350 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:01:57.634613 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:01:57.653020 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:01:57.660803 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:01:57.669526 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:01:57.678358 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:01:57.680857 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:01:57.683264 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:01:57.685994 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:01:57.704856 (MainThread): Partial parsing not enabled
2021-10-07 20:01:57.760193 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:01:57.793562 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:01:57.836090 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:01:58.092675 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:01:58.099942 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '04a6a9d8-f728-4067-ad18-24cdbfc090d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb522a640>]}
2021-10-07 20:01:58.160673 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:01:58.164528 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:01:58.167074 (MainThread): 
2021-10-07 20:01:58.168086 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:01:58.171049 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:01:58.179788 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:01:58.180508 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:01:58.181729 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:01:58.187338 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:01:58.190384 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:01:58.197202 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:01:58.206154 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:01:58.206786 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:01:58.207340 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:01:58.211887 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:01:58.212572 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:01:58.213252 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:01:58.216820 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:01:58.228292 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:01:58.229326 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:01:58.239873 (MainThread): Using postgres connection "master".
2021-10-07 20:01:58.240880 (MainThread): On master: BEGIN
2021-10-07 20:01:58.241742 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:01:58.247820 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:01:58.248342 (MainThread): Using postgres connection "master".
2021-10-07 20:01:58.248731 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:01:58.254692 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 20:01:58.255465 (MainThread): On master: ROLLBACK
2021-10-07 20:01:58.256145 (MainThread): Using postgres connection "master".
2021-10-07 20:01:58.256542 (MainThread): On master: BEGIN
2021-10-07 20:01:58.257549 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:01:58.258022 (MainThread): On master: COMMIT
2021-10-07 20:01:58.258467 (MainThread): Using postgres connection "master".
2021-10-07 20:01:58.258923 (MainThread): On master: COMMIT
2021-10-07 20:01:58.259610 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:01:58.260050 (MainThread): On master: Close
2021-10-07 20:01:58.261010 (MainThread): 20:01:58 | Concurrency: 2 threads (target='dev')
2021-10-07 20:01:58.261578 (MainThread): 20:01:58 | 
2021-10-07 20:01:58.266525 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:01:58.268516 (Thread-1): 20:01:58 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:01:58.269494 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:01:58.270101 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:01:58.292252 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:01:58.292911 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */

    
    /*SELECT
            MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
    FROM
    (SELECT
            MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
            * (MOD(n,2) + 1)
            AS doubled_digit
            FROM generate_series(0, floor(log( $1 ))::integer) AS n
    ) AS doubled_digits*/
        CASE
                WHEN    (
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 1, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 2, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 3, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 4, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 5, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 6, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 7, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 8, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 9, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 10, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 11, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 12, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 13, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 14, 1) AS TINYINT)
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) / 10
                        + 2 * CAST(SUBSTRING(cc, 15, 1) AS TINYINT) % 10
                        + CAST(SUBSTRING(cc, 16, 1) AS TINYINT)
                ) % 10 = 0 THEN TRUE
                ELSE FALSE
                END AS QuantityText

  
2021-10-07 20:01:58.293418 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:01:58.298203 (Thread-1): Postgres error: syntax error at or near "CASE"
LINE 13:         CASE
                 ^

2021-10-07 20:01:58.300206 (Thread-1): finished collecting timing info
2021-10-07 20:01:58.301219 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:01:58.302129 (Thread-1): Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 13:         CASE
                   ^
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CASE"
LINE 13:         CASE
                 ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 281, in compile_and_execute
    ctx.node = self.compile(manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/compile.py", line 32, in compile
    return compiler.compile_node(self.node, manifest, {})
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 502, in compile_node
    node = self._compile_node(node, manifest, extra_context)
  File "/usr/local/lib/python3.8/site-packages/dbt/compilation.py", line 404, in _compile_node
    compiled_node.compiled_sql = jinja.get_rendered(
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 528, in render_template
    return template.render(ctx)
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 1090, in render
    self.environment.handle_exception()
  File "/usr/local/lib/python3.8/site-packages/jinja2/environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "/usr/local/lib/python3.8/site-packages/jinja2/_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 16, in top-level template code
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 44, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 2, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 10, in template
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  syntax error at or near "CASE"
  LINE 13:         CASE
                   ^
2021-10-07 20:01:58.305017 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '04a6a9d8-f728-4067-ad18-24cdbfc090d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb51460a0>]}
2021-10-07 20:01:58.306654 (Thread-1): 20:01:58 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.04s]
2021-10-07 20:01:58.307329 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:01:58.311489 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:01:58.312073 (MainThread): Using postgres connection "master".
2021-10-07 20:01:58.312547 (MainThread): On master: BEGIN
2021-10-07 20:01:58.313084 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:01:58.317562 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:01:58.318403 (MainThread): On master: COMMIT
2021-10-07 20:01:58.319225 (MainThread): Using postgres connection "master".
2021-10-07 20:01:58.319759 (MainThread): On master: COMMIT
2021-10-07 20:01:58.320982 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:01:58.321662 (MainThread): On master: Close
2021-10-07 20:01:58.322583 (MainThread): 20:01:58 | 
2021-10-07 20:01:58.323200 (MainThread): 20:01:58 | Finished running 1 table model in 0.15s.
2021-10-07 20:01:58.323683 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:01:58.324098 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:01:58.380966 (MainThread): 
2021-10-07 20:01:58.381901 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:01:58.382611 (MainThread): 
2021-10-07 20:01:58.383410 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 20:01:58.384643 (MainThread):   syntax error at or near "CASE"
2021-10-07 20:01:58.385570 (MainThread):   LINE 13:         CASE
2021-10-07 20:01:58.386577 (MainThread):                    ^
2021-10-07 20:01:58.387437 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:01:58.388523 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb522c7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb5255e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdbb52cc3a0>]}
2021-10-07 20:01:58.389309 (MainThread): Flushing usage events
2021-10-07 20:04:19.050274 (MainThread): Running with dbt=0.19.0
2021-10-07 20:04:19.182316 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:04:19.188179 (MainThread): Tracking: tracking
2021-10-07 20:04:19.190356 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643cc1f970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643e6ca280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643cc31160>]}
2021-10-07 20:04:19.231954 (MainThread): Partial parsing not enabled
2021-10-07 20:04:19.240131 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:04:19.243684 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:04:19.271626 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:04:19.275215 (MainThread): Parsing macros/relations.sql
2021-10-07 20:04:19.277623 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:04:19.281111 (MainThread): Parsing macros/core.sql
2021-10-07 20:04:19.286533 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:04:19.344081 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:04:19.348080 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:04:19.350648 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:04:19.362248 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:04:19.364882 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:04:19.367061 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:04:19.368949 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:04:19.380578 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:04:19.408373 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:04:19.411300 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:04:19.452880 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:04:19.477376 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:04:19.486352 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:04:19.489292 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:04:19.508696 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:04:19.515422 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:04:19.524498 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:04:19.533490 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:04:19.536292 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:04:19.538694 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:04:19.541707 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:04:19.560180 (MainThread): Partial parsing not enabled
2021-10-07 20:04:19.621027 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:19.652692 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:04:19.674026 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:04:19.708834 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:04:19.958921 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:04:19.965954 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '908ed9b7-c88a-44a6-93b9-03a5ff34936f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c9fcf70>]}
2021-10-07 20:04:20.031326 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:04:20.033563 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:04:20.035277 (MainThread): 
2021-10-07 20:04:20.036927 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:04:20.039961 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:04:20.054463 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:04:20.055067 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:04:20.055579 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:04:20.060787 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:04:20.064782 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:04:20.074176 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:04:20.082914 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:04:20.083547 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:04:20.084012 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:04:20.088844 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:20.089459 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:04:20.089887 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:04:20.092473 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:04:20.105257 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:04:20.106198 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:04:20.118964 (MainThread): Using postgres connection "master".
2021-10-07 20:04:20.120061 (MainThread): On master: BEGIN
2021-10-07 20:04:20.120556 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:04:20.124839 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:20.125434 (MainThread): Using postgres connection "master".
2021-10-07 20:04:20.125869 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:04:20.131568 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 20:04:20.132316 (MainThread): On master: ROLLBACK
2021-10-07 20:04:20.133078 (MainThread): Using postgres connection "master".
2021-10-07 20:04:20.133506 (MainThread): On master: BEGIN
2021-10-07 20:04:20.134493 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:20.134921 (MainThread): On master: COMMIT
2021-10-07 20:04:20.135356 (MainThread): Using postgres connection "master".
2021-10-07 20:04:20.135767 (MainThread): On master: COMMIT
2021-10-07 20:04:20.136470 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:04:20.136900 (MainThread): On master: Close
2021-10-07 20:04:20.137650 (MainThread): 20:04:20 | Concurrency: 2 threads (target='dev')
2021-10-07 20:04:20.138221 (MainThread): 20:04:20 | 
2021-10-07 20:04:20.142708 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:04:20.144667 (Thread-1): 20:04:20 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:04:20.145607 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:04:20.146121 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:04:20.171971 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 20:04:20.185203 (Thread-1): finished collecting timing info
2021-10-07 20:04:20.214846 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:04:20.215468 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 20:04:20.216040 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:04:20.220804 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:04:20.224153 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:04:20.224852 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:04:20.225895 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:04:20.239095 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 20:04:20.250332 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:04:20.250929 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 20:04:20.251999 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:20.252682 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:04:20.253146 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 20:04:20.254584 (Thread-1): Postgres error: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 20:04:20.255192 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 20:04:20.256016 (Thread-1): finished collecting timing info
2021-10-07 20:04:20.256678 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:04:20.257497 (Thread-1): Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:04:20.259682 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '908ed9b7-c88a-44a6-93b9-03a5ff34936f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c9f9400>]}
2021-10-07 20:04:20.261442 (Thread-1): 20:04:20 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 20:04:20.262242 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:04:20.264771 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:04:20.265427 (MainThread): Using postgres connection "master".
2021-10-07 20:04:20.265921 (MainThread): On master: BEGIN
2021-10-07 20:04:20.266437 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:04:20.271526 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:04:20.272262 (MainThread): On master: COMMIT
2021-10-07 20:04:20.272932 (MainThread): Using postgres connection "master".
2021-10-07 20:04:20.273611 (MainThread): On master: COMMIT
2021-10-07 20:04:20.274415 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:04:20.275083 (MainThread): On master: Close
2021-10-07 20:04:20.276059 (MainThread): 20:04:20 | 
2021-10-07 20:04:20.276584 (MainThread): 20:04:20 | Finished running 1 table model in 0.24s.
2021-10-07 20:04:20.277143 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:04:20.277883 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:04:20.343441 (MainThread): 
2021-10-07 20:04:20.344170 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:04:20.345361 (MainThread): 
2021-10-07 20:04:20.346724 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 20:04:20.348730 (MainThread):   function luhn(bigint) does not exist
2021-10-07 20:04:20.349988 (MainThread):   LINE 19: WHERE luhn(creditcard::int8) = FALSE
2021-10-07 20:04:20.350771 (MainThread):                  ^
2021-10-07 20:04:20.351524 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 20:04:20.352542 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:04:20.353399 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:04:20.354294 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c974d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c974b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f643c9746d0>]}
2021-10-07 20:04:20.355548 (MainThread): Flushing usage events
2021-10-07 20:04:52.435496 (MainThread): Running with dbt=0.19.0
2021-10-07 20:04:52.562198 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['luhn'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:04:52.568008 (MainThread): Tracking: tracking
2021-10-07 20:04:52.570213 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040fc43940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f041324b460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040fc54130>]}
2021-10-07 20:04:52.617919 (MainThread): Partial parsing not enabled
2021-10-07 20:04:52.626904 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:04:52.630032 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:04:52.657707 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:04:52.661058 (MainThread): Parsing macros/relations.sql
2021-10-07 20:04:52.663768 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:04:52.668104 (MainThread): Parsing macros/core.sql
2021-10-07 20:04:52.676340 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:04:52.734452 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:04:52.737617 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:04:52.740776 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:04:52.752557 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:04:52.754903 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:04:52.756755 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:04:52.758332 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:04:52.770075 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:04:52.796789 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:04:52.799584 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:04:52.838636 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:04:52.862397 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:04:52.870652 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:04:52.873653 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:04:52.890927 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:04:52.897997 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:04:52.906644 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:04:52.915504 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:04:52.918146 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:04:52.920575 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:04:52.923722 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:04:52.942166 (MainThread): Partial parsing not enabled
2021-10-07 20:04:52.995459 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:53.024422 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:04:53.047948 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:04:53.081367 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:04:53.329874 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:04:53.337694 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '44cb6de9-fd4a-4657-9534-6bd823179ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040f96d3d0>]}
2021-10-07 20:04:53.399886 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:04:53.401803 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:04:53.403425 (MainThread): 
2021-10-07 20:04:53.404284 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:04:53.407120 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:04:53.421708 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:04:53.422302 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:04:53.422765 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:04:53.429158 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:04:53.433056 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:04:53.440417 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:04:53.449716 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:04:53.450349 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:04:53.450895 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:04:53.455561 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:53.456172 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:04:53.456754 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:04:53.459346 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:04:53.471704 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:04:53.472647 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:04:53.485612 (MainThread): Using postgres connection "master".
2021-10-07 20:04:53.486206 (MainThread): On master: BEGIN
2021-10-07 20:04:53.486730 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:04:53.490681 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:53.491415 (MainThread): Using postgres connection "master".
2021-10-07 20:04:53.491966 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:04:53.497750 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 20:04:53.499005 (MainThread): On master: ROLLBACK
2021-10-07 20:04:53.500148 (MainThread): Using postgres connection "master".
2021-10-07 20:04:53.500842 (MainThread): On master: BEGIN
2021-10-07 20:04:53.501900 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:53.502382 (MainThread): On master: COMMIT
2021-10-07 20:04:53.502845 (MainThread): Using postgres connection "master".
2021-10-07 20:04:53.503337 (MainThread): On master: COMMIT
2021-10-07 20:04:53.504133 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:04:53.504669 (MainThread): On master: Close
2021-10-07 20:04:53.505474 (MainThread): 20:04:53 | Concurrency: 2 threads (target='dev')
2021-10-07 20:04:53.505991 (MainThread): 20:04:53 | 
2021-10-07 20:04:53.510048 (Thread-1): Began running node model.my_new_project.luhn
2021-10-07 20:04:53.512291 (Thread-1): 20:04:53 | 1 of 1 START view model public.luhn.................................. [RUN]
2021-10-07 20:04:53.513293 (Thread-1): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:53.513857 (Thread-1): Compiling model.my_new_project.luhn
2021-10-07 20:04:53.532438 (Thread-1): Writing injected SQL for node "model.my_new_project.luhn"
2021-10-07 20:04:53.543747 (Thread-1): finished collecting timing info
2021-10-07 20:04:53.584469 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:53.585414 (Thread-1): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_tmp" cascade
2021-10-07 20:04:53.586075 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:04:53.590427 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-07 20:04:53.595013 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:53.595760 (Thread-1): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-07 20:04:53.596523 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-07 20:04:53.603135 (Thread-1): Writing runtime SQL for node "model.my_new_project.luhn"
2021-10-07 20:04:53.612849 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:53.613360 (Thread-1): On model.my_new_project.luhn: BEGIN
2021-10-07 20:04:53.614150 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:53.614641 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:04:53.615134 (Thread-1): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */

  create view "dellstore"."public"."luhn__dbt_tmp" as (
    /* Taken from https://wiki.postgresql.org/wiki/Luhn_algorithm */

CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits $$ LANGUAGE SQL
  );

2021-10-07 20:04:53.615902 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 6: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
        ^

2021-10-07 20:04:53.616309 (Thread-1): On model.my_new_project.luhn: ROLLBACK
2021-10-07 20:04:53.617015 (Thread-1): finished collecting timing info
2021-10-07 20:04:53.617657 (Thread-1): On model.my_new_project.luhn: Close
2021-10-07 20:04:53.618345 (Thread-1): Database Error in model luhn (models/luhn.sql)
  syntax error at or near "CREATE"
  LINE 6: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
          ^
  compiled SQL at target/run/my_new_project/models/luhn.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 6: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model luhn (models/luhn.sql)
  syntax error at or near "CREATE"
  LINE 6: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
          ^
  compiled SQL at target/run/my_new_project/models/luhn.sql
2021-10-07 20:04:53.620398 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '44cb6de9-fd4a-4657-9534-6bd823179ece', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040f1213a0>]}
2021-10-07 20:04:53.621970 (Thread-1): 20:04:53 | 1 of 1 ERROR creating view model public.luhn......................... [ERROR in 0.11s]
2021-10-07 20:04:53.622469 (Thread-1): Finished running node model.my_new_project.luhn
2021-10-07 20:04:53.625290 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:04:53.625831 (MainThread): Using postgres connection "master".
2021-10-07 20:04:53.626212 (MainThread): On master: BEGIN
2021-10-07 20:04:53.626702 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:04:53.631157 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:04:53.631847 (MainThread): On master: COMMIT
2021-10-07 20:04:53.632871 (MainThread): Using postgres connection "master".
2021-10-07 20:04:53.633867 (MainThread): On master: COMMIT
2021-10-07 20:04:53.634750 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:04:53.635587 (MainThread): On master: Close
2021-10-07 20:04:53.636919 (MainThread): 20:04:53 | 
2021-10-07 20:04:53.637858 (MainThread): 20:04:53 | Finished running 1 view model in 0.23s.
2021-10-07 20:04:53.638742 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:04:53.639206 (MainThread): Connection 'model.my_new_project.luhn' was properly closed.
2021-10-07 20:04:53.700543 (MainThread): 
2021-10-07 20:04:53.701152 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:04:53.701681 (MainThread): 
2021-10-07 20:04:53.702333 (MainThread): Database Error in model luhn (models/luhn.sql)
2021-10-07 20:04:53.703701 (MainThread):   syntax error at or near "CREATE"
2021-10-07 20:04:53.704885 (MainThread):   LINE 6: CREATE OR REPLACE FUNCTION luhn_verify(int8) RETURNS boolean...
2021-10-07 20:04:53.705935 (MainThread):           ^
2021-10-07 20:04:53.706776 (MainThread):   compiled SQL at target/run/my_new_project/models/luhn.sql
2021-10-07 20:04:53.707516 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:04:53.708676 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040f121370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040f121310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f040f121fd0>]}
2021-10-07 20:04:53.709459 (MainThread): Flushing usage events
2021-10-07 20:05:25.888842 (MainThread): Running with dbt=0.19.0
2021-10-07 20:05:26.013767 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['luhn'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:05:26.019500 (MainThread): Tracking: tracking
2021-10-07 20:05:26.021652 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff4f54970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff6980280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff4f66160>]}
2021-10-07 20:05:26.090662 (MainThread): Partial parsing not enabled
2021-10-07 20:05:26.101672 (MainThread): Parsing macros/luhn.sql
2021-10-07 20:05:26.106281 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:05:26.109752 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:05:26.137201 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:05:26.141894 (MainThread): Parsing macros/relations.sql
2021-10-07 20:05:26.144460 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:05:26.148323 (MainThread): Parsing macros/core.sql
2021-10-07 20:05:26.154592 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:05:26.210940 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:05:26.214161 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:05:26.216890 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:05:26.229110 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:05:26.231699 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:05:26.233543 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:05:26.235350 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:05:26.248734 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:05:26.276007 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:05:26.278837 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:05:26.316116 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:05:26.342943 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:05:26.351405 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:05:26.354601 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:05:26.372571 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:05:26.380292 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:05:26.389074 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:05:26.398923 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:05:26.401692 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:05:26.404196 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:05:26.407047 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:05:26.424721 (MainThread): Partial parsing not enabled
2021-10-07 20:05:26.482746 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:05:26.518314 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:05:26.553499 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:05:26.802871 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:05:26.809534 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92b12e72-5ee3-4a63-9a37-2350b1b077fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff4da97f0>]}
2021-10-07 20:05:26.868335 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:05:26.870490 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:05:26.871484 (MainThread): The selector 'luhn' does not match any nodes and will be ignored
2021-10-07 20:05:26.872622 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-07 20:05:26.873926 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff4d19040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff4d19310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fdff4d193a0>]}
2021-10-07 20:05:26.874628 (MainThread): Flushing usage events
2021-10-07 20:05:27.472216 (MainThread): Connection 'snapshot.my_new_project.task1_snapshot' was properly closed.
2021-10-07 20:05:37.836533 (MainThread): Running with dbt=0.19.0
2021-10-07 20:05:37.960469 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:05:37.966263 (MainThread): Tracking: tracking
2021-10-07 20:05:37.968568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa886453970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa887e7f280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa886464160>]}
2021-10-07 20:05:38.011168 (MainThread): Partial parsing not enabled
2021-10-07 20:05:38.017661 (MainThread): Parsing macros/luhn.sql
2021-10-07 20:05:38.021959 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:05:38.025003 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:05:38.050915 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:05:38.054290 (MainThread): Parsing macros/relations.sql
2021-10-07 20:05:38.056363 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:05:38.059991 (MainThread): Parsing macros/core.sql
2021-10-07 20:05:38.065765 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:05:38.124728 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:05:38.128664 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:05:38.131349 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:05:38.143223 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:05:38.145740 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:05:38.147501 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:05:38.149232 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:05:38.162310 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:05:38.194014 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:05:38.198446 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:05:38.241715 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:05:38.277988 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:05:38.287244 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:05:38.290477 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:05:38.308395 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:05:38.315657 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:05:38.324666 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:05:38.334418 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:05:38.337084 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:05:38.339428 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:05:38.342249 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:05:38.360629 (MainThread): Partial parsing not enabled
2021-10-07 20:05:38.414520 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:05:38.446744 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:05:38.482119 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:05:38.736143 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:05:38.742835 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8ae56de6-7999-444b-9017-476106aabc87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8862a8700>]}
2021-10-07 20:05:38.803569 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:05:38.805915 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:05:38.808281 (MainThread): 
2021-10-07 20:05:38.809573 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:05:38.813559 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:05:38.831629 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:05:38.832270 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:05:38.832753 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:05:38.837794 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:05:38.840817 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:05:38.848643 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:05:38.856394 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:05:38.856940 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:05:38.857441 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:05:38.861995 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:05:38.862919 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:05:38.863551 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:05:38.866760 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:05:38.880034 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:05:38.880983 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:05:38.890807 (MainThread): Using postgres connection "master".
2021-10-07 20:05:38.891432 (MainThread): On master: BEGIN
2021-10-07 20:05:38.891978 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:05:38.897324 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:05:38.898248 (MainThread): Using postgres connection "master".
2021-10-07 20:05:38.898808 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:05:38.904171 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 20:05:38.904900 (MainThread): On master: ROLLBACK
2021-10-07 20:05:38.905497 (MainThread): Using postgres connection "master".
2021-10-07 20:05:38.905913 (MainThread): On master: BEGIN
2021-10-07 20:05:38.907446 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:05:38.907906 (MainThread): On master: COMMIT
2021-10-07 20:05:38.908335 (MainThread): Using postgres connection "master".
2021-10-07 20:05:38.908724 (MainThread): On master: COMMIT
2021-10-07 20:05:38.909388 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:05:38.909947 (MainThread): On master: Close
2021-10-07 20:05:38.910669 (MainThread): 20:05:38 | Concurrency: 2 threads (target='dev')
2021-10-07 20:05:38.911333 (MainThread): 20:05:38 | 
2021-10-07 20:05:38.916541 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:05:38.918440 (Thread-1): 20:05:38 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:05:38.920925 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:05:38.921975 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:05:38.943083 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 20:05:38.956690 (Thread-1): finished collecting timing info
2021-10-07 20:05:38.986883 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:05:38.987658 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 20:05:38.988175 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:05:38.992688 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:05:38.996307 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:05:38.996867 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:05:38.997843 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:05:39.010960 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 20:05:39.023936 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:05:39.024488 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 20:05:39.025342 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:05:39.025863 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:05:39.026317 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 20:05:39.027686 (Thread-1): Postgres error: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 20:05:39.028238 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 20:05:39.028959 (Thread-1): finished collecting timing info
2021-10-07 20:05:39.029527 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:05:39.030274 (Thread-1): Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:05:39.032558 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8ae56de6-7999-444b-9017-476106aabc87', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa886218bb0>]}
2021-10-07 20:05:39.034274 (Thread-1): 20:05:39 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 20:05:39.034794 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:05:39.037591 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:05:39.038271 (MainThread): Using postgres connection "master".
2021-10-07 20:05:39.038804 (MainThread): On master: BEGIN
2021-10-07 20:05:39.039424 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:05:39.044516 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:05:39.045245 (MainThread): On master: COMMIT
2021-10-07 20:05:39.045867 (MainThread): Using postgres connection "master".
2021-10-07 20:05:39.046498 (MainThread): On master: COMMIT
2021-10-07 20:05:39.047796 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:05:39.048624 (MainThread): On master: Close
2021-10-07 20:05:39.049605 (MainThread): 20:05:39 | 
2021-10-07 20:05:39.050153 (MainThread): 20:05:39 | Finished running 1 table model in 0.24s.
2021-10-07 20:05:39.050799 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:05:39.051223 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:05:39.107055 (MainThread): 
2021-10-07 20:05:39.107611 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:05:39.108280 (MainThread): 
2021-10-07 20:05:39.108814 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 20:05:39.109972 (MainThread):   function luhn(bigint) does not exist
2021-10-07 20:05:39.110711 (MainThread):   LINE 19: WHERE luhn(creditcard::int8) = FALSE
2021-10-07 20:05:39.112594 (MainThread):                  ^
2021-10-07 20:05:39.113768 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 20:05:39.115068 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:05:39.116023 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:05:39.117131 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8861ffbb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8863354f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa8859a5df0>]}
2021-10-07 20:05:39.117992 (MainThread): Flushing usage events
2021-10-07 20:06:00.828047 (MainThread): Running with dbt=0.19.0
2021-10-07 20:06:00.953202 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:06:00.958758 (MainThread): Tracking: tracking
2021-10-07 20:06:00.960927 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb750940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eed57460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb761130>]}
2021-10-07 20:06:01.005478 (MainThread): Partial parsing not enabled
2021-10-07 20:06:01.015678 (MainThread): Parsing macros/luhn.sql
2021-10-07 20:06:01.020107 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:06:01.023209 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:06:01.048551 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:06:01.052251 (MainThread): Parsing macros/relations.sql
2021-10-07 20:06:01.054600 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:06:01.058153 (MainThread): Parsing macros/core.sql
2021-10-07 20:06:01.063276 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:06:01.126788 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:06:01.129965 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:06:01.132453 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:06:01.143725 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:06:01.146694 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:06:01.148966 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:06:01.150675 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:06:01.164536 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:06:01.193075 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:06:01.195980 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:06:01.234902 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:06:01.261088 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:06:01.269588 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:06:01.272337 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:06:01.289468 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:06:01.296518 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:06:01.307088 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:06:01.316116 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:06:01.319048 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:06:01.321471 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:06:01.324338 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:06:01.342571 (MainThread): Partial parsing not enabled
2021-10-07 20:06:01.398037 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:06:01.431908 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:06:01.467112 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:06:01.715214 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:06:01.721586 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fd7f7526-1a15-4f34-aef4-e875e6f9f948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb5a56d0>]}
2021-10-07 20:06:01.782729 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:06:01.785086 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:06:01.786859 (MainThread): 
2021-10-07 20:06:01.787926 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:06:01.791372 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:06:01.807774 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:06:01.808403 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:06:01.808935 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:06:01.814719 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:06:01.819056 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:06:01.825434 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:06:01.834549 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:06:01.835201 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:06:01.835713 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:06:01.839956 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:06:01.840626 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:06:01.841104 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:06:01.843773 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:06:01.856184 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:06:01.857049 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:06:01.867775 (MainThread): Using postgres connection "master".
2021-10-07 20:06:01.868519 (MainThread): On master: BEGIN
2021-10-07 20:06:01.869050 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:06:01.873013 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:06:01.873578 (MainThread): Using postgres connection "master".
2021-10-07 20:06:01.874067 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:06:01.879467 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 20:06:01.880266 (MainThread): On master: ROLLBACK
2021-10-07 20:06:01.881143 (MainThread): Using postgres connection "master".
2021-10-07 20:06:01.881661 (MainThread): On master: BEGIN
2021-10-07 20:06:01.882714 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:06:01.883310 (MainThread): On master: COMMIT
2021-10-07 20:06:01.883762 (MainThread): Using postgres connection "master".
2021-10-07 20:06:01.884218 (MainThread): On master: COMMIT
2021-10-07 20:06:01.884943 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:06:01.885345 (MainThread): On master: Close
2021-10-07 20:06:01.886133 (MainThread): 20:06:01 | Concurrency: 2 threads (target='dev')
2021-10-07 20:06:01.886661 (MainThread): 20:06:01 | 
2021-10-07 20:06:01.891489 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:06:01.893810 (Thread-1): 20:06:01 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:06:01.894799 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:06:01.895401 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:06:01.917238 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 20:06:01.931118 (Thread-1): finished collecting timing info
2021-10-07 20:06:01.962381 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:06:01.963081 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 20:06:01.963878 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:06:01.968917 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 20:06:01.972085 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:06:01.972638 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:06:01.973423 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:06:01.986532 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 20:06:01.999646 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:06:02.000209 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 20:06:02.001130 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:06:02.001595 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:06:02.002027 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 20:06:02.003390 (Thread-1): Postgres error: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 20:06:02.003823 (Thread-1): On model.my_new_project.task2: ROLLBACK
2021-10-07 20:06:02.004545 (Thread-1): finished collecting timing info
2021-10-07 20:06:02.005200 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:06:02.006023 (Thread-1): Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:06:02.008622 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fd7f7526-1a15-4f34-aef4-e875e6f9f948', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eacad4c0>]}
2021-10-07 20:06:02.010480 (Thread-1): 20:06:01 | 1 of 1 ERROR creating table model public.task2....................... [ERROR in 0.11s]
2021-10-07 20:06:02.011160 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:06:02.013576 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:06:02.014128 (MainThread): Using postgres connection "master".
2021-10-07 20:06:02.014631 (MainThread): On master: BEGIN
2021-10-07 20:06:02.015157 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:06:02.019059 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:06:02.019950 (MainThread): On master: COMMIT
2021-10-07 20:06:02.020580 (MainThread): Using postgres connection "master".
2021-10-07 20:06:02.021102 (MainThread): On master: COMMIT
2021-10-07 20:06:02.022136 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:06:02.022969 (MainThread): On master: Close
2021-10-07 20:06:02.024101 (MainThread): 20:06:02 | 
2021-10-07 20:06:02.024965 (MainThread): 20:06:02 | Finished running 1 table model in 0.24s.
2021-10-07 20:06:02.025656 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:06:02.026131 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:06:02.082257 (MainThread): 
2021-10-07 20:06:02.083130 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:06:02.083827 (MainThread): 
2021-10-07 20:06:02.084394 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 20:06:02.085420 (MainThread):   function luhn(bigint) does not exist
2021-10-07 20:06:02.086248 (MainThread):   LINE 19: WHERE luhn(creditcard::int8) = FALSE
2021-10-07 20:06:02.087134 (MainThread):                  ^
2021-10-07 20:06:02.087927 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 20:06:02.088743 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:06:02.089626 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:06:02.090769 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb4fbb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb525ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3eb6514c0>]}
2021-10-07 20:06:02.091521 (MainThread): Flushing usage events
2021-10-07 20:06:06.333680 (MainThread): Running with dbt=0.19.0
2021-10-07 20:06:06.462374 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['luhn'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:06:06.468748 (MainThread): Tracking: tracking
2021-10-07 20:06:06.471203 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba2f6c910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba6573430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba2f7c100>]}
2021-10-07 20:06:06.517952 (MainThread): Partial parsing not enabled
2021-10-07 20:06:06.528433 (MainThread): Parsing macros/luhn.sql
2021-10-07 20:06:06.533520 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:06:06.536646 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:06:06.563219 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:06:06.566925 (MainThread): Parsing macros/relations.sql
2021-10-07 20:06:06.569488 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:06:06.573919 (MainThread): Parsing macros/core.sql
2021-10-07 20:06:06.582189 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:06:06.642423 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:06:06.645544 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:06:06.649801 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:06:06.663554 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:06:06.666293 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:06:06.668237 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:06:06.669832 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:06:06.681247 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:06:06.708259 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:06:06.710965 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:06:06.749778 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:06:06.773518 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:06:06.781895 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:06:06.784719 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:06:06.802424 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:06:06.808998 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:06:06.817950 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:06:06.826931 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:06:06.829719 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:06:06.831999 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:06:06.834701 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:06:06.853300 (MainThread): Partial parsing not enabled
2021-10-07 20:06:06.908167 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:06:06.943749 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:06:06.979566 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:06:07.237867 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:06:07.244941 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5cf4e1e-7141-4fd2-bf5a-4e67dcfb3316', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba2dc0850>]}
2021-10-07 20:06:07.306201 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:06:07.308362 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:06:07.309284 (MainThread): The selector 'luhn' does not match any nodes and will be ignored
2021-10-07 20:06:07.310502 (MainThread): WARNING: Nothing to do. Try checking your model configs and model specification args
2021-10-07 20:06:07.311163 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba2d0ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba2d2f3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba2d2f2e0>]}
2021-10-07 20:06:07.312123 (MainThread): Flushing usage events
2021-10-07 20:06:07.868514 (MainThread): Connection 'snapshot.my_new_project.task1_snapshot' was properly closed.
2021-10-07 20:07:24.196405 (MainThread): Running with dbt=0.19.0
2021-10-07 20:07:24.317822 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['luhn'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:07:24.322446 (MainThread): Tracking: tracking
2021-10-07 20:07:24.324557 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b9524940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46bcb2c460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b9536130>]}
2021-10-07 20:07:24.367849 (MainThread): Partial parsing not enabled
2021-10-07 20:07:24.377076 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:07:24.380258 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:07:24.408558 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:07:24.411927 (MainThread): Parsing macros/relations.sql
2021-10-07 20:07:24.414395 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:07:24.418019 (MainThread): Parsing macros/core.sql
2021-10-07 20:07:24.424019 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:07:24.483054 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:07:24.485951 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:07:24.488942 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:07:24.500624 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:07:24.503508 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:07:24.505429 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:07:24.507731 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:07:24.522795 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:07:24.551272 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:07:24.554019 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:07:24.592203 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:07:24.619051 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:07:24.627985 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:07:24.631496 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:07:24.648941 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:07:24.655550 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:07:24.664496 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:07:24.673647 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:07:24.676359 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:07:24.678753 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:07:24.681951 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:07:24.702332 (MainThread): Partial parsing not enabled
2021-10-07 20:07:24.852982 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-07 20:07:24.883395 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:07:24.904265 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:07:24.939564 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:07:25.204767 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:07:25.211470 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59d255a2-99b1-42ce-a41a-0dd65d946656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b924e3d0>]}
2021-10-07 20:07:25.276799 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:07:25.278858 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:07:25.280844 (MainThread): 
2021-10-07 20:07:25.281943 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:07:25.284697 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:07:25.303725 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:07:25.304429 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:07:25.305039 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:07:25.309919 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.00 seconds
2021-10-07 20:07:25.313983 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:07:25.322273 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:07:25.331546 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:07:25.332577 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:07:25.333271 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:07:25.337525 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:25.338171 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:07:25.338677 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:07:25.341440 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:07:25.353944 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:07:25.354817 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:07:25.366718 (MainThread): Using postgres connection "master".
2021-10-07 20:07:25.367319 (MainThread): On master: BEGIN
2021-10-07 20:07:25.367764 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:07:25.372231 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:25.373015 (MainThread): Using postgres connection "master".
2021-10-07 20:07:25.373489 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:07:25.379487 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 20:07:25.380299 (MainThread): On master: ROLLBACK
2021-10-07 20:07:25.381046 (MainThread): Using postgres connection "master".
2021-10-07 20:07:25.381502 (MainThread): On master: BEGIN
2021-10-07 20:07:25.382426 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:25.382868 (MainThread): On master: COMMIT
2021-10-07 20:07:25.383290 (MainThread): Using postgres connection "master".
2021-10-07 20:07:25.383696 (MainThread): On master: COMMIT
2021-10-07 20:07:25.384369 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:07:25.384818 (MainThread): On master: Close
2021-10-07 20:07:25.385591 (MainThread): 20:07:25 | Concurrency: 2 threads (target='dev')
2021-10-07 20:07:25.386143 (MainThread): 20:07:25 | 
2021-10-07 20:07:25.391965 (Thread-1): Began running node model.my_new_project.luhn
2021-10-07 20:07:25.393924 (Thread-1): 20:07:25 | 1 of 1 START view model public.luhn.................................. [RUN]
2021-10-07 20:07:25.394792 (Thread-1): Acquiring new postgres connection "model.my_new_project.luhn".
2021-10-07 20:07:25.395289 (Thread-1): Compiling model.my_new_project.luhn
2021-10-07 20:07:25.413770 (Thread-1): Writing injected SQL for node "model.my_new_project.luhn"
2021-10-07 20:07:25.425676 (Thread-1): finished collecting timing info
2021-10-07 20:07:25.460430 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:07:25.460922 (Thread-1): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_tmp" cascade
2021-10-07 20:07:25.461422 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:07:25.465594 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-07 20:07:25.468665 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:07:25.469118 (Thread-1): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */
drop view if exists "dellstore"."public"."luhn__dbt_backup" cascade
2021-10-07 20:07:25.469726 (Thread-1): SQL status: DROP VIEW in 0.00 seconds
2021-10-07 20:07:25.475411 (Thread-1): Writing runtime SQL for node "model.my_new_project.luhn"
2021-10-07 20:07:25.484106 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:07:25.484702 (Thread-1): On model.my_new_project.luhn: BEGIN
2021-10-07 20:07:25.485549 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:25.486084 (Thread-1): Using postgres connection "model.my_new_project.luhn".
2021-10-07 20:07:25.486553 (Thread-1): On model.my_new_project.luhn: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.luhn"} */

  create view "dellstore"."public"."luhn__dbt_tmp" as (
    /* Taken from https://wiki.postgresql.org/wiki/Luhn_algorithm */

CREATE OR REPLACE FUNCTION luhn(int8) RETURNS boolean AS $$
SELECT
         MOD(SUM(doubled_digit / INT8 '10' + doubled_digit % INT8 '10'), 10) = 0
FROM
(SELECT
         MOD( ( $1::int8 / (10^n)::int8 ), 10::int8)
         * (MOD(n,2) + 1)
         AS doubled_digit
         FROM generate_series(0, floor(log( $1 ))::integer) AS n
) AS doubled_digits $$ LANGUAGE SQL
  );

2021-10-07 20:07:25.487514 (Thread-1): Postgres error: syntax error at or near "CREATE"
LINE 6: CREATE OR REPLACE FUNCTION luhn(int8) RETURNS boolean AS $$
        ^

2021-10-07 20:07:25.488068 (Thread-1): On model.my_new_project.luhn: ROLLBACK
2021-10-07 20:07:25.488875 (Thread-1): finished collecting timing info
2021-10-07 20:07:25.489457 (Thread-1): On model.my_new_project.luhn: Close
2021-10-07 20:07:25.490216 (Thread-1): Database Error in model luhn (models/luhn.sql)
  syntax error at or near "CREATE"
  LINE 6: CREATE OR REPLACE FUNCTION luhn(int8) RETURNS boolean AS $$
          ^
  compiled SQL at target/run/my_new_project/models/luhn.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.SyntaxError: syntax error at or near "CREATE"
LINE 6: CREATE OR REPLACE FUNCTION luhn(int8) RETURNS boolean AS $$
        ^


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 61, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model luhn (models/luhn.sql)
  syntax error at or near "CREATE"
  LINE 6: CREATE OR REPLACE FUNCTION luhn(int8) RETURNS boolean AS $$
          ^
  compiled SQL at target/run/my_new_project/models/luhn.sql
2021-10-07 20:07:25.492644 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '59d255a2-99b1-42ce-a41a-0dd65d946656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b8a0a3a0>]}
2021-10-07 20:07:25.494322 (Thread-1): 20:07:25 | 1 of 1 ERROR creating view model public.luhn......................... [ERROR in 0.10s]
2021-10-07 20:07:25.494981 (Thread-1): Finished running node model.my_new_project.luhn
2021-10-07 20:07:25.497568 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:07:25.498338 (MainThread): Using postgres connection "master".
2021-10-07 20:07:25.498969 (MainThread): On master: BEGIN
2021-10-07 20:07:25.499458 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:07:25.504646 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:07:25.505396 (MainThread): On master: COMMIT
2021-10-07 20:07:25.506122 (MainThread): Using postgres connection "master".
2021-10-07 20:07:25.506751 (MainThread): On master: COMMIT
2021-10-07 20:07:25.507681 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:07:25.508540 (MainThread): On master: Close
2021-10-07 20:07:25.509525 (MainThread): 20:07:25 | 
2021-10-07 20:07:25.510069 (MainThread): 20:07:25 | Finished running 1 view model in 0.23s.
2021-10-07 20:07:25.510914 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:07:25.511595 (MainThread): Connection 'model.my_new_project.luhn' was properly closed.
2021-10-07 20:07:25.573034 (MainThread): 
2021-10-07 20:07:25.573591 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:07:25.574312 (MainThread): 
2021-10-07 20:07:25.574879 (MainThread): Database Error in model luhn (models/luhn.sql)
2021-10-07 20:07:25.575627 (MainThread):   syntax error at or near "CREATE"
2021-10-07 20:07:25.576538 (MainThread):   LINE 6: CREATE OR REPLACE FUNCTION luhn(int8) RETURNS boolean AS $$
2021-10-07 20:07:25.577802 (MainThread):           ^
2021-10-07 20:07:25.579290 (MainThread):   compiled SQL at target/run/my_new_project/models/luhn.sql
2021-10-07 20:07:25.580397 (MainThread): 
Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
2021-10-07 20:07:25.581568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b9470490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b8a0a3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f46b8a0a730>]}
2021-10-07 20:07:25.582532 (MainThread): Flushing usage events
2021-10-07 20:07:49.192633 (MainThread): Running with dbt=0.19.0
2021-10-07 20:07:49.335023 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:07:49.340849 (MainThread): Tracking: tracking
2021-10-07 20:07:49.343104 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0894a9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0a3f5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0895b1c0>]}
2021-10-07 20:07:49.385411 (MainThread): Partial parsing not enabled
2021-10-07 20:07:49.394866 (MainThread): Parsing macros/luhn.sql
2021-10-07 20:07:49.399617 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:07:49.402866 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:07:49.431756 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:07:49.437225 (MainThread): Parsing macros/relations.sql
2021-10-07 20:07:49.440125 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:07:49.445274 (MainThread): Parsing macros/core.sql
2021-10-07 20:07:49.451567 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:07:49.507624 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:07:49.510663 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:07:49.513212 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:07:49.526175 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:07:49.529751 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:07:49.531589 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:07:49.533334 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:07:49.544777 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:07:49.570837 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:07:49.573560 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:07:49.615202 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:07:49.640762 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:07:49.649410 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:07:49.652743 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:07:49.670386 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:07:49.678494 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:07:49.687106 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:07:49.696238 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:07:49.699699 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:07:49.702075 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:07:49.705224 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:07:49.726613 (MainThread): Partial parsing not enabled
2021-10-07 20:07:49.780151 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:07:49.812491 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:07:49.846092 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:07:50.097218 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:07:50.103276 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c4750c1-d4ac-442f-b120-b6941befd3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0879e820>]}
2021-10-07 20:07:50.163662 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:07:50.165687 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:07:50.167340 (MainThread): 
2021-10-07 20:07:50.168410 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:07:50.174924 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:07:50.189758 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:07:50.190485 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:07:50.191137 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:07:50.196896 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:07:50.200358 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:07:50.206637 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:07:50.215772 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:07:50.216491 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:07:50.217090 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:07:50.221268 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:50.221810 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:07:50.222229 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:07:50.224723 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:07:50.236833 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:07:50.237770 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:07:50.248629 (MainThread): Using postgres connection "master".
2021-10-07 20:07:50.249182 (MainThread): On master: BEGIN
2021-10-07 20:07:50.249629 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:07:50.253406 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:50.254033 (MainThread): Using postgres connection "master".
2021-10-07 20:07:50.254518 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:07:50.260011 (MainThread): SQL status: SELECT 0 in 0.00 seconds
2021-10-07 20:07:50.260859 (MainThread): On master: ROLLBACK
2021-10-07 20:07:50.261615 (MainThread): Using postgres connection "master".
2021-10-07 20:07:50.262129 (MainThread): On master: BEGIN
2021-10-07 20:07:50.263542 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:50.264157 (MainThread): On master: COMMIT
2021-10-07 20:07:50.264631 (MainThread): Using postgres connection "master".
2021-10-07 20:07:50.265094 (MainThread): On master: COMMIT
2021-10-07 20:07:50.265790 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:07:50.266304 (MainThread): On master: Close
2021-10-07 20:07:50.267136 (MainThread): 20:07:50 | Concurrency: 2 threads (target='dev')
2021-10-07 20:07:50.267685 (MainThread): 20:07:50 | 
2021-10-07 20:07:50.273470 (Thread-1): Began running node model.my_new_project.task1
2021-10-07 20:07:50.273751 (Thread-2): Began running node model.my_new_project.task2
2021-10-07 20:07:50.275331 (Thread-1): 20:07:50 | 1 of 2 START table model public.task1................................ [RUN]
2021-10-07 20:07:50.277281 (Thread-2): 20:07:50 | 2 of 2 START table model public.task2................................ [RUN]
2021-10-07 20:07:50.278436 (Thread-1): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.279111 (Thread-2): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:07:50.279503 (Thread-1): Compiling model.my_new_project.task1
2021-10-07 20:07:50.280089 (Thread-2): Compiling model.my_new_project.task2
2021-10-07 20:07:50.310135 (Thread-1): Writing injected SQL for node "model.my_new_project.task1"
2021-10-07 20:07:50.312515 (Thread-2): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 20:07:50.319411 (Thread-2): finished collecting timing info
2021-10-07 20:07:50.331802 (Thread-1): finished collecting timing info
2021-10-07 20:07:50.367728 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:07:50.373486 (Thread-2): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 20:07:50.375298 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.375656 (Thread-2): Opening a new connection, currently in state init
2021-10-07 20:07:50.376188 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_tmp" cascade
2021-10-07 20:07:50.377395 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:07:50.380715 (Thread-2): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 20:07:50.383976 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:07:50.384218 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 20:07:50.384561 (Thread-2): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:07:50.388504 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.389877 (Thread-2): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:07:50.390110 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-07 20:07:50.403643 (Thread-2): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 20:07:50.404541 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:07:50.407050 (Thread-1): Writing runtime SQL for node "model.my_new_project.task1"
2021-10-07 20:07:50.412880 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:07:50.413561 (Thread-2): On model.my_new_project.task2: BEGIN
2021-10-07 20:07:50.414508 (Thread-2): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:50.415115 (Thread-2): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:07:50.415783 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.416051 (Thread-2): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 20:07:50.416752 (Thread-1): On model.my_new_project.task1: BEGIN
2021-10-07 20:07:50.418221 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:50.418414 (Thread-2): Postgres error: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

2021-10-07 20:07:50.418797 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.419362 (Thread-2): On model.my_new_project.task2: ROLLBACK
2021-10-07 20:07:50.419928 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */


  create  table "dellstore"."public"."task1__dbt_tmp"
  as (
    

SELECT 
	split_part(actor, ' ', 1) first_name,
	COUNT(title) no_of_movies,
	SUM(price) sum_prices
FROM "dellstore"."public"."products"
GROUP BY first_name
  );
2021-10-07 20:07:50.420876 (Thread-2): finished collecting timing info
2021-10-07 20:07:50.421485 (Thread-2): On model.my_new_project.task2: Close
2021-10-07 20:07:50.422320 (Thread-2): Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 47, in exception_handler
    yield
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 80, in add_query
    cursor.execute(sql, bindings)
psycopg2.errors.UndefinedFunction: function luhn(bigint) does not exist
LINE 19: WHERE luhn(creditcard::int8) = FALSE
               ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 344, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 287, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/base.py", line 389, in run
    return self.execute(compiled_node, manifest)
  File "/usr/local/lib/python3.8/site-packages/dbt/task/run.py", line 247, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 63, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/clients/jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 41, in macro
  File "/usr/local/lib/python3.8/site-packages/jinja2/sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/jinja2/runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/base/impl.py", line 227, in execute
    return self.connections.execute(
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 124, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/sql/connections.py", line 87, in add_query
    return connection, cursor
  File "/usr/local/lib/python3.8/contextlib.py", line 131, in __exit__
    self.gen.throw(type, value, traceback)
  File "/usr/local/lib/python3.8/site-packages/dbt/adapters/postgres/connections.py", line 58, in exception_handler
    raise dbt.exceptions.DatabaseException(str(e).strip()) from e
dbt.exceptions.DatabaseException: Database Error in model task2 (models/task2.sql)
  function luhn(bigint) does not exist
  LINE 19: WHERE luhn(creditcard::int8) = FALSE
                 ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:07:50.425002 (Thread-2): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4750c1-d4ac-442f-b120-b6941befd3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef05e30c40>]}
2021-10-07 20:07:50.427167 (Thread-2): 20:07:50 | 2 of 2 ERROR creating table model public.task2....................... [ERROR in 0.15s]
2021-10-07 20:07:50.427779 (Thread-2): Finished running node model.my_new_project.task2
2021-10-07 20:07:50.578854 (Thread-1): SQL status: SELECT 200 in 0.16 seconds
2021-10-07 20:07:50.588186 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.588925 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1" rename to "task1__dbt_backup"
2021-10-07 20:07:50.590308 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 20:07:50.594477 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.595368 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
alter table "dellstore"."public"."task1__dbt_tmp" rename to "task1"
2021-10-07 20:07:50.596679 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 20:07:50.604595 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-07 20:07:50.605324 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.605981 (Thread-1): On model.my_new_project.task1: COMMIT
2021-10-07 20:07:50.655356 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-10-07 20:07:50.659896 (Thread-1): Using postgres connection "model.my_new_project.task1".
2021-10-07 20:07:50.660606 (Thread-1): On model.my_new_project.task1: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task1"} */
drop table if exists "dellstore"."public"."task1__dbt_backup" cascade
2021-10-07 20:07:50.695275 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-07 20:07:50.699066 (Thread-1): finished collecting timing info
2021-10-07 20:07:50.699895 (Thread-1): On model.my_new_project.task1: Close
2021-10-07 20:07:50.701215 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c4750c1-d4ac-442f-b120-b6941befd3f7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef07eaf1c0>]}
2021-10-07 20:07:50.703160 (Thread-1): 20:07:50 | 1 of 2 OK created table model public.task1........................... [SELECT 200 in 0.42s]
2021-10-07 20:07:50.703903 (Thread-1): Finished running node model.my_new_project.task1
2021-10-07 20:07:50.706556 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:07:50.707292 (MainThread): Using postgres connection "master".
2021-10-07 20:07:50.707678 (MainThread): On master: BEGIN
2021-10-07 20:07:50.708212 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:07:50.713082 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:07:50.713597 (MainThread): On master: COMMIT
2021-10-07 20:07:50.714130 (MainThread): Using postgres connection "master".
2021-10-07 20:07:50.714450 (MainThread): On master: COMMIT
2021-10-07 20:07:50.715111 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:07:50.715755 (MainThread): On master: Close
2021-10-07 20:07:50.717033 (MainThread): 20:07:50 | 
2021-10-07 20:07:50.717935 (MainThread): 20:07:50 | Finished running 2 table models in 0.55s.
2021-10-07 20:07:50.719236 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:07:50.720140 (MainThread): Connection 'model.my_new_project.task1' was properly closed.
2021-10-07 20:07:50.720647 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:07:50.783828 (MainThread): 
2021-10-07 20:07:50.784299 (MainThread): Completed with 1 error and 0 warnings:
2021-10-07 20:07:50.785267 (MainThread): 
2021-10-07 20:07:50.786229 (MainThread): Database Error in model task2 (models/task2.sql)
2021-10-07 20:07:50.786971 (MainThread):   function luhn(bigint) does not exist
2021-10-07 20:07:50.788706 (MainThread):   LINE 19: WHERE luhn(creditcard::int8) = FALSE
2021-10-07 20:07:50.789880 (MainThread):                  ^
2021-10-07 20:07:50.790957 (MainThread):   HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
2021-10-07 20:07:50.791800 (MainThread):   compiled SQL at target/run/my_new_project/models/task2.sql
2021-10-07 20:07:50.793232 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2021-10-07 20:07:50.794130 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef087c93a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0870b580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef0870bb20>]}
2021-10-07 20:07:50.797388 (MainThread): Flushing usage events
2021-10-07 20:09:06.105686 (MainThread): Running with dbt=0.19.0
2021-10-07 20:09:06.230232 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:09:06.236968 (MainThread): Tracking: tracking
2021-10-07 20:09:06.239817 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad22a7a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad3d52370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad22b91f0>]}
2021-10-07 20:09:06.286844 (MainThread): Partial parsing not enabled
2021-10-07 20:09:06.296004 (MainThread): Parsing macros/luhn.sql
2021-10-07 20:09:06.300898 (MainThread): Parsing macros/luhn_verify.sql
2021-10-07 20:09:06.304013 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:09:06.333607 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:09:06.337876 (MainThread): Parsing macros/relations.sql
2021-10-07 20:09:06.340186 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:09:06.343804 (MainThread): Parsing macros/core.sql
2021-10-07 20:09:06.350418 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:09:06.408970 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:09:06.412404 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:09:06.414993 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:09:06.428051 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:09:06.430703 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:09:06.432596 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:09:06.434134 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:09:06.445772 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:09:06.473129 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:09:06.476487 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:09:06.518707 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:09:06.545420 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:09:06.554355 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:09:06.557387 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:09:06.575225 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:09:06.582274 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:09:06.590623 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:09:06.600522 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:09:06.605123 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:09:06.607957 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:09:06.610899 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:09:06.630380 (MainThread): Partial parsing not enabled
2021-10-07 20:09:06.686863 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:09:06.720949 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:09:06.756253 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:09:06.999368 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:09:07.006888 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb52b21d-4b8f-4cc6-9cb3-9fb47738f40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad20fc8b0>]}
2021-10-07 20:09:07.068152 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:09:07.070351 (MainThread): Found 2 models, 0 tests, 1 snapshot, 0 analyses, 139 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:09:07.072038 (MainThread): 
2021-10-07 20:09:07.073010 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:09:07.076015 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:09:07.091264 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:09:07.092094 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:09:07.092660 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:09:07.098999 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:09:07.102437 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:09:07.108593 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:09:07.117841 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:09:07.118814 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:09:07.119345 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:09:07.123878 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:09:07.124479 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:09:07.124884 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:09:07.127651 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:09:07.139779 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:09:07.140718 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:09:07.152704 (MainThread): Using postgres connection "master".
2021-10-07 20:09:07.153428 (MainThread): On master: BEGIN
2021-10-07 20:09:07.153988 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:09:07.159897 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:09:07.160562 (MainThread): Using postgres connection "master".
2021-10-07 20:09:07.160970 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:09:07.167605 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 20:09:07.168517 (MainThread): On master: ROLLBACK
2021-10-07 20:09:07.169519 (MainThread): Using postgres connection "master".
2021-10-07 20:09:07.169999 (MainThread): On master: BEGIN
2021-10-07 20:09:07.170924 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:09:07.171494 (MainThread): On master: COMMIT
2021-10-07 20:09:07.171923 (MainThread): Using postgres connection "master".
2021-10-07 20:09:07.172332 (MainThread): On master: COMMIT
2021-10-07 20:09:07.173193 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:09:07.173722 (MainThread): On master: Close
2021-10-07 20:09:07.174474 (MainThread): 20:09:07 | Concurrency: 2 threads (target='dev')
2021-10-07 20:09:07.175046 (MainThread): 20:09:07 | 
2021-10-07 20:09:07.179533 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:09:07.181160 (Thread-1): 20:09:07 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:09:07.181938 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:09:07.182611 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:09:07.205199 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 20:09:07.216597 (Thread-1): finished collecting timing info
2021-10-07 20:09:07.248907 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:07.249750 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 20:09:07.250497 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:09:07.256019 (Thread-1): SQL status: DROP TABLE in 0.01 seconds
2021-10-07 20:09:07.260005 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:07.260696 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:09:07.261732 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:09:07.275429 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 20:09:07.289343 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:07.289822 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 20:09:07.290669 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:09:07.291175 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:07.291590 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 20:09:09.338096 (Thread-1): SQL status: SELECT 365 in 2.05 seconds
2021-10-07 20:09:09.348701 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:09.349345 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-07 20:09:09.350283 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 20:09:09.354421 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:09.355516 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-07 20:09:09.356599 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 20:09:09.365703 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-07 20:09:09.366286 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:09.366759 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-07 20:09:09.395651 (Thread-1): SQL status: COMMIT in 0.03 seconds
2021-10-07 20:09:09.400157 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:09:09.400742 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:09:09.458656 (Thread-1): SQL status: DROP TABLE in 0.06 seconds
2021-10-07 20:09:09.462932 (Thread-1): finished collecting timing info
2021-10-07 20:09:09.463953 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:09:09.465310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb52b21d-4b8f-4cc6-9cb3-9fb47738f40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad0797a30>]}
2021-10-07 20:09:09.467150 (Thread-1): 20:09:09 | 1 of 1 OK created table model public.task2........................... [SELECT 365 in 2.28s]
2021-10-07 20:09:09.467798 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:09:09.470715 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:09:09.471336 (MainThread): Using postgres connection "master".
2021-10-07 20:09:09.471914 (MainThread): On master: BEGIN
2021-10-07 20:09:09.472489 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:09:09.477201 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:09:09.477991 (MainThread): On master: COMMIT
2021-10-07 20:09:09.478625 (MainThread): Using postgres connection "master".
2021-10-07 20:09:09.479166 (MainThread): On master: COMMIT
2021-10-07 20:09:09.479963 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:09:09.480729 (MainThread): On master: Close
2021-10-07 20:09:09.481744 (MainThread): 20:09:09 | 
2021-10-07 20:09:09.482373 (MainThread): 20:09:09 | Finished running 1 table model in 2.41s.
2021-10-07 20:09:09.483023 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:09:09.483510 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:09:09.556240 (MainThread): 
2021-10-07 20:09:09.556780 (MainThread): Completed successfully
2021-10-07 20:09:09.557325 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-07 20:09:09.557909 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad2053fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad07c0b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcad07c0be0>]}
2021-10-07 20:09:09.558524 (MainThread): Flushing usage events
2021-10-07 20:11:24.658842 (MainThread): Running with dbt=0.19.0
2021-10-07 20:11:24.793033 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['task2'], partial_parse=None, profile=None, profiles_dir='/root/.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2021-10-07 20:11:24.797768 (MainThread): Tracking: tracking
2021-10-07 20:11:24.799864 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354529b910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35488a3430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f35452ac100>]}
2021-10-07 20:11:24.842005 (MainThread): Partial parsing not enabled
2021-10-07 20:11:24.847238 (MainThread): Parsing macros/adapters.sql
2021-10-07 20:11:24.875734 (MainThread): Parsing macros/catalog.sql
2021-10-07 20:11:24.881059 (MainThread): Parsing macros/relations.sql
2021-10-07 20:11:24.883959 (MainThread): Parsing macros/materializations/snapshot_merge.sql
2021-10-07 20:11:24.888113 (MainThread): Parsing macros/core.sql
2021-10-07 20:11:24.894925 (MainThread): Parsing macros/adapters/common.sql
2021-10-07 20:11:24.949398 (MainThread): Parsing macros/etc/get_custom_schema.sql
2021-10-07 20:11:24.952350 (MainThread): Parsing macros/etc/get_custom_database.sql
2021-10-07 20:11:24.954805 (MainThread): Parsing macros/etc/datetime.sql
2021-10-07 20:11:24.966769 (MainThread): Parsing macros/etc/is_incremental.sql
2021-10-07 20:11:24.969968 (MainThread): Parsing macros/etc/query.sql
2021-10-07 20:11:24.971816 (MainThread): Parsing macros/etc/get_custom_alias.sql
2021-10-07 20:11:24.973524 (MainThread): Parsing macros/materializations/helpers.sql
2021-10-07 20:11:24.984803 (MainThread): Parsing macros/materializations/seed/seed.sql
2021-10-07 20:11:25.011853 (MainThread): Parsing macros/materializations/snapshot/snapshot_merge.sql
2021-10-07 20:11:25.014778 (MainThread): Parsing macros/materializations/snapshot/snapshot.sql
2021-10-07 20:11:25.051768 (MainThread): Parsing macros/materializations/snapshot/strategies.sql
2021-10-07 20:11:25.074574 (MainThread): Parsing macros/materializations/incremental/incremental.sql
2021-10-07 20:11:25.083319 (MainThread): Parsing macros/materializations/incremental/helpers.sql
2021-10-07 20:11:25.086469 (MainThread): Parsing macros/materializations/common/merge.sql
2021-10-07 20:11:25.106120 (MainThread): Parsing macros/materializations/view/create_or_replace_view.sql
2021-10-07 20:11:25.113250 (MainThread): Parsing macros/materializations/view/view.sql
2021-10-07 20:11:25.121472 (MainThread): Parsing macros/materializations/table/table.sql
2021-10-07 20:11:25.130202 (MainThread): Parsing macros/schema_tests/unique.sql
2021-10-07 20:11:25.132649 (MainThread): Parsing macros/schema_tests/not_null.sql
2021-10-07 20:11:25.134773 (MainThread): Parsing macros/schema_tests/relationships.sql
2021-10-07 20:11:25.137463 (MainThread): Parsing macros/schema_tests/accepted_values.sql
2021-10-07 20:11:25.155091 (MainThread): Partial parsing not enabled
2021-10-07 20:11:25.213953 (MainThread): Acquiring new postgres connection "model.my_new_project.luhn_verify".
2021-10-07 20:11:25.244913 (MainThread): Acquiring new postgres connection "model.my_new_project.task1".
2021-10-07 20:11:25.267702 (MainThread): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:11:25.300380 (MainThread): Acquiring new postgres connection "snapshot.my_new_project.task1_snapshot".
2021-10-07 20:11:25.557082 (MainThread): [WARNING]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.my_new_project.example

2021-10-07 20:11:25.564297 (MainThread): Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '469afcc6-c259-43ec-b0ec-4254cd339075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f354502ab20>]}
2021-10-07 20:11:25.631033 (MainThread): write_gpickle is deprecated and will be removed in 3.0.Use ``pickle.dump(G, path, protocol)``
2021-10-07 20:11:25.633128 (MainThread): Found 3 models, 0 tests, 1 snapshot, 0 analyses, 138 macros, 0 operations, 0 seed files, 3 sources, 0 exposures
2021-10-07 20:11:25.634982 (MainThread): 
2021-10-07 20:11:25.636320 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:11:25.639434 (ThreadPoolExecutor-0_0): Acquiring new postgres connection "list_dellstore".
2021-10-07 20:11:25.655663 (ThreadPoolExecutor-0_0): Using postgres connection "list_dellstore".
2021-10-07 20:11:25.656265 (ThreadPoolExecutor-0_0): On list_dellstore: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore"} */

    select distinct nspname from pg_namespace
  
2021-10-07 20:11:25.656808 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2021-10-07 20:11:25.661978 (ThreadPoolExecutor-0_0): SQL status: SELECT 8 in 0.01 seconds
2021-10-07 20:11:25.665627 (ThreadPoolExecutor-0_0): On list_dellstore: Close
2021-10-07 20:11:25.673698 (ThreadPoolExecutor-1_0): Acquiring new postgres connection "list_dellstore_public".
2021-10-07 20:11:25.683028 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:11:25.683671 (ThreadPoolExecutor-1_0): On list_dellstore_public: BEGIN
2021-10-07 20:11:25.684117 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state closed
2021-10-07 20:11:25.688041 (ThreadPoolExecutor-1_0): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:11:25.688666 (ThreadPoolExecutor-1_0): Using postgres connection "list_dellstore_public".
2021-10-07 20:11:25.689144 (ThreadPoolExecutor-1_0): On list_dellstore_public: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "list_dellstore_public"} */
select
      'dellstore' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'dellstore' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
2021-10-07 20:11:25.691786 (ThreadPoolExecutor-1_0): SQL status: SELECT 11 in 0.00 seconds
2021-10-07 20:11:25.703876 (ThreadPoolExecutor-1_0): On list_dellstore_public: ROLLBACK
2021-10-07 20:11:25.704703 (ThreadPoolExecutor-1_0): On list_dellstore_public: Close
2021-10-07 20:11:25.717188 (MainThread): Using postgres connection "master".
2021-10-07 20:11:25.717915 (MainThread): On master: BEGIN
2021-10-07 20:11:25.718367 (MainThread): Opening a new connection, currently in state init
2021-10-07 20:11:25.723295 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:11:25.723856 (MainThread): Using postgres connection "master".
2021-10-07 20:11:25.724491 (MainThread): On master: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
2021-10-07 20:11:25.730175 (MainThread): SQL status: SELECT 0 in 0.01 seconds
2021-10-07 20:11:25.730939 (MainThread): On master: ROLLBACK
2021-10-07 20:11:25.731580 (MainThread): Using postgres connection "master".
2021-10-07 20:11:25.731916 (MainThread): On master: BEGIN
2021-10-07 20:11:25.732832 (MainThread): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:11:25.733283 (MainThread): On master: COMMIT
2021-10-07 20:11:25.733727 (MainThread): Using postgres connection "master".
2021-10-07 20:11:25.734088 (MainThread): On master: COMMIT
2021-10-07 20:11:25.734747 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:11:25.735148 (MainThread): On master: Close
2021-10-07 20:11:25.735918 (MainThread): 20:11:25 | Concurrency: 2 threads (target='dev')
2021-10-07 20:11:25.736468 (MainThread): 20:11:25 | 
2021-10-07 20:11:25.741509 (Thread-1): Began running node model.my_new_project.task2
2021-10-07 20:11:25.743978 (Thread-1): 20:11:25 | 1 of 1 START table model public.task2................................ [RUN]
2021-10-07 20:11:25.744924 (Thread-1): Acquiring new postgres connection "model.my_new_project.task2".
2021-10-07 20:11:25.745549 (Thread-1): Compiling model.my_new_project.task2
2021-10-07 20:11:25.767983 (Thread-1): Writing injected SQL for node "model.my_new_project.task2"
2021-10-07 20:11:25.778408 (Thread-1): finished collecting timing info
2021-10-07 20:11:25.810107 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:25.810719 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_tmp" cascade
2021-10-07 20:11:25.811260 (Thread-1): Opening a new connection, currently in state closed
2021-10-07 20:11:25.815920 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:11:25.820132 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:25.820801 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:11:25.821798 (Thread-1): SQL status: DROP TABLE in 0.00 seconds
2021-10-07 20:11:25.835285 (Thread-1): Writing runtime SQL for node "model.my_new_project.task2"
2021-10-07 20:11:25.845573 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:25.845991 (Thread-1): On model.my_new_project.task2: BEGIN
2021-10-07 20:11:25.846718 (Thread-1): SQL status: BEGIN in 0.00 seconds
2021-10-07 20:11:25.847207 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:25.847691 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */


  create  table "dellstore"."public"."task2__dbt_tmp"
  as (
    

SELECT
	orderdate AS orderdate,
	SUM(netamount) AS netamount
FROM (
	SELECT * 
	FROM 
    	"dellstore"."public"."orders" AS ord
	JOIN
		"dellstore"."public"."customers" AS cust
	ON ord.customerid = cust.customerid
) AS orderCustomerData
WHERE luhn_verify(creditcard::int8) = FALSE
GROUP BY orderdate
  );
2021-10-07 20:11:26.351112 (Thread-1): SQL status: SELECT 365 in 0.50 seconds
2021-10-07 20:11:26.362004 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:26.362936 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2" rename to "task2__dbt_backup"
2021-10-07 20:11:26.363879 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 20:11:26.366720 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:26.367224 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
alter table "dellstore"."public"."task2__dbt_tmp" rename to "task2"
2021-10-07 20:11:26.368431 (Thread-1): SQL status: ALTER TABLE in 0.00 seconds
2021-10-07 20:11:26.376685 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-07 20:11:26.377575 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:26.378226 (Thread-1): On model.my_new_project.task2: COMMIT
2021-10-07 20:11:26.424296 (Thread-1): SQL status: COMMIT in 0.05 seconds
2021-10-07 20:11:26.428688 (Thread-1): Using postgres connection "model.my_new_project.task2".
2021-10-07 20:11:26.429377 (Thread-1): On model.my_new_project.task2: /* {"app": "dbt", "dbt_version": "0.19.0", "profile_name": "default", "target_name": "dev", "node_id": "model.my_new_project.task2"} */
drop table if exists "dellstore"."public"."task2__dbt_backup" cascade
2021-10-07 20:11:26.463557 (Thread-1): SQL status: DROP TABLE in 0.03 seconds
2021-10-07 20:11:26.466780 (Thread-1): finished collecting timing info
2021-10-07 20:11:26.467426 (Thread-1): On model.my_new_project.task2: Close
2021-10-07 20:11:26.468661 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '469afcc6-c259-43ec-b0ec-4254cd339075', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3544fef940>]}
2021-10-07 20:11:26.470320 (Thread-1): 20:11:26 | 1 of 1 OK created table model public.task2........................... [SELECT 365 in 0.72s]
2021-10-07 20:11:26.470946 (Thread-1): Finished running node model.my_new_project.task2
2021-10-07 20:11:26.473644 (MainThread): Acquiring new postgres connection "master".
2021-10-07 20:11:26.474334 (MainThread): Using postgres connection "master".
2021-10-07 20:11:26.474824 (MainThread): On master: BEGIN
2021-10-07 20:11:26.475367 (MainThread): Opening a new connection, currently in state closed
2021-10-07 20:11:26.480553 (MainThread): SQL status: BEGIN in 0.01 seconds
2021-10-07 20:11:26.481265 (MainThread): On master: COMMIT
2021-10-07 20:11:26.481838 (MainThread): Using postgres connection "master".
2021-10-07 20:11:26.482262 (MainThread): On master: COMMIT
2021-10-07 20:11:26.483277 (MainThread): SQL status: COMMIT in 0.00 seconds
2021-10-07 20:11:26.484200 (MainThread): On master: Close
2021-10-07 20:11:26.485458 (MainThread): 20:11:26 | 
2021-10-07 20:11:26.486466 (MainThread): 20:11:26 | Finished running 1 table model in 0.85s.
2021-10-07 20:11:26.487423 (MainThread): Connection 'master' was properly closed.
2021-10-07 20:11:26.488030 (MainThread): Connection 'model.my_new_project.task2' was properly closed.
2021-10-07 20:11:26.550313 (MainThread): 
2021-10-07 20:11:26.550848 (MainThread): Completed successfully
2021-10-07 20:11:26.551779 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2021-10-07 20:11:26.552568 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3544720a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3544720430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3544737f10>]}
2021-10-07 20:11:26.553792 (MainThread): Flushing usage events
